<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Generate Prime Numbers — primeSieve • RcppAlgos</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Generate Prime Numbers — primeSieve"><meta name="description" content="Implementation of the segmented sieve of Eratosthenes with wheel factorization. Generates all prime numbers between bound1 and bound2 (if supplied) or all primes up to bound1. See this stackoverflow post for an analysis on prime number generation efficiency in R: Generate a list of primes up to a certain number

The fundamental concepts of this algorithm are based off of the implementation by Kim Walisch found here: kimwalisch/primesieve."><meta property="og:description" content="Implementation of the segmented sieve of Eratosthenes with wheel factorization. Generates all prime numbers between bound1 and bound2 (if supplied) or all primes up to bound1. See this stackoverflow post for an analysis on prime number generation efficiency in R: Generate a list of primes up to a certain number

The fundamental concepts of this algorithm are based off of the implementation by Kim Walisch found here: kimwalisch/primesieve."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RcppAlgos</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.9.4</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/CombinatorialSampling.html">Combinatorial Sampling and Ranking</a></li>
    <li><a class="dropdown-item" href="../articles/CombinatoricsIterators.html">Combinatorial Iterators in RcppAlgos</a></li>
    <li><a class="dropdown-item" href="../articles/CombPermConstraints.html">Constraints, Partitions, and Compositions</a></li>
    <li><a class="dropdown-item" href="../articles/ComputationalMathematics.html">Computational Mathematics Overview</a></li>
    <li><a class="dropdown-item" href="../articles/GeneralCombinatorics.html">Combination and Permutation Basics</a></li>
    <li><a class="dropdown-item" href="../articles/HighPerformanceBenchmarks.html">High Performance Benchmarks</a></li>
    <li><a class="dropdown-item" href="../articles/OtherCombinatorics.html">Cartesian Products and Partitions of Groups</a></li>
    <li><a class="dropdown-item" href="../articles/SubsetSum.html">Attacking Problems Related to the Subset Sum Problem</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jwood000/RcppAlgos/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Generate Prime Numbers</h1>

      <div class="d-none name"><code>primeSieve.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Implementation of the segmented sieve of Eratosthenes with wheel factorization. Generates all prime numbers between <code>bound1</code> and <code>bound2</code> (if supplied) or all primes up to <code>bound1</code>. See this stackoverflow post for an analysis on prime number generation efficiency in R: <a href="https://stackoverflow.com/a/48313378/4408538" class="external-link">Generate a list of primes up to a certain number
</a></p>
<p>The fundamental concepts of this algorithm are based off of the implementation by Kim Walisch found here: <a href="https://github.com/kimwalisch/primesieve" class="external-link">kimwalisch/primesieve</a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">primeSieve</span><span class="op">(</span><span class="va">bound1</span>, bound2 <span class="op">=</span> <span class="cn">NULL</span>, nThreads <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-bound-">bound1<a class="anchor" aria-label="anchor" href="#arg-bound-"></a></dt>
<dd><p>Positive integer or numeric value.</p></dd>

    <dt id="arg-bound-">bound2<a class="anchor" aria-label="anchor" href="#arg-bound-"></a></dt>
<dd><p>Positive integer or numeric value.</p></dd>

    <dt id="arg-nthreads">nThreads<a class="anchor" aria-label="anchor" href="#arg-nthreads"></a></dt>
<dd><p>Specific number of threads to be used. The default is <code>NULL</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>

<ul><li><p>It does not matter which bound is larger as the resulting primes will be between <code>min(bound1, bound2)</code> and <code>max(bound1, bound2)</code> if <code>bound2</code> is provided.</p></li>
<li><p>The maximum value for either of the bounds is \(2^{53} - 1\).</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>At the heart of this algorithm is the traditional sieve of Eratosthenes (i.e. given a <a href="https://en.wikipedia.org/wiki/Prime_number" class="external-link">prime</a> \(p\), mark all multiples of \(p\) as <a href="https://en.wikipedia.org/wiki/Composite_number" class="external-link">composite</a>), however instead of sieving the entire interval, we only consider small sub-intervals. The benefits of this method are two fold:</p><ol><li><p>Reduction of the <a href="https://en.wikipedia.org/wiki/DSPACE" class="external-link">space complexity</a> from \(O(n)\), for the traditional sieve, to \(O(\sqrt n)\)</p></li>
<li><p>Reduction of <a href="https://en.wikipedia.org/wiki/CPU_cache#Cache_miss" class="external-link">cache misses</a></p></li>
</ol><p>The latter is of particular importance as cache memory is much more efficient and closer in proximity to the CPU than <a href="https://en.wikipedia.org/wiki/Computer_data_storage#Primary_storage" class="external-link">main memory</a>. Reducing the size of the sieving interval allows for more effective utilization of the cache, which greatly impacts the overall efficiency.</p>
<p>Another optimization over the traditional sieve is the utilization of wheel factorization. With the traditional sieve of Eratosthenes, you typically check every odd index of your logical vector and if the value is true, you have found a prime. With wheel factorization using the first four primes (i.e. 2, 3, 5, and 7) to construct your wheel (i.e. 210 wheel), you only have to check indices of your logical vector that are coprime to 210 (i.e. the product of the first four primes). As an example, with \(n = 10000\) and a 210 wheel, you only have to check 2285 indices vs. 5000 with the classical implementation.</p>
    </div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns an integer vector if <code>max(bound1, bound2)</code> \(&lt; 2^{31}\), or a numeric vector otherwise.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p><a href="https://github.com/kimwalisch/primesieve" class="external-link">primesieve (Fast C/C++ prime number generator)</a></p></li>
<li><p><a href="https://en.wikipedia.org/wiki/Sieve_of_Eratosthenes" class="external-link">Sieve of Eratosthenes</a></p></li>
<li><p><a href="https://en.wikipedia.org/wiki/Wheel_factorization" class="external-link">Wheel factorization</a></p></li>
<li><p><a href="https://en.wikipedia.org/wiki/Double-precision_floating-point_format" class="external-link">53-bit significand precision</a></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Joseph Wood</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Primes up to a thousand</span></span></span>
<span class="r-in"><span><span class="fu">primeSieve</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1]  2  3  5  7 11 13 17 19 23 29 31 37 41 43 47 53 59 61 67 71 73 79 83 89 97</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Primes between 42 and 17</span></span></span>
<span class="r-in"><span><span class="fu">primeSieve</span><span class="op">(</span><span class="fl">42</span>, <span class="fl">17</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 17 19 23 29 31 37 41</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Equivalent to</span></span></span>
<span class="r-in"><span><span class="fu">primeSieve</span><span class="op">(</span><span class="fl">17</span>, <span class="fl">42</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 17 19 23 29 31 37 41</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Primes up to one hundred million in no time</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu">primeSieve</span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="fl">8</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.106   0.008   0.114 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## options(scipen = 50)</span></span></span>
<span class="r-in"><span><span class="co">## Generate large primes over interval</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">myPs</span> <span class="op">&lt;-</span> <span class="fu">primeSieve</span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="fl">13</span><span class="op">+</span><span class="fl">10</span><span class="op">^</span><span class="fl">6</span>, <span class="fl">10</span><span class="op">^</span><span class="fl">13</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0.01    0.00    0.01 </span>
<span class="r-in"><span><span class="co">## Object created is small</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/object.size.html" class="external-link">object.size</a></span><span class="op">(</span><span class="va">myPs</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 267696 bytes</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Using nThreads</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu">primeSieve</span><span class="op">(</span><span class="fl">1e7</span>, nThreads <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.013   0.000   0.007 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joseph Wood.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

