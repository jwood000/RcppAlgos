<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Joseph Wood" />


<title>Combination and Permutation Basics</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Combination and Permutation Basics</h1>
<h4 class="author">Joseph Wood</h4>
<h4 class="date">10/9/2019</h4>


<div id="TOC">
<ul>
<li><a href="#introducing-combogeneral-and-permutegeneral">Introducing <code>comboGeneral</code> and <code>permuteGeneral</code></a></li>
<li><a href="#combinationspermutations-with-repetition">Combinations/Permutations with Repetition</a></li>
<li><a href="#working-with-multisets">Working with Multisets</a><ul>
<li><a href="#enter-freqs">Enter <code>freqs</code></a></li>
</ul></li>
<li><a href="#parallel-computing">Parallel Computing</a><ul>
<li><a href="#using-arguments-lower-and-upper">Using arguments <code>lower</code> and <code>upper</code></a></li>
<li><a href="#generating-results-beyond-.machineinteger.max">Generating Results Beyond <code>.Machine$integer.max</code></a></li>
</ul></li>
<li><a href="#gmp-support">GMP Support</a></li>
<li><a href="#user-defined-functions">User Defined Functions</a></li>
<li><a href="#partitions-of-groups-of-equal-size-with-combogroups">Partitions of Groups of Equal Size with <code>comboGroups</code></a><ul>
<li><a href="#relevant-posts-on-stackoverflow-as-well-as-oeis.">Relevant Posts on Stackoverflow as well as OEIS.</a></li>
</ul></li>
</ul>
</div>

<p>This document serves as an overview for attacking <em>common</em> combinatorial problems in <code>R</code>. One of the goals of <code>RcppAlgos</code> is to provide a comprehensive and accessible suite of functionality so that users can easily get to the heart of their problem. As a bonus, the functions in <code>RcppAlgos</code> are extremely efficient and are developed with the concept of <em>High Performance</em> as something that is constantly pursued but never attained. In other words, <code>RcppAlgos</code> is fast now, but we know it can be faster.</p>
<p>It should be noted that this document only covers common problems. For more information on other combinatorial problems addressed by <code>RcppAlgos</code>, see the following vignettes:</p>
<ul>
<li><a href="CombinatorialSampling.html">Combinatorial Sampling</a></li>
<li><a href="CombPermConstraints.html">Combinations and Permutations under Constraints</a></li>
<li><a href="PartitionsCompositions.html">Integer Partitions/Compositions</a></li>
</ul>
<p>For much of the output below, we will be using the following function obtained here <a href="https://stackoverflow.com/a/11601162/4408538">combining head and tail methods in R</a> (credit to user <span class="citation">@flodel</span>)</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>ht &lt;-<span class="st"> </span><span class="cf">function</span>(d, <span class="dt">m =</span> <span class="dv">5</span>, <span class="dt">n =</span> m) {</span>
<span id="cb1-2"><a href="#cb1-2"></a>  <span class="co">## print the head and tail together</span></span>
<span id="cb1-3"><a href="#cb1-3"></a>  <span class="kw">cat</span>(<span class="st">&quot;head --&gt;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1-4"><a href="#cb1-4"></a>  <span class="kw">print</span>(<span class="kw">head</span>(d, m))</span>
<span id="cb1-5"><a href="#cb1-5"></a>  <span class="kw">cat</span>(<span class="st">&quot;--------</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1-6"><a href="#cb1-6"></a>  <span class="kw">cat</span>(<span class="st">&quot;tail --&gt;</span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb1-7"><a href="#cb1-7"></a>  <span class="kw">print</span>(<span class="kw">tail</span>(d, n))</span>
<span id="cb1-8"><a href="#cb1-8"></a>}</span></code></pre></div>
<hr />
<div id="introducing-combogeneral-and-permutegeneral" class="section level2">
<h2>Introducing <code>comboGeneral</code> and <code>permuteGeneral</code></h2>
<p>Easily executed with a very simple interface. The output is in <a href="https://en.wikipedia.org/wiki/Lexicographical_order">lexicographical order</a>.</p>
<p>We first look at getting results without repetition. You can pass an integer <em>n</em> and it will be converted to the sequence <code>1:n</code>, or you can pass any vector with an atomic type (i.e. <code>logical</code>, <code>integer</code>, <code>numeric</code>, <code>complex</code>, <code>character</code>, and <code>raw</code>).</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">library</span>(RcppAlgos)</span>
<span id="cb2-2"><a href="#cb2-2"></a></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">## combn output for reference</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="kw">combn</span>(<span class="dv">4</span>, <span class="dv">3</span>)</span>
<span id="cb2-5"><a href="#cb2-5"></a>     [,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>] [,<span class="dv">4</span>]</span>
<span id="cb2-6"><a href="#cb2-6"></a>[<span class="dv">1</span>,]    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">2</span></span>
<span id="cb2-7"><a href="#cb2-7"></a>[<span class="dv">2</span>,]    <span class="dv">2</span>    <span class="dv">2</span>    <span class="dv">3</span>    <span class="dv">3</span></span>
<span id="cb2-8"><a href="#cb2-8"></a>[<span class="dv">3</span>,]    <span class="dv">3</span>    <span class="dv">4</span>    <span class="dv">4</span>    <span class="dv">4</span></span>
<span id="cb2-9"><a href="#cb2-9"></a></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="co">## This is the same as combn expect the output is transposed</span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="kw">comboGeneral</span>(<span class="dv">4</span>, <span class="dv">3</span>)</span>
<span id="cb2-12"><a href="#cb2-12"></a>     [,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>]</span>
<span id="cb2-13"><a href="#cb2-13"></a>[<span class="dv">1</span>,]    <span class="dv">1</span>    <span class="dv">2</span>    <span class="dv">3</span></span>
<span id="cb2-14"><a href="#cb2-14"></a>[<span class="dv">2</span>,]    <span class="dv">1</span>    <span class="dv">2</span>    <span class="dv">4</span></span>
<span id="cb2-15"><a href="#cb2-15"></a>[<span class="dv">3</span>,]    <span class="dv">1</span>    <span class="dv">3</span>    <span class="dv">4</span></span>
<span id="cb2-16"><a href="#cb2-16"></a>[<span class="dv">4</span>,]    <span class="dv">2</span>    <span class="dv">3</span>    <span class="dv">4</span></span>
<span id="cb2-17"><a href="#cb2-17"></a></span>
<span id="cb2-18"><a href="#cb2-18"></a><span class="co">## Find all 3-tuple permutations without</span></span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="co">## repetition of the numbers c(1, 2, 3, 4).</span></span>
<span id="cb2-20"><a href="#cb2-20"></a><span class="kw">head</span>(<span class="kw">permuteGeneral</span>(<span class="dv">4</span>, <span class="dv">3</span>))</span>
<span id="cb2-21"><a href="#cb2-21"></a>     [,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>]</span>
<span id="cb2-22"><a href="#cb2-22"></a>[<span class="dv">1</span>,]    <span class="dv">1</span>    <span class="dv">2</span>    <span class="dv">3</span></span>
<span id="cb2-23"><a href="#cb2-23"></a>[<span class="dv">2</span>,]    <span class="dv">1</span>    <span class="dv">2</span>    <span class="dv">4</span></span>
<span id="cb2-24"><a href="#cb2-24"></a>[<span class="dv">3</span>,]    <span class="dv">1</span>    <span class="dv">3</span>    <span class="dv">2</span></span>
<span id="cb2-25"><a href="#cb2-25"></a>[<span class="dv">4</span>,]    <span class="dv">1</span>    <span class="dv">3</span>    <span class="dv">4</span></span>
<span id="cb2-26"><a href="#cb2-26"></a>[<span class="dv">5</span>,]    <span class="dv">1</span>    <span class="dv">4</span>    <span class="dv">2</span></span>
<span id="cb2-27"><a href="#cb2-27"></a>[<span class="dv">6</span>,]    <span class="dv">1</span>    <span class="dv">4</span>    <span class="dv">3</span></span>
<span id="cb2-28"><a href="#cb2-28"></a></span>
<span id="cb2-29"><a href="#cb2-29"></a><span class="co">## If you don&#39;t specify m, the length of v (if v is a vector) or v (if v is a </span></span>
<span id="cb2-30"><a href="#cb2-30"></a><span class="co">## scalar (see the examples above)) will be used</span></span>
<span id="cb2-31"><a href="#cb2-31"></a>v &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">5</span>, <span class="dv">7</span>, <span class="dv">11</span>, <span class="dv">13</span>)</span>
<span id="cb2-32"><a href="#cb2-32"></a><span class="kw">comboGeneral</span>(v)</span>
<span id="cb2-33"><a href="#cb2-33"></a>     [,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>] [,<span class="dv">4</span>] [,<span class="dv">5</span>] [,<span class="dv">6</span>]</span>
<span id="cb2-34"><a href="#cb2-34"></a>[<span class="dv">1</span>,]    <span class="dv">2</span>    <span class="dv">3</span>    <span class="dv">5</span>    <span class="dv">7</span>   <span class="dv">11</span>   <span class="dv">13</span></span>
<span id="cb2-35"><a href="#cb2-35"></a></span>
<span id="cb2-36"><a href="#cb2-36"></a><span class="kw">head</span>(<span class="kw">permuteGeneral</span>(v))</span>
<span id="cb2-37"><a href="#cb2-37"></a>     [,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>] [,<span class="dv">4</span>] [,<span class="dv">5</span>] [,<span class="dv">6</span>]</span>
<span id="cb2-38"><a href="#cb2-38"></a>[<span class="dv">1</span>,]    <span class="dv">2</span>    <span class="dv">3</span>    <span class="dv">5</span>    <span class="dv">7</span>   <span class="dv">11</span>   <span class="dv">13</span></span>
<span id="cb2-39"><a href="#cb2-39"></a>[<span class="dv">2</span>,]    <span class="dv">2</span>    <span class="dv">3</span>    <span class="dv">5</span>    <span class="dv">7</span>   <span class="dv">13</span>   <span class="dv">11</span></span>
<span id="cb2-40"><a href="#cb2-40"></a>[<span class="dv">3</span>,]    <span class="dv">2</span>    <span class="dv">3</span>    <span class="dv">5</span>   <span class="dv">11</span>    <span class="dv">7</span>   <span class="dv">13</span></span>
<span id="cb2-41"><a href="#cb2-41"></a>[<span class="dv">4</span>,]    <span class="dv">2</span>    <span class="dv">3</span>    <span class="dv">5</span>   <span class="dv">11</span>   <span class="dv">13</span>    <span class="dv">7</span></span>
<span id="cb2-42"><a href="#cb2-42"></a>[<span class="dv">5</span>,]    <span class="dv">2</span>    <span class="dv">3</span>    <span class="dv">5</span>   <span class="dv">13</span>    <span class="dv">7</span>   <span class="dv">11</span></span>
<span id="cb2-43"><a href="#cb2-43"></a>[<span class="dv">6</span>,]    <span class="dv">2</span>    <span class="dv">3</span>    <span class="dv">5</span>   <span class="dv">13</span>   <span class="dv">11</span>    <span class="dv">7</span></span>
<span id="cb2-44"><a href="#cb2-44"></a></span>
<span id="cb2-45"><a href="#cb2-45"></a></span>
<span id="cb2-46"><a href="#cb2-46"></a><span class="co">## They are very efficient...</span></span>
<span id="cb2-47"><a href="#cb2-47"></a><span class="kw">system.time</span>(<span class="kw">comboGeneral</span>(<span class="dv">25</span>, <span class="dv">12</span>))</span>
<span id="cb2-48"><a href="#cb2-48"></a> user  system elapsed </span>
<span id="cb2-49"><a href="#cb2-49"></a><span class="fl">0.101</span>   <span class="fl">0.048</span>   <span class="fl">0.151</span></span>
<span id="cb2-50"><a href="#cb2-50"></a> </span>
<span id="cb2-51"><a href="#cb2-51"></a><span class="kw">comboCount</span>(<span class="dv">25</span>, <span class="dv">12</span>)</span>
<span id="cb2-52"><a href="#cb2-52"></a>[<span class="dv">1</span>] <span class="dv">5200300</span></span>
<span id="cb2-53"><a href="#cb2-53"></a></span>
<span id="cb2-54"><a href="#cb2-54"></a><span class="kw">ht</span>(<span class="kw">comboGeneral</span>(<span class="dv">25</span>, <span class="dv">12</span>))</span>
<span id="cb2-55"><a href="#cb2-55"></a>head <span class="op">-</span>-&gt;</span>
<span id="cb2-56"><a href="#cb2-56"></a><span class="st">     </span>[,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>] [,<span class="dv">4</span>] [,<span class="dv">5</span>] [,<span class="dv">6</span>] [,<span class="dv">7</span>] [,<span class="dv">8</span>] [,<span class="dv">9</span>] [,<span class="dv">10</span>] [,<span class="dv">11</span>] [,<span class="dv">12</span>]</span>
<span id="cb2-57"><a href="#cb2-57"></a>[<span class="dv">1</span>,]    <span class="dv">1</span>    <span class="dv">2</span>    <span class="dv">3</span>    <span class="dv">4</span>    <span class="dv">5</span>    <span class="dv">6</span>    <span class="dv">7</span>    <span class="dv">8</span>    <span class="dv">9</span>    <span class="dv">10</span>    <span class="dv">11</span>    <span class="dv">12</span></span>
<span id="cb2-58"><a href="#cb2-58"></a>[<span class="dv">2</span>,]    <span class="dv">1</span>    <span class="dv">2</span>    <span class="dv">3</span>    <span class="dv">4</span>    <span class="dv">5</span>    <span class="dv">6</span>    <span class="dv">7</span>    <span class="dv">8</span>    <span class="dv">9</span>    <span class="dv">10</span>    <span class="dv">11</span>    <span class="dv">13</span></span>
<span id="cb2-59"><a href="#cb2-59"></a>[<span class="dv">3</span>,]    <span class="dv">1</span>    <span class="dv">2</span>    <span class="dv">3</span>    <span class="dv">4</span>    <span class="dv">5</span>    <span class="dv">6</span>    <span class="dv">7</span>    <span class="dv">8</span>    <span class="dv">9</span>    <span class="dv">10</span>    <span class="dv">11</span>    <span class="dv">14</span></span>
<span id="cb2-60"><a href="#cb2-60"></a>[<span class="dv">4</span>,]    <span class="dv">1</span>    <span class="dv">2</span>    <span class="dv">3</span>    <span class="dv">4</span>    <span class="dv">5</span>    <span class="dv">6</span>    <span class="dv">7</span>    <span class="dv">8</span>    <span class="dv">9</span>    <span class="dv">10</span>    <span class="dv">11</span>    <span class="dv">15</span></span>
<span id="cb2-61"><a href="#cb2-61"></a>[<span class="dv">5</span>,]    <span class="dv">1</span>    <span class="dv">2</span>    <span class="dv">3</span>    <span class="dv">4</span>    <span class="dv">5</span>    <span class="dv">6</span>    <span class="dv">7</span>    <span class="dv">8</span>    <span class="dv">9</span>    <span class="dv">10</span>    <span class="dv">11</span>    <span class="dv">16</span></span>
<span id="cb2-62"><a href="#cb2-62"></a><span class="op">--------</span></span>
<span id="cb2-63"><a href="#cb2-63"></a>tail <span class="op">-</span>-&gt;</span>
<span id="cb2-64"><a href="#cb2-64"></a><span class="st">           </span>[,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>] [,<span class="dv">4</span>] [,<span class="dv">5</span>] [,<span class="dv">6</span>] [,<span class="dv">7</span>] [,<span class="dv">8</span>] [,<span class="dv">9</span>] [,<span class="dv">10</span>] [,<span class="dv">11</span>] [,<span class="dv">12</span>]</span>
<span id="cb2-65"><a href="#cb2-65"></a>[<span class="dv">5200296</span>,]   <span class="dv">13</span>   <span class="dv">14</span>   <span class="dv">15</span>   <span class="dv">16</span>   <span class="dv">18</span>   <span class="dv">19</span>   <span class="dv">20</span>   <span class="dv">21</span>   <span class="dv">22</span>    <span class="dv">23</span>    <span class="dv">24</span>    <span class="dv">25</span></span>
<span id="cb2-66"><a href="#cb2-66"></a>[<span class="dv">5200297</span>,]   <span class="dv">13</span>   <span class="dv">14</span>   <span class="dv">15</span>   <span class="dv">17</span>   <span class="dv">18</span>   <span class="dv">19</span>   <span class="dv">20</span>   <span class="dv">21</span>   <span class="dv">22</span>    <span class="dv">23</span>    <span class="dv">24</span>    <span class="dv">25</span></span>
<span id="cb2-67"><a href="#cb2-67"></a>[<span class="dv">5200298</span>,]   <span class="dv">13</span>   <span class="dv">14</span>   <span class="dv">16</span>   <span class="dv">17</span>   <span class="dv">18</span>   <span class="dv">19</span>   <span class="dv">20</span>   <span class="dv">21</span>   <span class="dv">22</span>    <span class="dv">23</span>    <span class="dv">24</span>    <span class="dv">25</span></span>
<span id="cb2-68"><a href="#cb2-68"></a>[<span class="dv">5200299</span>,]   <span class="dv">13</span>   <span class="dv">15</span>   <span class="dv">16</span>   <span class="dv">17</span>   <span class="dv">18</span>   <span class="dv">19</span>   <span class="dv">20</span>   <span class="dv">21</span>   <span class="dv">22</span>    <span class="dv">23</span>    <span class="dv">24</span>    <span class="dv">25</span></span>
<span id="cb2-69"><a href="#cb2-69"></a>[<span class="dv">5200300</span>,]   <span class="dv">14</span>   <span class="dv">15</span>   <span class="dv">16</span>   <span class="dv">17</span>   <span class="dv">18</span>   <span class="dv">19</span>   <span class="dv">20</span>   <span class="dv">21</span>   <span class="dv">22</span>    <span class="dv">23</span>    <span class="dv">24</span>    <span class="dv">25</span></span>
<span id="cb2-70"><a href="#cb2-70"></a></span>
<span id="cb2-71"><a href="#cb2-71"></a></span>
<span id="cb2-72"><a href="#cb2-72"></a><span class="co">## And for permutations... over 8 million instantly</span></span>
<span id="cb2-73"><a href="#cb2-73"></a><span class="kw">system.time</span>(<span class="kw">permuteCount</span>(<span class="dv">13</span>, <span class="dv">7</span>))</span>
<span id="cb2-74"><a href="#cb2-74"></a>user  system elapsed </span>
<span id="cb2-75"><a href="#cb2-75"></a>   <span class="dv">0</span>       <span class="dv">0</span>       <span class="dv">0</span></span>
<span id="cb2-76"><a href="#cb2-76"></a>    </span>
<span id="cb2-77"><a href="#cb2-77"></a><span class="kw">permuteCount</span>(<span class="dv">13</span>, <span class="dv">7</span>)</span>
<span id="cb2-78"><a href="#cb2-78"></a>[<span class="dv">1</span>] <span class="dv">8648640</span></span>
<span id="cb2-79"><a href="#cb2-79"></a></span>
<span id="cb2-80"><a href="#cb2-80"></a><span class="kw">ht</span>(<span class="kw">permuteGeneral</span>(<span class="dv">13</span>, <span class="dv">7</span>))</span>
<span id="cb2-81"><a href="#cb2-81"></a>head <span class="op">-</span>-&gt;</span>
<span id="cb2-82"><a href="#cb2-82"></a><span class="st">     </span>[,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>] [,<span class="dv">4</span>] [,<span class="dv">5</span>] [,<span class="dv">6</span>] [,<span class="dv">7</span>]</span>
<span id="cb2-83"><a href="#cb2-83"></a>[<span class="dv">1</span>,]    <span class="dv">1</span>    <span class="dv">2</span>    <span class="dv">3</span>    <span class="dv">4</span>    <span class="dv">5</span>    <span class="dv">6</span>    <span class="dv">7</span></span>
<span id="cb2-84"><a href="#cb2-84"></a>[<span class="dv">2</span>,]    <span class="dv">1</span>    <span class="dv">2</span>    <span class="dv">3</span>    <span class="dv">4</span>    <span class="dv">5</span>    <span class="dv">6</span>    <span class="dv">8</span></span>
<span id="cb2-85"><a href="#cb2-85"></a>[<span class="dv">3</span>,]    <span class="dv">1</span>    <span class="dv">2</span>    <span class="dv">3</span>    <span class="dv">4</span>    <span class="dv">5</span>    <span class="dv">6</span>    <span class="dv">9</span></span>
<span id="cb2-86"><a href="#cb2-86"></a>[<span class="dv">4</span>,]    <span class="dv">1</span>    <span class="dv">2</span>    <span class="dv">3</span>    <span class="dv">4</span>    <span class="dv">5</span>    <span class="dv">6</span>   <span class="dv">10</span></span>
<span id="cb2-87"><a href="#cb2-87"></a>[<span class="dv">5</span>,]    <span class="dv">1</span>    <span class="dv">2</span>    <span class="dv">3</span>    <span class="dv">4</span>    <span class="dv">5</span>    <span class="dv">6</span>   <span class="dv">11</span></span>
<span id="cb2-88"><a href="#cb2-88"></a><span class="op">--------</span></span>
<span id="cb2-89"><a href="#cb2-89"></a>tail <span class="op">-</span>-&gt;</span>
<span id="cb2-90"><a href="#cb2-90"></a><span class="st">           </span>[,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>] [,<span class="dv">4</span>] [,<span class="dv">5</span>] [,<span class="dv">6</span>] [,<span class="dv">7</span>]</span>
<span id="cb2-91"><a href="#cb2-91"></a>[<span class="dv">8648636</span>,]   <span class="dv">13</span>   <span class="dv">12</span>   <span class="dv">11</span>   <span class="dv">10</span>    <span class="dv">9</span>    <span class="dv">8</span>    <span class="dv">3</span></span>
<span id="cb2-92"><a href="#cb2-92"></a>[<span class="dv">8648637</span>,]   <span class="dv">13</span>   <span class="dv">12</span>   <span class="dv">11</span>   <span class="dv">10</span>    <span class="dv">9</span>    <span class="dv">8</span>    <span class="dv">4</span></span>
<span id="cb2-93"><a href="#cb2-93"></a>[<span class="dv">8648638</span>,]   <span class="dv">13</span>   <span class="dv">12</span>   <span class="dv">11</span>   <span class="dv">10</span>    <span class="dv">9</span>    <span class="dv">8</span>    <span class="dv">5</span></span>
<span id="cb2-94"><a href="#cb2-94"></a>[<span class="dv">8648639</span>,]   <span class="dv">13</span>   <span class="dv">12</span>   <span class="dv">11</span>   <span class="dv">10</span>    <span class="dv">9</span>    <span class="dv">8</span>    <span class="dv">6</span></span>
<span id="cb2-95"><a href="#cb2-95"></a>[<span class="dv">8648640</span>,]   <span class="dv">13</span>   <span class="dv">12</span>   <span class="dv">11</span>   <span class="dv">10</span>    <span class="dv">9</span>    <span class="dv">8</span>    <span class="dv">7</span></span>
<span id="cb2-96"><a href="#cb2-96"></a></span>
<span id="cb2-97"><a href="#cb2-97"></a></span>
<span id="cb2-98"><a href="#cb2-98"></a><span class="co">## Factors are preserved</span></span>
<span id="cb2-99"><a href="#cb2-99"></a><span class="kw">permuteGeneral</span>(<span class="kw">factor</span>(<span class="kw">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;med&quot;</span>, <span class="st">&quot;high&quot;</span>),</span>
<span id="cb2-100"><a href="#cb2-100"></a>               <span class="dt">levels =</span> <span class="kw">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;med&quot;</span>, <span class="st">&quot;high&quot;</span>),</span>
<span id="cb2-101"><a href="#cb2-101"></a>               <span class="dt">ordered =</span> <span class="ot">TRUE</span>))</span>
<span id="cb2-102"><a href="#cb2-102"></a>     [,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>]</span>
<span id="cb2-103"><a href="#cb2-103"></a>[<span class="dv">1</span>,] low  med  high</span>
<span id="cb2-104"><a href="#cb2-104"></a>[<span class="dv">2</span>,] low  high med </span>
<span id="cb2-105"><a href="#cb2-105"></a>[<span class="dv">3</span>,] med  low  high</span>
<span id="cb2-106"><a href="#cb2-106"></a>[<span class="dv">4</span>,] med  high low </span>
<span id="cb2-107"><a href="#cb2-107"></a>[<span class="dv">5</span>,] high low  med </span>
<span id="cb2-108"><a href="#cb2-108"></a>[<span class="dv">6</span>,] high med  low </span>
<span id="cb2-109"><a href="#cb2-109"></a>Levels<span class="op">:</span><span class="st"> </span>low <span class="op">&lt;</span><span class="st"> </span>med <span class="op">&lt;</span><span class="st"> </span>high</span></code></pre></div>
</div>
<div id="combinationspermutations-with-repetition" class="section level2">
<h2>Combinations/Permutations with Repetition</h2>
<p>There are many problems in combinatorics which require finding combinations/permutations with repetition. This is easily achieved by setting <code>repetition</code> to <code>TRUE</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>fourDays &lt;-<span class="st"> </span><span class="kw">weekdays</span>(<span class="kw">as.Date</span>(<span class="st">&quot;2019-10-09&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="dv">0</span><span class="op">:</span><span class="dv">3</span>, <span class="ot">TRUE</span>)</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="kw">ht</span>(<span class="kw">comboGeneral</span>(fourDays, <span class="dt">repetition =</span> <span class="ot">TRUE</span>))</span>
<span id="cb3-3"><a href="#cb3-3"></a>head <span class="op">-</span>-&gt;</span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="st">     </span>[,<span class="dv">1</span>]  [,<span class="dv">2</span>]  [,<span class="dv">3</span>]  [,<span class="dv">4</span>] </span>
<span id="cb3-5"><a href="#cb3-5"></a>[<span class="dv">1</span>,] <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span></span>
<span id="cb3-6"><a href="#cb3-6"></a>[<span class="dv">2</span>,] <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Thu&quot;</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>[<span class="dv">3</span>,] <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Fri&quot;</span></span>
<span id="cb3-8"><a href="#cb3-8"></a>[<span class="dv">4</span>,] <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Sat&quot;</span></span>
<span id="cb3-9"><a href="#cb3-9"></a>[<span class="dv">5</span>,] <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Thu&quot;</span> <span class="st">&quot;Thu&quot;</span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="op">--------</span></span>
<span id="cb3-11"><a href="#cb3-11"></a>tail <span class="op">-</span>-&gt;</span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="st">      </span>[,<span class="dv">1</span>]  [,<span class="dv">2</span>]  [,<span class="dv">3</span>]  [,<span class="dv">4</span>] </span>
<span id="cb3-13"><a href="#cb3-13"></a>[<span class="dv">31</span>,] <span class="st">&quot;Fri&quot;</span> <span class="st">&quot;Fri&quot;</span> <span class="st">&quot;Fri&quot;</span> <span class="st">&quot;Fri&quot;</span></span>
<span id="cb3-14"><a href="#cb3-14"></a>[<span class="dv">32</span>,] <span class="st">&quot;Fri&quot;</span> <span class="st">&quot;Fri&quot;</span> <span class="st">&quot;Fri&quot;</span> <span class="st">&quot;Sat&quot;</span></span>
<span id="cb3-15"><a href="#cb3-15"></a>[<span class="dv">33</span>,] <span class="st">&quot;Fri&quot;</span> <span class="st">&quot;Fri&quot;</span> <span class="st">&quot;Sat&quot;</span> <span class="st">&quot;Sat&quot;</span></span>
<span id="cb3-16"><a href="#cb3-16"></a>[<span class="dv">34</span>,] <span class="st">&quot;Fri&quot;</span> <span class="st">&quot;Sat&quot;</span> <span class="st">&quot;Sat&quot;</span> <span class="st">&quot;Sat&quot;</span></span>
<span id="cb3-17"><a href="#cb3-17"></a>[<span class="dv">35</span>,] <span class="st">&quot;Sat&quot;</span> <span class="st">&quot;Sat&quot;</span> <span class="st">&quot;Sat&quot;</span> <span class="st">&quot;Sat&quot;</span></span>
<span id="cb3-18"><a href="#cb3-18"></a></span>
<span id="cb3-19"><a href="#cb3-19"></a><span class="co">## When repetition = TRUE, m can exceed length(v)</span></span>
<span id="cb3-20"><a href="#cb3-20"></a><span class="kw">ht</span>(<span class="kw">comboGeneral</span>(fourDays, <span class="dv">8</span>, <span class="ot">TRUE</span>))</span>
<span id="cb3-21"><a href="#cb3-21"></a>head <span class="op">-</span>-&gt;</span>
<span id="cb3-22"><a href="#cb3-22"></a><span class="st">     </span>[,<span class="dv">1</span>]  [,<span class="dv">2</span>]  [,<span class="dv">3</span>]  [,<span class="dv">4</span>]  [,<span class="dv">5</span>]  [,<span class="dv">6</span>]  [,<span class="dv">7</span>]  [,<span class="dv">8</span>] </span>
<span id="cb3-23"><a href="#cb3-23"></a>[<span class="dv">1</span>,] <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span></span>
<span id="cb3-24"><a href="#cb3-24"></a>[<span class="dv">2</span>,] <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Thu&quot;</span></span>
<span id="cb3-25"><a href="#cb3-25"></a>[<span class="dv">3</span>,] <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Fri&quot;</span></span>
<span id="cb3-26"><a href="#cb3-26"></a>[<span class="dv">4</span>,] <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Sat&quot;</span></span>
<span id="cb3-27"><a href="#cb3-27"></a>[<span class="dv">5</span>,] <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Wed&quot;</span> <span class="st">&quot;Thu&quot;</span> <span class="st">&quot;Thu&quot;</span></span>
<span id="cb3-28"><a href="#cb3-28"></a><span class="op">--------</span></span>
<span id="cb3-29"><a href="#cb3-29"></a>tail <span class="op">-</span>-&gt;</span>
<span id="cb3-30"><a href="#cb3-30"></a><span class="st">       </span>[,<span class="dv">1</span>]  [,<span class="dv">2</span>]  [,<span class="dv">3</span>]  [,<span class="dv">4</span>]  [,<span class="dv">5</span>]  [,<span class="dv">6</span>]  [,<span class="dv">7</span>]  [,<span class="dv">8</span>] </span>
<span id="cb3-31"><a href="#cb3-31"></a>[<span class="dv">161</span>,] <span class="st">&quot;Fri&quot;</span> <span class="st">&quot;Fri&quot;</span> <span class="st">&quot;Fri&quot;</span> <span class="st">&quot;Fri&quot;</span> <span class="st">&quot;Sat&quot;</span> <span class="st">&quot;Sat&quot;</span> <span class="st">&quot;Sat&quot;</span> <span class="st">&quot;Sat&quot;</span></span>
<span id="cb3-32"><a href="#cb3-32"></a>[<span class="dv">162</span>,] <span class="st">&quot;Fri&quot;</span> <span class="st">&quot;Fri&quot;</span> <span class="st">&quot;Fri&quot;</span> <span class="st">&quot;Sat&quot;</span> <span class="st">&quot;Sat&quot;</span> <span class="st">&quot;Sat&quot;</span> <span class="st">&quot;Sat&quot;</span> <span class="st">&quot;Sat&quot;</span></span>
<span id="cb3-33"><a href="#cb3-33"></a>[<span class="dv">163</span>,] <span class="st">&quot;Fri&quot;</span> <span class="st">&quot;Fri&quot;</span> <span class="st">&quot;Sat&quot;</span> <span class="st">&quot;Sat&quot;</span> <span class="st">&quot;Sat&quot;</span> <span class="st">&quot;Sat&quot;</span> <span class="st">&quot;Sat&quot;</span> <span class="st">&quot;Sat&quot;</span></span>
<span id="cb3-34"><a href="#cb3-34"></a>[<span class="dv">164</span>,] <span class="st">&quot;Fri&quot;</span> <span class="st">&quot;Sat&quot;</span> <span class="st">&quot;Sat&quot;</span> <span class="st">&quot;Sat&quot;</span> <span class="st">&quot;Sat&quot;</span> <span class="st">&quot;Sat&quot;</span> <span class="st">&quot;Sat&quot;</span> <span class="st">&quot;Sat&quot;</span></span>
<span id="cb3-35"><a href="#cb3-35"></a>[<span class="dv">165</span>,] <span class="st">&quot;Sat&quot;</span> <span class="st">&quot;Sat&quot;</span> <span class="st">&quot;Sat&quot;</span> <span class="st">&quot;Sat&quot;</span> <span class="st">&quot;Sat&quot;</span> <span class="st">&quot;Sat&quot;</span> <span class="st">&quot;Sat&quot;</span> <span class="st">&quot;Sat&quot;</span></span>
<span id="cb3-36"><a href="#cb3-36"></a></span>
<span id="cb3-37"><a href="#cb3-37"></a></span>
<span id="cb3-38"><a href="#cb3-38"></a>fibonacci &lt;-<span class="st"> </span><span class="kw">c</span>(1L, 2L, 3L, 5L, 8L, 13L, 21L, 34L)</span>
<span id="cb3-39"><a href="#cb3-39"></a>permsFib &lt;-<span class="st"> </span><span class="kw">permuteGeneral</span>(fibonacci, <span class="dv">5</span>, <span class="ot">TRUE</span>)</span>
<span id="cb3-40"><a href="#cb3-40"></a></span>
<span id="cb3-41"><a href="#cb3-41"></a><span class="kw">ht</span>(permsFib)</span>
<span id="cb3-42"><a href="#cb3-42"></a>head <span class="op">-</span>-&gt;</span>
<span id="cb3-43"><a href="#cb3-43"></a><span class="st">     </span>[,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>] [,<span class="dv">4</span>] [,<span class="dv">5</span>]</span>
<span id="cb3-44"><a href="#cb3-44"></a>[<span class="dv">1</span>,]    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span></span>
<span id="cb3-45"><a href="#cb3-45"></a>[<span class="dv">2</span>,]    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">2</span></span>
<span id="cb3-46"><a href="#cb3-46"></a>[<span class="dv">3</span>,]    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">3</span></span>
<span id="cb3-47"><a href="#cb3-47"></a>[<span class="dv">4</span>,]    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">5</span></span>
<span id="cb3-48"><a href="#cb3-48"></a>[<span class="dv">5</span>,]    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">8</span></span>
<span id="cb3-49"><a href="#cb3-49"></a><span class="op">--------</span></span>
<span id="cb3-50"><a href="#cb3-50"></a>tail <span class="op">-</span>-&gt;</span>
<span id="cb3-51"><a href="#cb3-51"></a><span class="st">         </span>[,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>] [,<span class="dv">4</span>] [,<span class="dv">5</span>]</span>
<span id="cb3-52"><a href="#cb3-52"></a>[<span class="dv">32764</span>,]   <span class="dv">34</span>   <span class="dv">34</span>   <span class="dv">34</span>   <span class="dv">34</span>    <span class="dv">5</span></span>
<span id="cb3-53"><a href="#cb3-53"></a>[<span class="dv">32765</span>,]   <span class="dv">34</span>   <span class="dv">34</span>   <span class="dv">34</span>   <span class="dv">34</span>    <span class="dv">8</span></span>
<span id="cb3-54"><a href="#cb3-54"></a>[<span class="dv">32766</span>,]   <span class="dv">34</span>   <span class="dv">34</span>   <span class="dv">34</span>   <span class="dv">34</span>   <span class="dv">13</span></span>
<span id="cb3-55"><a href="#cb3-55"></a>[<span class="dv">32767</span>,]   <span class="dv">34</span>   <span class="dv">34</span>   <span class="dv">34</span>   <span class="dv">34</span>   <span class="dv">21</span></span>
<span id="cb3-56"><a href="#cb3-56"></a>[<span class="dv">32768</span>,]   <span class="dv">34</span>   <span class="dv">34</span>   <span class="dv">34</span>   <span class="dv">34</span>   <span class="dv">34</span></span>
<span id="cb3-57"><a href="#cb3-57"></a></span>
<span id="cb3-58"><a href="#cb3-58"></a></span>
<span id="cb3-59"><a href="#cb3-59"></a><span class="co">## N.B. class is preserved</span></span>
<span id="cb3-60"><a href="#cb3-60"></a><span class="kw">class</span>(fibonacci)</span>
<span id="cb3-61"><a href="#cb3-61"></a>[<span class="dv">1</span>] <span class="st">&quot;integer&quot;</span></span>
<span id="cb3-62"><a href="#cb3-62"></a></span>
<span id="cb3-63"><a href="#cb3-63"></a><span class="kw">class</span>(permsFib[<span class="dv">1</span>, ])</span>
<span id="cb3-64"><a href="#cb3-64"></a>[<span class="dv">1</span>] <span class="st">&quot;integer&quot;</span></span>
<span id="cb3-65"><a href="#cb3-65"></a></span>
<span id="cb3-66"><a href="#cb3-66"></a><span class="co">## Binary representation of all numbers from 0 to 1023</span></span>
<span id="cb3-67"><a href="#cb3-67"></a><span class="kw">ht</span>(<span class="kw">permuteGeneral</span>(<span class="dv">0</span><span class="op">:</span><span class="dv">1</span>, <span class="dv">10</span>, T))</span>
<span id="cb3-68"><a href="#cb3-68"></a>head <span class="op">-</span>-&gt;</span>
<span id="cb3-69"><a href="#cb3-69"></a><span class="st">     </span>[,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>] [,<span class="dv">4</span>] [,<span class="dv">5</span>] [,<span class="dv">6</span>] [,<span class="dv">7</span>] [,<span class="dv">8</span>] [,<span class="dv">9</span>] [,<span class="dv">10</span>]</span>
<span id="cb3-70"><a href="#cb3-70"></a>[<span class="dv">1</span>,]    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb3-71"><a href="#cb3-71"></a>[<span class="dv">2</span>,]    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>     <span class="dv">1</span></span>
<span id="cb3-72"><a href="#cb3-72"></a>[<span class="dv">3</span>,]    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">1</span>     <span class="dv">0</span></span>
<span id="cb3-73"><a href="#cb3-73"></a>[<span class="dv">4</span>,]    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">1</span>     <span class="dv">1</span></span>
<span id="cb3-74"><a href="#cb3-74"></a>[<span class="dv">5</span>,]    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">0</span>    <span class="dv">1</span>    <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb3-75"><a href="#cb3-75"></a><span class="op">--------</span></span>
<span id="cb3-76"><a href="#cb3-76"></a>tail <span class="op">-</span>-&gt;</span>
<span id="cb3-77"><a href="#cb3-77"></a><span class="st">        </span>[,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>] [,<span class="dv">4</span>] [,<span class="dv">5</span>] [,<span class="dv">6</span>] [,<span class="dv">7</span>] [,<span class="dv">8</span>] [,<span class="dv">9</span>] [,<span class="dv">10</span>]</span>
<span id="cb3-78"><a href="#cb3-78"></a>[<span class="dv">1020</span>,]    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">0</span>    <span class="dv">1</span>     <span class="dv">1</span></span>
<span id="cb3-79"><a href="#cb3-79"></a>[<span class="dv">1021</span>,]    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">0</span>     <span class="dv">0</span></span>
<span id="cb3-80"><a href="#cb3-80"></a>[<span class="dv">1022</span>,]    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">0</span>     <span class="dv">1</span></span>
<span id="cb3-81"><a href="#cb3-81"></a>[<span class="dv">1023</span>,]    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>     <span class="dv">0</span></span>
<span id="cb3-82"><a href="#cb3-82"></a>[<span class="dv">1024</span>,]    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>    <span class="dv">1</span>     <span class="dv">1</span></span></code></pre></div>
</div>
<div id="working-with-multisets" class="section level2">
<h2>Working with Multisets</h2>
<p>Sometimes, the standard combination/permutation functions don’t quite get us to our desired goal. For example, one may need all permutations of a vector with some of the elements repeated a specific number of times (i.e. a multiset). Consider the following vector <code>a &lt;- c(1,1,1,1,2,2,2,7,7,7,7,7)</code> and one would like to find permutations of <code>a</code> of length 6. Using traditional methods, we would need to generate all permutations, then eliminate duplicate values. Even considering that <code>permuteGeneral</code> is very efficient, this approach is clunky and not as fast as it could be. Observe:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>getPermsWithSpecificRepetition &lt;-<span class="st"> </span><span class="cf">function</span>(z, n) {</span>
<span id="cb4-2"><a href="#cb4-2"></a>    b &lt;-<span class="st"> </span><span class="kw">permuteGeneral</span>(z, n)</span>
<span id="cb4-3"><a href="#cb4-3"></a>    myDupes &lt;-<span class="st"> </span><span class="kw">duplicated</span>(b)</span>
<span id="cb4-4"><a href="#cb4-4"></a>    b[<span class="op">!</span>myDupes, ]</span>
<span id="cb4-5"><a href="#cb4-5"></a>}</span>
<span id="cb4-6"><a href="#cb4-6"></a></span>
<span id="cb4-7"><a href="#cb4-7"></a>a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">7</span>,<span class="dv">7</span>,<span class="dv">7</span>,<span class="dv">7</span>,<span class="dv">7</span>)</span>
<span id="cb4-8"><a href="#cb4-8"></a></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="kw">system.time</span>(test &lt;-<span class="st"> </span><span class="kw">getPermsWithSpecificRepetition</span>(a, <span class="dv">6</span>))</span>
<span id="cb4-10"><a href="#cb4-10"></a>  user  system elapsed </span>
<span id="cb4-11"><a href="#cb4-11"></a> <span class="fl">2.317</span>   <span class="fl">0.059</span>   <span class="fl">2.385</span></span></code></pre></div>
<div id="enter-freqs" class="section level3">
<h3>Enter <code>freqs</code></h3>
<p>Situations like this call for the use of the <code>freqs</code> argument. Simply, enter the number of times each unique element is repeated and Voila!</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw">system.time</span>(test2 &lt;-<span class="st"> </span><span class="kw">permuteGeneral</span>(<span class="kw">unique</span>(a), <span class="dv">6</span>, <span class="dt">freqs =</span> <span class="kw">rle</span>(a)<span class="op">$</span>lengths))</span>
<span id="cb5-2"><a href="#cb5-2"></a> user  system elapsed </span>
<span id="cb5-3"><a href="#cb5-3"></a>    <span class="dv">0</span>       <span class="dv">0</span>       <span class="dv">0</span></span>
<span id="cb5-4"><a href="#cb5-4"></a>      </span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="kw">identical</span>(test, test2)</span>
<span id="cb5-6"><a href="#cb5-6"></a>[<span class="dv">1</span>] <span class="ot">TRUE</span></span></code></pre></div>
<p>Here are some more general examples with multisets:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="co">## Generate all permutations of a vector with specific</span></span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co">## length of repetition for each element (i.e. multiset)</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="kw">ht</span>(<span class="kw">permuteGeneral</span>(<span class="dv">3</span>, <span class="dt">freqs =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>)))</span>
<span id="cb6-4"><a href="#cb6-4"></a>head <span class="op">-</span>-&gt;</span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="st">     </span>[,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>] [,<span class="dv">4</span>] [,<span class="dv">5</span>]</span>
<span id="cb6-6"><a href="#cb6-6"></a>[<span class="dv">1</span>,]    <span class="dv">1</span>    <span class="dv">2</span>    <span class="dv">2</span>    <span class="dv">3</span>    <span class="dv">3</span></span>
<span id="cb6-7"><a href="#cb6-7"></a>[<span class="dv">2</span>,]    <span class="dv">1</span>    <span class="dv">2</span>    <span class="dv">3</span>    <span class="dv">2</span>    <span class="dv">3</span></span>
<span id="cb6-8"><a href="#cb6-8"></a>[<span class="dv">3</span>,]    <span class="dv">1</span>    <span class="dv">2</span>    <span class="dv">3</span>    <span class="dv">3</span>    <span class="dv">2</span></span>
<span id="cb6-9"><a href="#cb6-9"></a>[<span class="dv">4</span>,]    <span class="dv">1</span>    <span class="dv">3</span>    <span class="dv">2</span>    <span class="dv">2</span>    <span class="dv">3</span></span>
<span id="cb6-10"><a href="#cb6-10"></a>[<span class="dv">5</span>,]    <span class="dv">1</span>    <span class="dv">3</span>    <span class="dv">2</span>    <span class="dv">3</span>    <span class="dv">2</span></span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="op">--------</span></span>
<span id="cb6-12"><a href="#cb6-12"></a>tail <span class="op">-</span>-&gt;</span>
<span id="cb6-13"><a href="#cb6-13"></a><span class="st">      </span>[,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>] [,<span class="dv">4</span>] [,<span class="dv">5</span>]</span>
<span id="cb6-14"><a href="#cb6-14"></a>[<span class="dv">26</span>,]    <span class="dv">3</span>    <span class="dv">2</span>    <span class="dv">3</span>    <span class="dv">1</span>    <span class="dv">2</span></span>
<span id="cb6-15"><a href="#cb6-15"></a>[<span class="dv">27</span>,]    <span class="dv">3</span>    <span class="dv">2</span>    <span class="dv">3</span>    <span class="dv">2</span>    <span class="dv">1</span></span>
<span id="cb6-16"><a href="#cb6-16"></a>[<span class="dv">28</span>,]    <span class="dv">3</span>    <span class="dv">3</span>    <span class="dv">1</span>    <span class="dv">2</span>    <span class="dv">2</span></span>
<span id="cb6-17"><a href="#cb6-17"></a>[<span class="dv">29</span>,]    <span class="dv">3</span>    <span class="dv">3</span>    <span class="dv">2</span>    <span class="dv">1</span>    <span class="dv">2</span></span>
<span id="cb6-18"><a href="#cb6-18"></a>[<span class="dv">30</span>,]    <span class="dv">3</span>    <span class="dv">3</span>    <span class="dv">2</span>    <span class="dv">2</span>    <span class="dv">1</span></span>
<span id="cb6-19"><a href="#cb6-19"></a></span>
<span id="cb6-20"><a href="#cb6-20"></a><span class="co">## or combinations of a certain length</span></span>
<span id="cb6-21"><a href="#cb6-21"></a><span class="kw">comboGeneral</span>(<span class="dv">3</span>, <span class="dv">2</span>, <span class="dt">freqs =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb6-22"><a href="#cb6-22"></a>     [,<span class="dv">1</span>] [,<span class="dv">2</span>]</span>
<span id="cb6-23"><a href="#cb6-23"></a>[<span class="dv">1</span>,]    <span class="dv">1</span>    <span class="dv">2</span></span>
<span id="cb6-24"><a href="#cb6-24"></a>[<span class="dv">2</span>,]    <span class="dv">1</span>    <span class="dv">3</span></span>
<span id="cb6-25"><a href="#cb6-25"></a>[<span class="dv">3</span>,]    <span class="dv">2</span>    <span class="dv">2</span></span>
<span id="cb6-26"><a href="#cb6-26"></a>[<span class="dv">4</span>,]    <span class="dv">2</span>    <span class="dv">3</span></span>
<span id="cb6-27"><a href="#cb6-27"></a>[<span class="dv">5</span>,]    <span class="dv">3</span>    <span class="dv">3</span></span></code></pre></div>
</div>
</div>
<div id="parallel-computing" class="section level2">
<h2>Parallel Computing</h2>
<p>Using the parameter <code>Parallel</code> or <code>nThreads</code>, we can generate combinations/permutations with greater efficiency.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw">library</span>(microbenchmark)</span>
<span id="cb7-2"><a href="#cb7-2"></a></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co">## RcppAlgos uses the &quot;number of threads available minus one&quot; when Parallel is TRUE</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>RcppAlgos<span class="op">::</span><span class="kw">stdThreadMax</span>()</span>
<span id="cb7-5"><a href="#cb7-5"></a>[<span class="dv">1</span>] <span class="dv">8</span></span>
<span id="cb7-6"><a href="#cb7-6"></a></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="co">## Compared to combn using 4 threads</span></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="kw">microbenchmark</span>(<span class="dt">combn =</span> <span class="kw">combn</span>(<span class="dv">25</span>, <span class="dv">10</span>),</span>
<span id="cb7-9"><a href="#cb7-9"></a>               <span class="dt">serAlgos =</span> <span class="kw">comboGeneral</span>(<span class="dv">25</span>, <span class="dv">10</span>),</span>
<span id="cb7-10"><a href="#cb7-10"></a>               <span class="dt">parAlgos =</span> <span class="kw">comboGeneral</span>(<span class="dv">25</span>, <span class="dv">10</span>, <span class="dt">nThreads =</span> <span class="dv">4</span>),</span>
<span id="cb7-11"><a href="#cb7-11"></a>               <span class="dt">times =</span> <span class="dv">10</span>, </span>
<span id="cb7-12"><a href="#cb7-12"></a>               <span class="dt">unit =</span> <span class="st">&quot;relative&quot;</span>)</span>
<span id="cb7-13"><a href="#cb7-13"></a>Unit<span class="op">:</span><span class="st"> </span>relative</span>
<span id="cb7-14"><a href="#cb7-14"></a>     expr        min         lq      mean     median         uq       max neval</span>
<span id="cb7-15"><a href="#cb7-15"></a>    combn <span class="fl">140.873986</span> <span class="fl">143.411149</span> <span class="fl">66.043305</span> <span class="fl">128.898187</span> <span class="fl">120.543678</span> <span class="fl">18.503645</span>    <span class="dv">10</span></span>
<span id="cb7-16"><a href="#cb7-16"></a> serAlgos   <span class="fl">2.295844</span>   <span class="fl">2.302306</span>  <span class="fl">2.062132</span>   <span class="fl">2.117214</span>   <span class="fl">7.153547</span>  <span class="fl">1.080612</span>    <span class="dv">10</span></span>
<span id="cb7-17"><a href="#cb7-17"></a> parAlgos   <span class="fl">1.000000</span>   <span class="fl">1.000000</span>  <span class="fl">1.000000</span>   <span class="fl">1.000000</span>   <span class="fl">1.000000</span>  <span class="fl">1.000000</span>    <span class="dv">10</span></span>
<span id="cb7-18"><a href="#cb7-18"></a></span>
<span id="cb7-19"><a href="#cb7-19"></a></span>
<span id="cb7-20"><a href="#cb7-20"></a><span class="co">## Using 7 cores w/ Parallel = TRUE</span></span>
<span id="cb7-21"><a href="#cb7-21"></a><span class="kw">microbenchmark</span>(<span class="dt">serial =</span> <span class="kw">comboGeneral</span>(<span class="dv">20</span>, <span class="dv">10</span>, <span class="dt">freqs =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">5</span>)),</span>
<span id="cb7-22"><a href="#cb7-22"></a>             <span class="dt">parallel =</span> <span class="kw">comboGeneral</span>(<span class="dv">20</span>, <span class="dv">10</span>, <span class="dt">freqs =</span> <span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">4</span>, <span class="dv">5</span>), <span class="dt">Parallel =</span> <span class="ot">TRUE</span>))</span>
<span id="cb7-23"><a href="#cb7-23"></a>Unit<span class="op">:</span><span class="st"> </span>milliseconds</span>
<span id="cb7-24"><a href="#cb7-24"></a>     expr       min         lq      mean     median         uq       max neval</span>
<span id="cb7-25"><a href="#cb7-25"></a>   serial  <span class="fl">3.031987</span>   <span class="fl">2.990349</span>  <span class="fl">2.969633</span>   <span class="fl">3.000991</span>   <span class="fl">2.992326</span>  <span class="fl">2.014025</span>   <span class="dv">100</span></span>
<span id="cb7-26"><a href="#cb7-26"></a> parallel  <span class="fl">1.000000</span>   <span class="fl">1.000000</span>  <span class="fl">1.000000</span>   <span class="fl">1.000000</span>   <span class="fl">1.000000</span>  <span class="fl">1.000000</span>   <span class="dv">100</span></span>
<span id="cb7-27"><a href="#cb7-27"></a> </span>
<span id="cb7-28"><a href="#cb7-28"></a></span>
<span id="cb7-29"><a href="#cb7-29"></a><span class="kw">set.seed</span>(<span class="dv">2187</span>)</span>
<span id="cb7-30"><a href="#cb7-30"></a>bigVec &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">sample</span>(<span class="dv">10</span><span class="op">^</span><span class="dv">7</span>, <span class="dv">600</span>))</span>
<span id="cb7-31"><a href="#cb7-31"></a></span>
<span id="cb7-32"><a href="#cb7-32"></a><span class="co">## Use it with any of the combinatorial functions</span></span>
<span id="cb7-33"><a href="#cb7-33"></a><span class="kw">system.time</span>(<span class="kw">permuteGeneral</span>(bigVec, <span class="dv">3</span>, <span class="dt">Parallel =</span> T))</span>
<span id="cb7-34"><a href="#cb7-34"></a>  user  system elapsed</span>
<span id="cb7-35"><a href="#cb7-35"></a> <span class="fl">1.067</span>   <span class="fl">3.645</span>   <span class="fl">0.902</span></span>
<span id="cb7-36"><a href="#cb7-36"></a> </span>
<span id="cb7-37"><a href="#cb7-37"></a><span class="kw">prettyNum</span>(<span class="kw">permuteCount</span>(bigVec, <span class="dv">3</span>), <span class="dt">big.mark =</span> <span class="st">&quot;,&quot;</span>)</span>
<span id="cb7-38"><a href="#cb7-38"></a>[<span class="dv">1</span>] <span class="st">&quot;214,921,200&quot;</span></span></code></pre></div>
<div id="using-arguments-lower-and-upper" class="section level3">
<h3>Using arguments <code>lower</code> and <code>upper</code></h3>
<p>There are arguments <code>lower</code> and <code>upper</code> that can be utilized to generate chunks of combinations/permutations without having to generate all of them followed by subsetting. As the output is in lexicographical order, these arguments specify where to start and stop generating. For example, <code>comboGeneral(5, 3)</code> outputs 10 combinations of the vector <code>1:5</code> chosen 3 at a time. We can set <code>lower</code> to 5 in order to start generation from the <em>5<sup>th</sup></em> lexicographical combination. Similarly, we can set <code>upper</code> to 4 in order to only generate the first 4 combinations. We can also use them together to produce only a certain chunk of combinations. For example, setting <code>lower</code> to 4 and <code>upper</code> to 6 only produces the <em>4<sup>th</sup></em>, <em>5<sup>th</sup></em>, and <em>6<sup>th</sup></em> lexicographical combinations. Observe:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">comboGeneral</span>(<span class="dv">5</span>, <span class="dv">3</span>, <span class="dt">lower =</span> <span class="dv">4</span>, <span class="dt">upper =</span> <span class="dv">6</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a>     [,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>]</span>
<span id="cb8-3"><a href="#cb8-3"></a>[<span class="dv">1</span>,]    <span class="dv">1</span>    <span class="dv">3</span>    <span class="dv">4</span></span>
<span id="cb8-4"><a href="#cb8-4"></a>[<span class="dv">2</span>,]    <span class="dv">1</span>    <span class="dv">3</span>    <span class="dv">5</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>[<span class="dv">3</span>,]    <span class="dv">1</span>    <span class="dv">4</span>    <span class="dv">5</span></span>
<span id="cb8-6"><a href="#cb8-6"></a></span>
<span id="cb8-7"><a href="#cb8-7"></a><span class="co">## is equivalent to the following:</span></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="kw">comboGeneral</span>(<span class="dv">5</span>, <span class="dv">3</span>)[<span class="dv">4</span><span class="op">:</span><span class="dv">6</span>, ]</span>
<span id="cb8-9"><a href="#cb8-9"></a>     [,<span class="dv">1</span>] [,<span class="dv">2</span>] [,<span class="dv">3</span>]</span>
<span id="cb8-10"><a href="#cb8-10"></a>[<span class="dv">1</span>,]    <span class="dv">1</span>    <span class="dv">3</span>    <span class="dv">4</span></span>
<span id="cb8-11"><a href="#cb8-11"></a>[<span class="dv">2</span>,]    <span class="dv">1</span>    <span class="dv">3</span>    <span class="dv">5</span></span>
<span id="cb8-12"><a href="#cb8-12"></a>[<span class="dv">3</span>,]    <span class="dv">1</span>    <span class="dv">4</span>    <span class="dv">5</span></span></code></pre></div>
</div>
<div id="generating-results-beyond-.machineinteger.max" class="section level3">
<h3>Generating Results Beyond <code>.Machine$integer.max</code></h3>
<p>In addition to being useful by avoiding the unnecessary overhead of generating all combination/permutations followed by subsetting just to see a few specific results, <code>lower</code> and <code>upper</code> can be utilized to generate large number of combinations/permutations in parallel (see this <a href="https://stackoverflow.com/a/51595866/4408538">stackoverflow post</a> for a real use case). Observe:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co">## Over 3 billion results</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="kw">comboCount</span>(<span class="dv">35</span>, <span class="dv">15</span>)</span>
<span id="cb9-3"><a href="#cb9-3"></a>[<span class="dv">1</span>] <span class="dv">3247943160</span></span>
<span id="cb9-4"><a href="#cb9-4"></a></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co">## 10086780 evenly divides 3247943160, otherwise you need to ensure that</span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co">## upper does not exceed the total number of results (E.g. see below, we</span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">## would have &quot;if ((x + foo) &gt; 3247943160) {myUpper = 3247943160}&quot; where</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co">## foo is the size of the increment you choose to use in seq()).</span></span>
<span id="cb9-9"><a href="#cb9-9"></a></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="kw">system.time</span>(<span class="kw">lapply</span>(<span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">3247943160</span>, <span class="dv">10086780</span>), <span class="cf">function</span>(x) {</span>
<span id="cb9-11"><a href="#cb9-11"></a>     temp &lt;-<span class="st"> </span><span class="kw">comboGeneral</span>(<span class="dv">35</span>, <span class="dv">15</span>, <span class="dt">lower =</span> x, <span class="dt">upper =</span> x <span class="op">+</span><span class="st"> </span><span class="dv">10086779</span>)</span>
<span id="cb9-12"><a href="#cb9-12"></a>     <span class="co">## do something</span></span>
<span id="cb9-13"><a href="#cb9-13"></a>     x</span>
<span id="cb9-14"><a href="#cb9-14"></a>}))</span>
<span id="cb9-15"><a href="#cb9-15"></a>   user  system elapsed </span>
<span id="cb9-16"><a href="#cb9-16"></a> <span class="fl">99.495</span>  <span class="fl">49.993</span> <span class="fl">149.467</span></span>
<span id="cb9-17"><a href="#cb9-17"></a></span>
<span id="cb9-18"><a href="#cb9-18"></a></span>
<span id="cb9-19"><a href="#cb9-19"></a><span class="co">## Enter parallel</span></span>
<span id="cb9-20"><a href="#cb9-20"></a><span class="kw">library</span>(parallel)</span>
<span id="cb9-21"><a href="#cb9-21"></a><span class="kw">system.time</span>(<span class="kw">mclapply</span>(<span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">3247943160</span>, <span class="dv">10086780</span>), <span class="cf">function</span>(x) {</span>
<span id="cb9-22"><a href="#cb9-22"></a>     temp &lt;-<span class="st"> </span><span class="kw">comboGeneral</span>(<span class="dv">35</span>, <span class="dv">15</span>, <span class="dt">lower =</span> x, <span class="dt">upper =</span> x <span class="op">+</span><span class="st"> </span><span class="dv">10086779</span>)</span>
<span id="cb9-23"><a href="#cb9-23"></a>     <span class="co">## do something</span></span>
<span id="cb9-24"><a href="#cb9-24"></a>     x</span>
<span id="cb9-25"><a href="#cb9-25"></a>}, <span class="dt">mc.cores =</span> <span class="dv">6</span>))</span>
<span id="cb9-26"><a href="#cb9-26"></a>   user  system elapsed </span>
<span id="cb9-27"><a href="#cb9-27"></a><span class="fl">125.361</span>  <span class="fl">85.916</span>  <span class="fl">35.641</span></span></code></pre></div>
</div>
</div>
<div id="gmp-support" class="section level2">
<h2>GMP Support</h2>
<p>The arguments <code>lower</code> and <code>upper</code> are also useful when one needs to explore combinations/permutations where the number of results is large:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">set.seed</span>(<span class="dv">222</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a>myVec &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1000</span>)</span>
<span id="cb10-3"><a href="#cb10-3"></a></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co">## HUGE number of combinations</span></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="kw">comboCount</span>(myVec, <span class="dv">50</span>, <span class="dt">repetition =</span> <span class="ot">TRUE</span>)</span>
<span id="cb10-6"><a href="#cb10-6"></a>Big <span class="kw">Integer</span> (<span class="st">&#39;bigz&#39;</span>) <span class="op">:</span></span>
<span id="cb10-7"><a href="#cb10-7"></a>[<span class="dv">1</span>] <span class="dv">109740941767310814894854141592555528130828577427079559745647393417766593803205094888320</span></span>
<span id="cb10-8"><a href="#cb10-8"></a></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="co">## Let&#39;s look at one hundred thousand combinations in the range (1e15 + 1, 1e15 + 1e5)</span></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="kw">system.time</span>(b &lt;-<span class="st"> </span><span class="kw">comboGeneral</span>(myVec, <span class="dv">50</span>, <span class="ot">TRUE</span>, </span>
<span id="cb10-11"><a href="#cb10-11"></a>                              <span class="dt">lower =</span> <span class="fl">1e15</span> <span class="op">+</span><span class="st"> </span><span class="dv">1</span>,</span>
<span id="cb10-12"><a href="#cb10-12"></a>                              <span class="dt">upper =</span> <span class="fl">1e15</span> <span class="op">+</span><span class="st"> </span><span class="fl">1e5</span>))</span>
<span id="cb10-13"><a href="#cb10-13"></a>   user  system elapsed </span>
<span id="cb10-14"><a href="#cb10-14"></a>  <span class="fl">0.008</span>   <span class="fl">0.000</span>   <span class="fl">0.008</span></span>
<span id="cb10-15"><a href="#cb10-15"></a>  </span>
<span id="cb10-16"><a href="#cb10-16"></a>b[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">45</span><span class="op">:</span><span class="dv">50</span>]</span>
<span id="cb10-17"><a href="#cb10-17"></a>          [,<span class="dv">1</span>]      [,<span class="dv">2</span>]      [,<span class="dv">3</span>]     [,<span class="dv">4</span>]      [,<span class="dv">5</span>]       [,<span class="dv">6</span>]</span>
<span id="cb10-18"><a href="#cb10-18"></a>[<span class="dv">1</span>,] <span class="fl">0.5454861</span> <span class="fl">0.4787456</span> <span class="fl">0.7797122</span> <span class="fl">2.004614</span> <span class="fl">-1.257629</span> <span class="fl">-0.7740501</span></span>
<span id="cb10-19"><a href="#cb10-19"></a>[<span class="dv">2</span>,] <span class="fl">0.5454861</span> <span class="fl">0.4787456</span> <span class="fl">0.7797122</span> <span class="fl">2.004614</span> <span class="fl">-1.257629</span>  <span class="fl">0.1224679</span></span>
<span id="cb10-20"><a href="#cb10-20"></a>[<span class="dv">3</span>,] <span class="fl">0.5454861</span> <span class="fl">0.4787456</span> <span class="fl">0.7797122</span> <span class="fl">2.004614</span> <span class="fl">-1.257629</span> <span class="fl">-0.2033493</span></span>
<span id="cb10-21"><a href="#cb10-21"></a>[<span class="dv">4</span>,] <span class="fl">0.5454861</span> <span class="fl">0.4787456</span> <span class="fl">0.7797122</span> <span class="fl">2.004614</span> <span class="fl">-1.257629</span>  <span class="fl">1.5511027</span></span>
<span id="cb10-22"><a href="#cb10-22"></a>[<span class="dv">5</span>,] <span class="fl">0.5454861</span> <span class="fl">0.4787456</span> <span class="fl">0.7797122</span> <span class="fl">2.004614</span> <span class="fl">-1.257629</span>  <span class="fl">1.0792094</span></span></code></pre></div>
</div>
<div id="user-defined-functions" class="section level2">
<h2>User Defined Functions</h2>
<p>You can also pass user defined functions by utilizing the argument <code>FUN</code>. This feature’s main purpose is for convenience, however it is somewhat more efficient than generating all combinations/permutations and then using a function from the <code>apply</code> family (N.B. the argument <code>Parallel</code> has no effect when <code>FUN</code> is employed).</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>funCustomComb =<span class="st"> </span><span class="cf">function</span>(n, r) {</span>
<span id="cb11-2"><a href="#cb11-2"></a>    combs =<span class="st"> </span><span class="kw">comboGeneral</span>(n, r)</span>
<span id="cb11-3"><a href="#cb11-3"></a>    <span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(combs), <span class="cf">function</span>(x) <span class="kw">cumprod</span>(combs[x,]))</span>
<span id="cb11-4"><a href="#cb11-4"></a>}</span>
<span id="cb11-5"><a href="#cb11-5"></a></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="kw">identical</span>(<span class="kw">funCustomComb</span>(<span class="dv">15</span>, <span class="dv">8</span>), <span class="kw">comboGeneral</span>(<span class="dv">15</span>, <span class="dv">8</span>, <span class="dt">FUN =</span> cumprod))</span>
<span id="cb11-7"><a href="#cb11-7"></a>[<span class="dv">1</span>] <span class="ot">TRUE</span></span>
<span id="cb11-8"><a href="#cb11-8"></a></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="kw">microbenchmark</span>(<span class="dt">f1 =</span> <span class="kw">funCustomComb</span>(<span class="dv">15</span>, <span class="dv">8</span>),</span>
<span id="cb11-10"><a href="#cb11-10"></a>               <span class="dt">f2 =</span> <span class="kw">comboGeneral</span>(<span class="dv">15</span>, <span class="dv">8</span>, <span class="dt">FUN =</span> cumprod), <span class="dt">unit =</span> <span class="st">&quot;relative&quot;</span>)</span>
<span id="cb11-11"><a href="#cb11-11"></a>unit<span class="op">:</span><span class="st"> </span>relative</span>
<span id="cb11-12"><a href="#cb11-12"></a> expr      min       lq     mean   median       uq      max neval</span>
<span id="cb11-13"><a href="#cb11-13"></a>   f1 <span class="fl">6.948574</span> <span class="fl">6.955633</span> <span class="fl">6.960554</span> <span class="fl">6.961681</span> <span class="fl">6.515623</span> <span class="fl">9.688503</span>   <span class="dv">100</span></span>
<span id="cb11-14"><a href="#cb11-14"></a>   f2 <span class="fl">1.000000</span> <span class="fl">1.000000</span> <span class="fl">1.000000</span> <span class="fl">1.000000</span> <span class="fl">1.000000</span> <span class="fl">1.000000</span>   <span class="dv">100</span></span>
<span id="cb11-15"><a href="#cb11-15"></a>   </span>
<span id="cb11-16"><a href="#cb11-16"></a><span class="kw">comboGeneral</span>(<span class="dv">15</span>, <span class="dv">8</span>, <span class="dt">FUN =</span> cumprod, <span class="dt">upper =</span> <span class="dv">3</span>)</span>
<span id="cb11-17"><a href="#cb11-17"></a>[[<span class="dv">1</span>]]</span>
<span id="cb11-18"><a href="#cb11-18"></a>[<span class="dv">1</span>]     <span class="dv">1</span>     <span class="dv">2</span>     <span class="dv">6</span>    <span class="dv">24</span>   <span class="dv">120</span>   <span class="dv">720</span>  <span class="dv">5040</span> <span class="dv">40320</span></span>
<span id="cb11-19"><a href="#cb11-19"></a></span>
<span id="cb11-20"><a href="#cb11-20"></a>[[<span class="dv">2</span>]]</span>
<span id="cb11-21"><a href="#cb11-21"></a>[<span class="dv">1</span>]     <span class="dv">1</span>     <span class="dv">2</span>     <span class="dv">6</span>    <span class="dv">24</span>   <span class="dv">120</span>   <span class="dv">720</span>  <span class="dv">5040</span> <span class="dv">45360</span></span>
<span id="cb11-22"><a href="#cb11-22"></a></span>
<span id="cb11-23"><a href="#cb11-23"></a>[[<span class="dv">3</span>]]</span>
<span id="cb11-24"><a href="#cb11-24"></a>[<span class="dv">1</span>]     <span class="dv">1</span>     <span class="dv">2</span>     <span class="dv">6</span>    <span class="dv">24</span>   <span class="dv">120</span>   <span class="dv">720</span>  <span class="dv">5040</span> <span class="dv">50400</span></span>
<span id="cb11-25"><a href="#cb11-25"></a></span>
<span id="cb11-26"><a href="#cb11-26"></a></span>
<span id="cb11-27"><a href="#cb11-27"></a><span class="co">## An example involving the powerset</span></span>
<span id="cb11-28"><a href="#cb11-28"></a><span class="kw">unlist</span>(<span class="kw">comboGeneral</span>(<span class="kw">c</span>(<span class="st">&quot;&quot;</span>, letters[<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>]), <span class="dv">3</span>, </span>
<span id="cb11-29"><a href="#cb11-29"></a>                    <span class="dt">freqs =</span> <span class="kw">c</span>(<span class="dv">2</span>, <span class="kw">rep</span>(<span class="dv">1</span>, <span class="dv">3</span>)),</span>
<span id="cb11-30"><a href="#cb11-30"></a>                    <span class="dt">FUN =</span> <span class="cf">function</span>(x) <span class="kw">paste0</span>(x, <span class="dt">collapse =</span> <span class="st">&quot;&quot;</span>)))</span>
<span id="cb11-31"><a href="#cb11-31"></a>[<span class="dv">1</span>] <span class="st">&quot;a&quot;</span>   <span class="st">&quot;b&quot;</span>   <span class="st">&quot;c&quot;</span>   <span class="st">&quot;ab&quot;</span>  <span class="st">&quot;ac&quot;</span>  <span class="st">&quot;bc&quot;</span>  <span class="st">&quot;abc&quot;</span></span></code></pre></div>
<hr />
</div>
<div id="partitions-of-groups-of-equal-size-with-combogroups" class="section level2">
<h2>Partitions of Groups of Equal Size with <code>comboGroups</code></h2>
<p>Given a vector of length <em>n</em> and <em>k</em> groups, where <em>k</em> divides <em>n</em>, each group is comprised of a combination of the vector chosen <em>g = n / k</em> at a time. As is stated in the documentation (see <code>?comboGroups</code>), these can be constructed by first generating all permutations of the vector and subsequently removing entries with permuted groups. Let us consider the following example. Given <code>v = 1:12</code>, generate all partitions <code>v</code> into 3 groups each of size 4.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>funBruteGrp &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">myLow =</span> <span class="dv">1</span>, myUp) {</span>
<span id="cb12-2"><a href="#cb12-2"></a>    mat &lt;-<span class="st"> </span><span class="kw">do.call</span>(rbind, <span class="kw">permuteGeneral</span>(<span class="dv">12</span>, <span class="dt">lower =</span> myLow, <span class="dt">upper =</span> myUp,</span>
<span id="cb12-3"><a href="#cb12-3"></a>        <span class="dt">FUN =</span> <span class="cf">function</span>(x) {</span>
<span id="cb12-4"><a href="#cb12-4"></a>        <span class="kw">sapply</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">8</span>, <span class="dv">4</span>), <span class="cf">function</span>(y) {</span>
<span id="cb12-5"><a href="#cb12-5"></a>            <span class="kw">paste0</span>(<span class="kw">c</span>(<span class="st">&quot;(&quot;</span>, x[(y <span class="op">+</span><span class="st"> </span><span class="dv">1</span>)<span class="op">:</span>(y <span class="op">+</span><span class="st"> </span><span class="dv">4</span>)], <span class="st">&quot;)&quot;</span>), <span class="dt">collapse =</span> <span class="st">&quot; &quot;</span>)</span>
<span id="cb12-6"><a href="#cb12-6"></a>        })</span>
<span id="cb12-7"><a href="#cb12-7"></a>    }))</span>
<span id="cb12-8"><a href="#cb12-8"></a>    <span class="kw">colnames</span>(mat) &lt;-<span class="st"> </span><span class="kw">paste0</span>(<span class="st">&quot;Grp&quot;</span>, <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</span>
<span id="cb12-9"><a href="#cb12-9"></a>    <span class="kw">rownames</span>(mat) &lt;-<span class="st"> </span>myLow<span class="op">:</span>myUp</span>
<span id="cb12-10"><a href="#cb12-10"></a>    mat</span>
<span id="cb12-11"><a href="#cb12-11"></a>}</span>
<span id="cb12-12"><a href="#cb12-12"></a></span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="co">## All of these are the same as only the 3rd group is being permuted</span></span>
<span id="cb12-14"><a href="#cb12-14"></a><span class="kw">funBruteGrp</span>(<span class="dt">myUp =</span> <span class="dv">6</span>)</span>
<span id="cb12-15"><a href="#cb12-15"></a>  Grp1          Grp2          Grp3            </span>
<span id="cb12-16"><a href="#cb12-16"></a><span class="dv">1</span> <span class="st">&quot;( 1 2 3 4 )&quot;</span> <span class="st">&quot;( 5 6 7 8 )&quot;</span> <span class="st">&quot;( 9 10 11 12 )&quot;</span></span>
<span id="cb12-17"><a href="#cb12-17"></a><span class="dv">2</span> <span class="st">&quot;( 1 2 3 4 )&quot;</span> <span class="st">&quot;( 5 6 7 8 )&quot;</span> <span class="st">&quot;( 9 10 12 11 )&quot;</span></span>
<span id="cb12-18"><a href="#cb12-18"></a><span class="dv">3</span> <span class="st">&quot;( 1 2 3 4 )&quot;</span> <span class="st">&quot;( 5 6 7 8 )&quot;</span> <span class="st">&quot;( 9 11 10 12 )&quot;</span></span>
<span id="cb12-19"><a href="#cb12-19"></a><span class="dv">4</span> <span class="st">&quot;( 1 2 3 4 )&quot;</span> <span class="st">&quot;( 5 6 7 8 )&quot;</span> <span class="st">&quot;( 9 11 12 10 )&quot;</span></span>
<span id="cb12-20"><a href="#cb12-20"></a><span class="dv">5</span> <span class="st">&quot;( 1 2 3 4 )&quot;</span> <span class="st">&quot;( 5 6 7 8 )&quot;</span> <span class="st">&quot;( 9 12 10 11 )&quot;</span></span>
<span id="cb12-21"><a href="#cb12-21"></a><span class="dv">6</span> <span class="st">&quot;( 1 2 3 4 )&quot;</span> <span class="st">&quot;( 5 6 7 8 )&quot;</span> <span class="st">&quot;( 9 12 11 10 )&quot;</span></span>
<span id="cb12-22"><a href="#cb12-22"></a></span>
<span id="cb12-23"><a href="#cb12-23"></a><span class="co">## We found our second distinct partition</span></span>
<span id="cb12-24"><a href="#cb12-24"></a><span class="kw">funBruteGrp</span>(<span class="dt">myLow =</span> <span class="dv">23</span>, <span class="dt">myUp =</span> <span class="dv">26</span>)</span>
<span id="cb12-25"><a href="#cb12-25"></a>   Grp1          Grp2          Grp3            </span>
<span id="cb12-26"><a href="#cb12-26"></a><span class="dv">23</span> <span class="st">&quot;( 1 2 3 4 )&quot;</span> <span class="st">&quot;( 5 6 7 8 )&quot;</span> <span class="st">&quot;( 12 11 9 10 )&quot;</span></span>
<span id="cb12-27"><a href="#cb12-27"></a><span class="dv">24</span> <span class="st">&quot;( 1 2 3 4 )&quot;</span> <span class="st">&quot;( 5 6 7 8 )&quot;</span> <span class="st">&quot;( 12 11 10 9 )&quot;</span></span>
<span id="cb12-28"><a href="#cb12-28"></a><span class="dv">25</span> <span class="st">&quot;( 1 2 3 4 )&quot;</span> <span class="st">&quot;( 5 6 7 9 )&quot;</span> <span class="st">&quot;( 8 10 11 12 )&quot;</span>  <span class="co">## &lt;&lt;-- 2nd distinct partition of groups</span></span>
<span id="cb12-29"><a href="#cb12-29"></a><span class="dv">26</span> <span class="st">&quot;( 1 2 3 4 )&quot;</span> <span class="st">&quot;( 5 6 7 9 )&quot;</span> <span class="st">&quot;( 8 10 12 11 )&quot;</span></span>
<span id="cb12-30"><a href="#cb12-30"></a></span>
<span id="cb12-31"><a href="#cb12-31"></a><span class="kw">funBruteGrp</span>(<span class="dt">myLow =</span> <span class="dv">48</span>, <span class="dt">myUp =</span> <span class="dv">50</span>)</span>
<span id="cb12-32"><a href="#cb12-32"></a>   Grp1          Grp2           Grp3            </span>
<span id="cb12-33"><a href="#cb12-33"></a><span class="dv">48</span> <span class="st">&quot;( 1 2 3 4 )&quot;</span> <span class="st">&quot;( 5 6 7 9 )&quot;</span>  <span class="st">&quot;( 12 11 10 8 )&quot;</span></span>
<span id="cb12-34"><a href="#cb12-34"></a><span class="dv">49</span> <span class="st">&quot;( 1 2 3 4 )&quot;</span> <span class="st">&quot;( 5 6 7 10 )&quot;</span> <span class="st">&quot;( 8 9 11 12 )&quot;</span>  <span class="co">## &lt;&lt;-- 3rd distinct partition of groups</span></span>
<span id="cb12-35"><a href="#cb12-35"></a><span class="dv">50</span> <span class="st">&quot;( 1 2 3 4 )&quot;</span> <span class="st">&quot;( 5 6 7 10 )&quot;</span> <span class="st">&quot;( 8 9 12 11 )&quot;</span> </span></code></pre></div>
<p>We are starting to see a pattern. Each new partition is exactly 24 spots away. This makes sense as there are <code>factorial(4) = 24</code> permutations of size 4. Now, this is an oversimplification as if we simply generate every <em>24<sup>th</sup></em> permutation, we will still get duplication as they start to carry over to the other groups. Observe:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">do.call</span>(rbind, <span class="kw">lapply</span>(<span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">145</span>, <span class="dv">24</span>), <span class="cf">function</span>(x) {</span>
<span id="cb13-2"><a href="#cb13-2"></a>    <span class="kw">funBruteGrp</span>(<span class="dt">myLow =</span> x, <span class="dt">myUp =</span> x)</span>
<span id="cb13-3"><a href="#cb13-3"></a>}))</span>
<span id="cb13-4"><a href="#cb13-4"></a>Grp1          Grp2           Grp3            </span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="dv">1</span>   <span class="st">&quot;( 1 2 3 4 )&quot;</span> <span class="st">&quot;( 5 6 7 8 )&quot;</span>  <span class="st">&quot;( 9 10 11 12 )&quot;</span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="dv">25</span>  <span class="st">&quot;( 1 2 3 4 )&quot;</span> <span class="st">&quot;( 5 6 7 9 )&quot;</span>  <span class="st">&quot;( 8 10 11 12 )&quot;</span></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="dv">49</span>  <span class="st">&quot;( 1 2 3 4 )&quot;</span> <span class="st">&quot;( 5 6 7 10 )&quot;</span> <span class="st">&quot;( 8 9 11 12 )&quot;</span> </span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="dv">73</span>  <span class="st">&quot;( 1 2 3 4 )&quot;</span> <span class="st">&quot;( 5 6 7 11 )&quot;</span> <span class="st">&quot;( 8 9 10 12 )&quot;</span> </span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="dv">97</span>  <span class="st">&quot;( 1 2 3 4 )&quot;</span> <span class="st">&quot;( 5 6 7 12 )&quot;</span> <span class="st">&quot;( 8 9 10 11 )&quot;</span> </span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="dv">121</span> <span class="st">&quot;( 1 2 3 4 )&quot;</span> <span class="st">&quot;( 5 6 8 7 )&quot;</span>  <span class="st">&quot;( 9 10 11 12 )&quot;</span>  <span class="co">## &lt;&lt;-- This is the same as the 1st</span></span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="dv">145</span> <span class="st">&quot;( 1 2 3 4 )&quot;</span> <span class="st">&quot;( 5 6 8 9 )&quot;</span>  <span class="st">&quot;( 7 10 11 12 )&quot;</span>  <span class="co">## partition. The only difference is</span></span>
<span id="cb13-12"><a href="#cb13-12"></a><span class="dv">169</span> <span class="st">&quot;( 1 2 3 4 )&quot;</span> <span class="st">&quot;( 5 6 8 10 )&quot;</span> <span class="st">&quot;( 7 9 11 12 )&quot;</span>   <span class="co">## that the 2nd Grp has been permuted</span></span></code></pre></div>
<p>This only gets more muddled as the number of groups increases. It is also very inefficient, however this exercise hopefully serves to better illustrate these structures.</p>
<p>The algorithm in <code>comboGroups</code> avoids all of this duplication by implementing a novel algorithm akin to <a href="https://en.cppreference.com/w/cpp/algorithm/next_permutation">std::next_permutation</a> from the algorithm library in <code>C++</code>.</p>
<pre><code>system.time(comboGroups(12, numGroups = 3))
   user  system elapsed 
      0       0       0
      
ht(comboGroups(12, numGroups = 3))
head --&gt;
     Grp1 Grp1 Grp1 Grp1 Grp2 Grp2 Grp2 Grp2 Grp3 Grp3 Grp3 Grp3
[1,]    1    2    3    4    5    6    7    8    9   10   11   12
[2,]    1    2    3    4    5    6    7    9    8   10   11   12
[3,]    1    2    3    4    5    6    7   10    8    9   11   12
[4,]    1    2    3    4    5    6    7   11    8    9   10   12
[5,]    1    2    3    4    5    6    7   12    8    9   10   11
--------
tail --&gt;
        Grp1 Grp1 Grp1 Grp1 Grp2 Grp2 Grp2 Grp2 Grp3 Grp3 Grp3 Grp3
[5771,]    1   10   11   12    2    5    8    9    3    4    6    7
[5772,]    1   10   11   12    2    6    7    8    3    4    5    9
[5773,]    1   10   11   12    2    6    7    9    3    4    5    8
[5774,]    1   10   11   12    2    6    8    9    3    4    5    7
[5775,]    1   10   11   12    2    7    8    9    3    4    5    6</code></pre>
<p>Just as in <code>combo/permuteGeneral</code>, we can utilize the arguments <code>lower</code>, <code>upper</code>, <code>Parallel</code>, and <code>nThreads</code>.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">comboGroupsCount</span>(<span class="dv">30</span>, <span class="dv">6</span>)</span>
<span id="cb15-2"><a href="#cb15-2"></a>Big <span class="kw">Integer</span> (<span class="st">&#39;bigz&#39;</span>) <span class="op">:</span></span>
<span id="cb15-3"><a href="#cb15-3"></a>[<span class="dv">1</span>] <span class="dv">123378675083039376</span></span>
<span id="cb15-4"><a href="#cb15-4"></a></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="kw">system.time</span>(a1 &lt;-<span class="st"> </span><span class="kw">comboGroups</span>(<span class="dv">30</span>, <span class="dt">numGroups =</span> <span class="dv">6</span>, </span>
<span id="cb15-6"><a href="#cb15-6"></a>                              <span class="dt">lower =</span> <span class="st">&quot;123378675000000000&quot;</span>,</span>
<span id="cb15-7"><a href="#cb15-7"></a>                              <span class="dt">upper =</span> <span class="st">&quot;123378675005000000&quot;</span>))</span>
<span id="cb15-8"><a href="#cb15-8"></a>   user  system elapsed </span>
<span id="cb15-9"><a href="#cb15-9"></a>  <span class="fl">0.299</span>   <span class="fl">0.113</span>   <span class="fl">0.412</span></span>
<span id="cb15-10"><a href="#cb15-10"></a></span>
<span id="cb15-11"><a href="#cb15-11"></a><span class="co">## Use specific number of threads</span></span>
<span id="cb15-12"><a href="#cb15-12"></a><span class="kw">system.time</span>(a2 &lt;-<span class="st"> </span><span class="kw">comboGroups</span>(<span class="dv">30</span>, <span class="dt">numGroups =</span> <span class="dv">6</span>, </span>
<span id="cb15-13"><a href="#cb15-13"></a>                              <span class="dt">lower =</span> <span class="st">&quot;123378675000000000&quot;</span>,</span>
<span id="cb15-14"><a href="#cb15-14"></a>                              <span class="dt">upper =</span> <span class="st">&quot;123378675005000000&quot;</span>, <span class="dt">nThreads =</span> <span class="dv">4</span>))</span>
<span id="cb15-15"><a href="#cb15-15"></a>   user  system elapsed </span>
<span id="cb15-16"><a href="#cb15-16"></a>  <span class="fl">0.358</span>   <span class="fl">0.197</span>   <span class="fl">0.146</span></span>
<span id="cb15-17"><a href="#cb15-17"></a></span>
<span id="cb15-18"><a href="#cb15-18"></a><span class="co">## Use n - 1 number of threads (int this case, there are 7)</span></span>
<span id="cb15-19"><a href="#cb15-19"></a><span class="kw">system.time</span>(a3 &lt;-<span class="st"> </span><span class="kw">comboGroups</span>(<span class="dv">30</span>, <span class="dt">numGroups =</span> <span class="dv">6</span>, </span>
<span id="cb15-20"><a href="#cb15-20"></a>                              <span class="dt">lower =</span> <span class="st">&quot;123378675000000000&quot;</span>,</span>
<span id="cb15-21"><a href="#cb15-21"></a>                              <span class="dt">upper =</span> <span class="st">&quot;123378675005000000&quot;</span>, <span class="dt">Parallel =</span> <span class="ot">TRUE</span>))</span>
<span id="cb15-22"><a href="#cb15-22"></a>   user  system elapsed </span>
<span id="cb15-23"><a href="#cb15-23"></a>  <span class="fl">0.466</span>   <span class="fl">0.307</span>   <span class="fl">0.118</span></span>
<span id="cb15-24"><a href="#cb15-24"></a>  </span>
<span id="cb15-25"><a href="#cb15-25"></a><span class="kw">identical</span>(a1, a2)</span>
<span id="cb15-26"><a href="#cb15-26"></a>[<span class="dv">1</span>] <span class="ot">TRUE</span></span>
<span id="cb15-27"><a href="#cb15-27"></a></span>
<span id="cb15-28"><a href="#cb15-28"></a><span class="kw">identical</span>(a1, a3)</span>
<span id="cb15-29"><a href="#cb15-29"></a>[<span class="dv">1</span>] <span class="ot">TRUE</span></span></code></pre></div>
<p>There is one additional argument (i.e. <code>retType</code>) not present in the other two general functions that allows the user to specify the type of object returned. The user can select between <code>&quot;matrix&quot;</code> (the default) and <code>&quot;3Darray&quot;</code>. This structure has a natural connection to 3D space. We have a particular result (<em>1<sup>st</sup></em> dimension) broken down into groups (<em>2<sup>nd</sup></em> dimension) of a certain size (<em>3<sup>rd</sup></em> dimension).</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>my3D &lt;-<span class="st"> </span><span class="kw">comboGroups</span>(<span class="kw">factor</span>(month.abb), <span class="dv">4</span>, <span class="dt">retType =</span> <span class="st">&quot;3Darray&quot;</span>)</span>
<span id="cb16-2"><a href="#cb16-2"></a>my3D[<span class="dv">1</span>, , ]</span>
<span id="cb16-3"><a href="#cb16-3"></a>     Grp1 Grp2 Grp3 Grp4</span>
<span id="cb16-4"><a href="#cb16-4"></a>[<span class="dv">1</span>,] Jan  Apr  Jul  Oct </span>
<span id="cb16-5"><a href="#cb16-5"></a>[<span class="dv">2</span>,] Feb  May  Aug  Nov </span>
<span id="cb16-6"><a href="#cb16-6"></a>[<span class="dv">3</span>,] Mar  Jun  Sep  Dec </span>
<span id="cb16-7"><a href="#cb16-7"></a>Levels<span class="op">:</span><span class="st"> </span>Apr Aug Dec Feb Jan Jul Jun Mar May Nov Oct Sep</span>
<span id="cb16-8"><a href="#cb16-8"></a></span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="kw">comboGroupsCount</span>(<span class="dv">12</span>, <span class="dv">4</span>)</span>
<span id="cb16-10"><a href="#cb16-10"></a>[<span class="dv">1</span>] <span class="dv">15400</span></span>
<span id="cb16-11"><a href="#cb16-11"></a></span>
<span id="cb16-12"><a href="#cb16-12"></a>my3D[<span class="dv">15400</span>, , ]</span>
<span id="cb16-13"><a href="#cb16-13"></a>     Grp1 Grp2 Grp3 Grp4</span>
<span id="cb16-14"><a href="#cb16-14"></a>[<span class="dv">1</span>,] Jan  Feb  Mar  Apr </span>
<span id="cb16-15"><a href="#cb16-15"></a>[<span class="dv">2</span>,] Nov  Sep  Jul  May </span>
<span id="cb16-16"><a href="#cb16-16"></a>[<span class="dv">3</span>,] Dec  Oct  Aug  Jun </span>
<span id="cb16-17"><a href="#cb16-17"></a>Levels<span class="op">:</span><span class="st"> </span>Apr Aug Dec Feb Jan Jul Jun Mar May Nov Oct Sep</span></code></pre></div>
<div id="relevant-posts-on-stackoverflow-as-well-as-oeis." class="section level3">
<h3>Relevant Posts on Stackoverflow as well as OEIS.</h3>
<ul>
<li><a href="https://stackoverflow.com/a/51754958/4408538">Iterating through combinations of groups of 4 within a group of 16</a></li>
<li><a href="https://stackoverflow.com/q/57732672/4408538">Create Combinations in R by Groups</a></li>
<li><a href="https://stackoverflow.com/q/39126712/4408538">Algorithm that can create all combinations and all groups of those combinations</a></li>
<li><a href="https://oeis.org/A025035" class="uri">https://oeis.org/A025035</a> (See also sequences A025036-A025042)</li>
</ul>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
