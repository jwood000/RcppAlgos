<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Prime Counting Function \(\pi(x)\) — primeCount • RcppAlgos</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Prime Counting Function \(\pi(x)\) — primeCount"><meta name="description" content="Prime counting function for counting the prime numbers less than an integer, \(n\), using Legendre's formula. It is based on the the algorithm developed by Kim Walisch found here: kimwalisch/primecount."><meta property="og:description" content="Prime counting function for counting the prime numbers less than an integer, \(n\), using Legendre's formula. It is based on the the algorithm developed by Kim Walisch found here: kimwalisch/primecount."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">RcppAlgos</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.9.5</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/CombinatorialSampling.html">Combinatorial Sampling and Ranking</a></li>
    <li><a class="dropdown-item" href="../articles/CombinatoricsIterators.html">Combinatorial Iterators in RcppAlgos</a></li>
    <li><a class="dropdown-item" href="../articles/CombPermConstraints.html">Constraints, Partitions, and Compositions</a></li>
    <li><a class="dropdown-item" href="../articles/ComputationalMathematics.html">Computational Mathematics Overview</a></li>
    <li><a class="dropdown-item" href="../articles/GeneralCombinatorics.html">Combination and Permutation Basics</a></li>
    <li><a class="dropdown-item" href="../articles/HighPerformanceBenchmarks.html">High Performance Benchmarks</a></li>
    <li><a class="dropdown-item" href="../articles/OtherCombinatorics.html">Cartesian Products and Partitions of Groups</a></li>
    <li><a class="dropdown-item" href="../articles/SubsetSum.html">Attacking Problems Related to the Subset Sum Problem</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/jwood000/RcppAlgos/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Prime Counting Function \(\pi(x)\)</h1>

      <div class="d-none name"><code>primeCount.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><a href="https://en.wikipedia.org/wiki/Prime-counting_function" class="external-link">Prime counting function</a> for counting the prime numbers less than an integer, \(n\), using Legendre's formula. It is based on the the algorithm developed by Kim Walisch found here: <a href="https://github.com/kimwalisch/primecount" class="external-link">kimwalisch/primecount</a>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">primeCount</span><span class="op">(</span><span class="va">n</span>, nThreads <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <p></p>
<dl><dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Positive number</p></dd>

    <dt id="arg-nthreads">nThreads<a class="anchor" aria-label="anchor" href="#arg-nthreads"></a></dt>
<dd><p>Specific number of threads to be used. The default is <code>NULL</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><a href="https://mathworld.wolfram.com/LegendresFormula.html" class="external-link">Legendre's Formula</a> for counting the number of primes less than \(n\) makes use of the <a href="https://en.wikipedia.org/wiki/Inclusion-exclusion_principle" class="external-link">inclusion-exclusion principle</a> to avoid explicitly counting every prime up to \(n\). It is given by:
$$\pi(x) = \pi(\sqrt x) + \Phi(x, \sqrt x) - 1$$
Where \(\Phi(x, a)\) is the number of positive integers less than or equal to \(x\) that are relatively prime to the first \(a\) primes (i.e. not divisible by any of the first \(a\) primes). It is given by the recurrence relation (\(p_a\) is the \(ath\) prime (e.g. \(p_4 = 7\))):
$$\Phi(x, a) = \Phi(x, a - 1) + \Phi(x / p_a, a - 1)$$
This algorithm implements five modifications developed by Kim Walisch for calculating \(\Phi(x, a)\) efficiently.</p><ol><li><p>Cache results of \(\Phi(x, a)\)</p></li>
<li><p>Calculate \(\Phi(x, a)\) using \(\Phi(x, a) = (x / pp) * \phi(pp) + \Phi(x mod pp, a)\)  if \(a &lt;= 6\)
</p><ul><li><p>\(pp = 2 * 3 * ... * \) <code>prime[a]</code></p></li>
<li><p>\(\phi(pp) = (2 - 1) * (3 - 1) * ... * \) \((\)<code>prime[a]</code> \(- 1)\) (i.e. Euler's totient function)</p></li>
</ul></li>
<li><p>Calculate \(\Phi(x, a)\) using \(\pi(x)\) lookup table</p></li>
<li><p>Calculate all \(\Phi(x, a) = 1\) upfront</p></li>
<li><p>Stop recursion at \(6\) if \(\sqrt x &gt;= 13\) or \(\pi(\sqrt x)\) instead of \(1\)</p></li>
</ol></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The maximum value of \(n\) is \(2^{53} - 1\)</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>

<ul><li><p><a href="https://sweet.ua.pt/tos/bib/5.4.pdf" class="external-link">Computing \(\pi(x)\): the combinatorial method</a></p><ul><li><p>Tomás Oliveira e Silva, Computing pi(x): the combinatorial method, Revista do DETUA, vol. 4, no. 6, March 2006, p. 761. https://sweet.ua.pt/tos/bib/5.4.pdf</p></li>
</ul></li>
<li><p><a href="https://en.wikipedia.org/wiki/Double-precision_floating-point_format" class="external-link">53-bit significand precision</a></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Whole number representing the number of prime numbers less than or equal to \(n\).</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Joseph Wood</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="primeSieve.html">primeSieve</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">## Get the number of primes less than a billion</span></span></span>
<span class="r-in"><span><span class="fu">primeCount</span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="fl">9</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 50847534</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Using nThreads</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu">primeCount</span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="fl">10</span>, nThreads <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    user  system elapsed </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.005   0.000   0.004 </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Joseph Wood.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

