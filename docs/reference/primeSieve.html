<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Generate Prime Numbers — primeSieve • RcppAlgos</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Generate Prime Numbers — primeSieve" />
<meta property="og:description" content="Implementation of the segmented sieve of Eratosthenes with wheel factorization. Generates all prime numbers between bound1 and bound2 (if supplied) or all primes up to bound1. See this stackoverflow post for an analysis on prime number generation efficiency in R: Generate a list of primes up to a certain number

The fundamental concepts of this algorithm are based off of the implementation by Kim Walisch found here: kimwalisch/primesieve." />
<meta name="twitter:card" content="summary" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RcppAlgos</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">2.3.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/CombPermConstraints.html">Constraints, Integer Partitions, and Compositions</a>
    </li>
    <li>
      <a href="../articles/CombinatorialSampling.html">Combinatorial Sampling</a>
    </li>
    <li>
      <a href="../articles/ComputationalMathematics.html">Computational Mathematics Overview</a>
    </li>
    <li>
      <a href="../articles/GeneralCombinatorics.html">Combination and Permutation Basics</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jwood000/RcppAlgos">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Generate Prime Numbers</h1>
    
    <div class="hidden name"><code>primeSieve.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Implementation of the segmented sieve of Eratosthenes with wheel factorization. Generates all prime numbers between <code>bound1</code> and <code>bound2</code> (if supplied) or all primes up to <code>bound1</code>. See this stackoverflow post for an analysis on prime number generation efficiency in R: <a href='https://stackoverflow.com/a/48313378/4408538'>Generate a list of primes up to a certain number
</a></p>
<p>The fundamental concepts of this algorithm are based off of the implementation by Kim Walisch found here: <a href='https://github.com/kimwalisch/primesieve'>kimwalisch/primesieve</a>.</p>
    </div>

    <pre class="usage"><span class='fu'>primeSieve</span>(<span class='no'>bound1</span>, <span class='kw'>bound2</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>nThreads</span> <span class='kw'>=</span> <span class='kw'>NULL</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>bound1</th>
      <td><p>Positive integer or numeric value.</p></td>
    </tr>
    <tr>
      <th>bound2</th>
      <td><p>Positive integer or numeric value.</p></td>
    </tr>
    <tr>
      <th>nThreads</th>
      <td><p>Specific number of threads to be used. The default is <code>NULL</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    
<ul>
<li><p>It does not matter which bound is larger as the resulting primes will be between <code><a href='https://rdrr.io/r/base/Extremes.html'>min(bound1, bound2)</a></code> and <code><a href='https://rdrr.io/r/base/Extremes.html'>max(bound1, bound2)</a></code> if <code>bound2</code> is provided.</p></li>
<li><p>The maximum value for either of the bounds is \(2^{53} - 1\).</p></li>
</ul>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>At the heart of this algorithm is the traditional sieve of Eratosthenes (i.e. given a <a href='https://en.wikipedia.org/wiki/Prime_number'>prime</a> \(p\), mark all multiples of \(p\) as <a href='https://en.wikipedia.org/wiki/Composite_number'>composite</a>), however instead of sieving the entire interval, we only consider small sub-intervals. The benefits of this method are two fold:</p><ol>
<li><p>Reduction of the <a href='https://en.wikipedia.org/wiki/DSPACE'>space complexity</a> from \(O(n)\), for the traditional sieve, to \(O(\sqrt n)\)</p></li>
<li><p>Reduction of <a href='https://en.wikipedia.org/wiki/CPU_cache#Cache_miss'>cache misses</a></p></li>
</ol><p>The latter is of particular importance as cache memory is much more efficient and closer in proximity to the CPU than <a href='https://en.wikipedia.org/wiki/Computer_data_storage#Primary_storage'>main memory</a>. Reducing the size of the sieving interval allows for more effective utilization of the cache, which greatly impacts the overall efficiency.</p>
<p>Another optimization over the traditional sieve is the utilization of wheel factorization. With the traditional sieve of Eratosthenes, you typically check every odd index of your logical vector and if the value is true, you have found a prime. With wheel factorization using the first four primes (i.e. 2, 3, 5, and 7) to construct your wheel (i.e. 210 wheel), you only have to check indices of your logical vector that are coprime to 210 (i.e. the product of the first four primes). As an example, with \(n = 10000\) and a 210 wheel, you only have to check 2285 indices vs. 5000 with the classical implementation.</p>
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>Returns an integer vector if <code><a href='https://rdrr.io/r/base/Extremes.html'>max(bound1, bound2)</a></code> \(&lt; 2^{31}\), or a numeric vector otherwise.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    
<ul>
<li><p><a href='https://primesieve.org'>primesieve (Fast C/C++ prime number generator)</a></p></li>
<li><p><a href='https://en.wikipedia.org/wiki/Sieve_of_Eratosthenes'>Sieve of Eratosthenes</a></p></li>
<li><p><a href='https://en.wikipedia.org/wiki/Wheel_factorization'>Wheel factorization</a></p></li>
<li><p><a href='https://en.wikipedia.org/wiki/Double-precision_floating-point_format'>53-bit significand precision</a></p></li>
</ul>

    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='https://rdrr.io/pkg/numbers/man/primes.html'>Primes</a></code></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'>## Primes up to a thousand</span>
<span class='fu'>primeSieve</span>(<span class='fl'>100</span>)</div><div class='output co'>#&gt;  [1]  2  3  5  7 11 13 17 19 23 29 31 37 41 43 47 53 59 61 67 71 73 79 83 89 97</div><div class='input'>
<span class='co'>## Primes between 42 and 17</span>
<span class='fu'>primeSieve</span>(<span class='fl'>42</span>, <span class='fl'>17</span>)</div><div class='output co'>#&gt; [1] 17 19 23 29 31 37 41</div><div class='input'>
<span class='co'>## Equivalent to </span>
<span class='fu'>primeSieve</span>(<span class='fl'>17</span>, <span class='fl'>42</span>)</div><div class='output co'>#&gt; [1] 17 19 23 29 31 37 41</div><div class='input'>
<span class='co'>## Primes up to one hundred million in no time</span>
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span>(<span class='fu'>primeSieve</span>(<span class='fl'>10</span>^<span class='fl'>8</span>))</div><div class='output co'>#&gt;    user  system elapsed 
#&gt;   0.137   0.016   0.153 </div><div class='input'>
<span class='co'>## options(scipen = 50)</span>
<span class='co'>## Generate large primes over interval</span>
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span>(<span class='no'>myPs</span> <span class='kw'>&lt;-</span> <span class='fu'>primeSieve</span>(<span class='fl'>10</span>^<span class='fl'>13</span>+<span class='fl'>10</span>^<span class='fl'>6</span>, <span class='fl'>10</span>^<span class='fl'>13</span>))</div><div class='output co'>#&gt;    user  system elapsed 
#&gt;   0.017   0.002   0.019 </div><div class='input'><span class='co'>## Object created is small</span>
<span class='fu'><a href='https://rdrr.io/r/utils/object.size.html'>object.size</a></span>(<span class='no'>myPs</span>)</div><div class='output co'>#&gt; 267696 bytes</div><div class='input'>
<span class='co'>## Using nThreads</span>
<span class='fu'><a href='https://rdrr.io/r/base/system.time.html'>system.time</a></span>(<span class='fu'>primeSieve</span>(<span class='fl'>1e7</span>, <span class='kw'>nThreads</span> <span class='kw'>=</span> <span class='fl'>2</span>))</div><div class='output co'>#&gt;    user  system elapsed 
#&gt;   0.017   0.001   0.010 </div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      <li><a href="#note">Note</a></li>
      <li><a href="#details">Details</a></li>
      <li><a href="#value">Value</a></li>
      <li><a href="#references">References</a></li>
      <li><a href="#see-also">See also</a></li>
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    <p>Joseph Wood</p>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Joseph Wood.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


