<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Computational Mathematics Overview • RcppAlgos</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Computational Mathematics Overview">
<meta property="og:description" content="RcppAlgos">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RcppAlgos</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.5.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/CombPermConstraints.html">Constraints and Integer Partitions</a>
    </li>
    <li>
      <a href="../articles/CombinatorialSampling.html">Combinatorial Sampling</a>
    </li>
    <li>
      <a href="../articles/CombinatoricsIterators.html">Combinatorial Iterators in RcppAlgos</a>
    </li>
    <li>
      <a href="../articles/ComputationalMathematics.html">Computational Mathematics Overview</a>
    </li>
    <li>
      <a href="../articles/GeneralCombinatorics.html">Combination and Permutation Basics</a>
    </li>
    <li>
      <a href="../articles/HighPerformanceBenchmarks.html">High Performance Benchmarks</a>
    </li>
    <li>
      <a href="../articles/OtherCombinatorics.html">Cartesian Products and Partitions of Groups into Equal Size</a>
    </li>
    <li>
      <a href="../articles/SubsetSum.html">Attacking Problems Related to the Subset Sum Problem</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jwood000/RcppAlgos/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Computational Mathematics Overview</h1>
                        <h4 data-toc-skip class="author">Joseph Wood</h4>
            
            <h4 data-toc-skip class="date">03/13/2022</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jwood000/RcppAlgos/blob/HEAD/vignettes/ComputationalMathematics.Rmd" class="external-link"><code>vignettes/ComputationalMathematics.Rmd</code></a></small>
      <div class="hidden name"><code>ComputationalMathematics.Rmd</code></div>

    </div>

    
    
<p>This document serves as an overview for solving problems common in <a href="https://en.wikipedia.org/wiki/Computational_mathematics" class="external-link">Computational Mathematics</a>. Of note, <code>primeSieve</code> and <code>primeCount</code> are based on the excellent work by <a href="https://github.com/kimwalisch" class="external-link">Kim Walisch</a>.</p>
<hr>
<div class="section level2">
<h2 id="primesieve">
<code>primeSieve</code><a class="anchor" aria-label="anchor" href="#primesieve"></a>
</h2>
<p>The primeSieve function is based on the <a href="https://en.wikipedia.org/wiki/Sieve_of_Eratosthenes#Segmented_sieve" class="external-link">Segmented Sieve of Eratosthenes</a>. As stated in the linked article, the sieve itself is already very efficient. The problem from an efficiency standpoint, is due to the memory requirements. The segmented version overcomes this by only sieving small sections at a time, which greatly facilitates use of the cache.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jwood000/RcppAlgos" class="external-link">RcppAlgos</a></span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joshuaulrich/microbenchmark/" class="external-link">microbenchmark</a></span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html" class="external-link">microbenchmark</a></span><span class="op">(</span><span class="fu"><a href="../reference/primeSieve.html">primeSieve</a></span><span class="op">(</span><span class="fl">1e6</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Unit: milliseconds</span>
<span class="co">#&gt;               expr      min       lq     mean   median       uq      max neval</span>
<span class="co">#&gt;  primeSieve(1e+06) 1.438733 1.453663 1.571274 1.534462 1.587023 2.409306   100</span>

<span class="co">## Single threaded primes under a billion!!!</span>
<span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/primeSieve.html">primeSieve</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;  user  system elapsed</span>
<span class="co">#&gt; 1.525   0.100   1.626</span>

<span class="co">## Using 8 threads we can get under 0.5 seconds!!!</span>
<span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu"><a href="../reference/primeSieve.html">primeSieve</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="fl">9</span>, nThreads <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;  user  system elapsed</span>
<span class="co">#&gt; 2.549   0.050   0.442</span>

<span class="co">## Quickly generate large primes over small interval. N.B. The</span>
<span class="co">## order for the bounds does not matter.</span>
<span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>scipen <span class="op">=</span> <span class="fl">50</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">myPs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/primeSieve.html">primeSieve</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="fl">13</span> <span class="op">+</span> <span class="fl">10</span><span class="op">^</span><span class="fl">3</span>, <span class="fl">10</span><span class="op">^</span><span class="fl">13</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;   user  system elapsed</span>
<span class="co">#&gt;  0.011   0.001   0.011</span>

<span class="va">myPs</span>
<span class="co">#&gt;  [1] 10000000000037 10000000000051 10000000000099 10000000000129</span>
<span class="co">#&gt;  [5] 10000000000183 10000000000259 10000000000267 10000000000273</span>
<span class="co">#&gt;  [9] 10000000000279 10000000000283 10000000000313 10000000000343</span>
<span class="co">#&gt; [13] 10000000000391 10000000000411 10000000000433 10000000000453</span>
<span class="co">#&gt; [17] 10000000000591 10000000000609 10000000000643 10000000000649</span>
<span class="co">#&gt; [21] 10000000000657 10000000000687 10000000000691 10000000000717</span>
<span class="co">#&gt; [25] 10000000000729 10000000000751 10000000000759 10000000000777</span>
<span class="co">#&gt; [29] 10000000000853 10000000000883 10000000000943 10000000000957</span>
<span class="co">#&gt; [33] 10000000000987 10000000000993</span>

<span class="co">## Object created is small</span>
<span class="fu"><a href="https://rdrr.io/r/utils/object.size.html" class="external-link">object.size</a></span><span class="op">(</span><span class="va">myPs</span><span class="op">)</span>
<span class="co">#&gt; 320 bytes</span></code></pre></div>
<div class="section level3">
<h3 id="larger-primes">Larger primes<a class="anchor" aria-label="anchor" href="#larger-primes"></a>
</h3>
<p>Since version <code>2.3.0</code>, we are implementing the cache-friendly improvements for larger primes originally developed by <a href="http://sweet.ua.pt/tos/software/prime_sieve.html" class="external-link">Tomás Oliveira</a>.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Version &lt;= 2.2.0.. i.e. older versions</span>
<span class="co"># system.time(old &lt;- RcppAlgos2.2::primeSieve(1e15, 1e15 + 1e9))</span>
<span class="co">#    user  system elapsed</span>
<span class="co">#   7.615   0.140   7.792</span>

<span class="co">## v2.3.0+ is over 3x faster!</span>
<span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/primeSieve.html">primeSieve</a></span><span class="op">(</span><span class="fl">1e15</span>, <span class="fl">1e15</span> <span class="op">+</span> <span class="fl">1e9</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;   user  system elapsed</span>
<span class="co">#&gt;  2.396   0.153   2.546</span>

<span class="co">## And using nThreads we are ~8x faster</span>
<span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/primeSieve.html">primeSieve</a></span><span class="op">(</span><span class="fl">1e15</span>, <span class="fl">1e15</span> <span class="op">+</span> <span class="fl">1e9</span>, nThreads <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;   user  system elapsed</span>
<span class="co">#&gt;  4.639   0.614   0.874</span>

<span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="primecount">
<code>primeCount</code><a class="anchor" aria-label="anchor" href="#primecount"></a>
</h2>
<p>The library by Kim Walisch relies on <a href="https://en.wikipedia.org/wiki/OpenMP" class="external-link">OpenMP</a> for parallel computation with <a href="http://mathworld.wolfram.com/LegendresFormula.html" class="external-link">Legendre’s Formula</a>. Currently, the default compiler on <code>macOS</code> is <code>clang</code>, which does not support <code>OpenMP</code>. James Balamuta (a.k.a. TheCoatlessProfessor… well at least <a href="https://thecoatlessprofessor.com/about/" class="external-link">we think so</a>) has written a great article on this topic, which you can find here: <a href="https://thecoatlessprofessor.com/programming/openmp-in-r-on-os-x/" class="external-link uri">https://thecoatlessprofessor.com/programming/openmp-in-r-on-os-x/</a>. One of the goals of <code>RcppAlgos</code> is to be accessible by all users. With this in mind, we set out to count primes in parallel <em>without</em> <code>OpenMP</code>.</p>
<p>At first glance, this seems trivial as we have a function in <code>Primes.cpp</code> called <code>phiWorker</code> that counts the primes up to <code>x</code>. If you look in <a href="https://github.com/kimwalisch/primecount/blob/master/src/phi.cpp" class="external-link">phi.cpp</a> in the <code>primecount</code> library by Kim Walisch, we see that <code>OpenMP</code> does its magic on a for loop that makes repeated calls to <code>phi</code> (which is what <code>phiWorker</code> is based on). All we need to do is break this loop into <em>n</em> intervals where <em>n</em> is the number of threads. Simple, right?</p>
<p>We can certainly do this, but what you will find is that <em>n - 1</em> threads will complete very quickly and the <em>n<sup>th</sup></em> thread will be left with a heavy computation. In order to alleviate this unbalanced load, we divide the loop mentioned above into smaller intervals. The idea is to completely calculate <code>phi</code> up to a limit <em>m</em> using all <em>n</em> threads and then gradually increase <em>m</em>. The advantage here is that we are benefiting greatly from the caching done by the work of the previous <em>n</em> threads.</p>
<p>With this is mind, here are some results:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## Enumerate the number of primes below trillion</span>
<span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">underOneTrillion</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/primeCount.html">primeCount</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="fl">12</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;   user  system elapsed</span>
<span class="co">#&gt;  0.429   0.019   0.445</span>

<span class="va">underOneTrillion</span>
<span class="co">#&gt; [1] 37607912018</span>


<span class="co">## Enumerate the number of primes below a billion in 2 milliseconds</span>
<span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html" class="external-link">microbenchmark</a></span><span class="op">(</span><span class="fu"><a href="../reference/primeCount.html">primeCount</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="fl">9</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; Unit: milliseconds</span>
<span class="co">#&gt;              expr      min       lq     mean   median       uq      max neval</span>
<span class="co">#&gt;  primeCount(10^9) 1.049792 1.079531 1.177151 1.084154 1.260943 1.698243   100</span>


<span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">underOneHundredTrillion</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/primeCount.html">primeCount</a></span><span class="op">(</span><span class="fl">1e14</span>, nThreads <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;   user  system elapsed</span>
<span class="co">#&gt; 28.949   0.279   3.867</span>

<span class="va">underOneHundredTrillion</span>
<span class="co">#&gt; [1] 3204941750802</span>

<span class="co">## From Kim Walisch's primecount library:</span>
<span class="co">## Josephs-MBP:primecount-4 josephwood$ ./primecount 1e14 --legendre --time</span>
<span class="co">## 3204941750802</span>
<span class="co">## Seconds: 4.441</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="other-sieving-functions">Other Sieving Functions<a class="anchor" aria-label="anchor" href="#other-sieving-functions"></a>
</h2>
<p><code>RcppAlgos</code> comes equipped with several functions for quickly generating essential components for problems common in computational mathematics. All functions below can be executed in parallel by using the argument <code>nThreads</code>.</p>
<p>The following sieving functions (<code>primeFactorizeSieve</code>, <code>divisorsSieve</code>, <code>numDivisorSieve</code>, &amp; <code>eulerPhiSieve</code>) are very useful and flexible. Generate components up to a number or between two bounds.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## get the number of divisors for every number from 1 to n</span>
<span class="fu"><a href="../reference/numDivisorSieve.html">numDivisorSieve</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span>
<span class="co">#&gt;  [1] 1 2 2 3 2 4 2 4 3 4 2 6 2 4 4 5 2 6 2 6</span>

<span class="co">## If you want the complete factorization from 1 to n, use divisorsList</span>
<span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">allFacs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/divisorsSieve.html">divisorsSieve</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="fl">5</span>, namedList <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;  user  system elapsed</span>
<span class="co">#&gt; 0.034   0.004   0.038</span>

<span class="va">allFacs</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4339</span>, <span class="fl">15613</span>, <span class="fl">22080</span><span class="op">)</span><span class="op">]</span>
<span class="co">#&gt; $`4339`</span>
<span class="co">#&gt; [1]    1 4339</span>
<span class="co">#&gt;</span>
<span class="co">#&gt; $`15613`</span>
<span class="co">#&gt; [1]     1    13  1201 15613</span>
<span class="co">#&gt;</span>
<span class="co">#&gt; $`22080`</span>
<span class="co">#&gt;  [1]     1     2     3     4     5     6     8    10    12    15</span>
<span class="co">#&gt; [11]    16    20    23    24    30    32    40    46    48    60</span>
<span class="co">#&gt; [21]    64    69    80    92    96   115   120   138   160   184</span>
<span class="co">#&gt; [31]   192   230   240   276   320   345   368   460   480   552</span>
<span class="co">#&gt; [41]   690   736   920   960  1104  1380  1472  1840  2208  2760</span>
<span class="co">#&gt; [51]  3680  4416  5520  7360 11040 22080</span>


<span class="co">## Between two bounds</span>
<span class="fu"><a href="../reference/primeFactorizeSieve.html">primeFactorizeSieve</a></span><span class="op">(</span><span class="fl">10</span><span class="op">^</span><span class="fl">12</span>, <span class="fl">10</span><span class="op">^</span><span class="fl">12</span> <span class="op">+</span> <span class="fl">5</span><span class="op">)</span>
<span class="co">#&gt; [[1]]</span>
<span class="co">#&gt;  [1] 2 2 2 2 2 2 2 2 2 2 2 2 5 5 5 5 5 5 5 5 5 5 5 5</span>
<span class="co">#&gt;</span>
<span class="co">#&gt; [[2]]</span>
<span class="co">#&gt; [1]       73      137 99990001</span>
<span class="co">#&gt;</span>
<span class="co">#&gt; [[3]]</span>
<span class="co">#&gt; [1]            2            3 166666666667</span>
<span class="co">#&gt;</span>
<span class="co">#&gt; [[4]]</span>
<span class="co">#&gt; [1]      61   14221 1152763</span>
<span class="co">#&gt;</span>
<span class="co">#&gt; [[5]]</span>
<span class="co">#&gt; [1]      2      2     17    149    197 501001</span>
<span class="co">#&gt;</span>
<span class="co">#&gt; [[6]]</span>
<span class="co">#&gt; [1]           3           5 66666666667</span>


<span class="co">## Creating a named object</span>
<span class="fu"><a href="../reference/eulerPhiSieve.html">eulerPhiSieve</a></span><span class="op">(</span><span class="fl">20</span>, namedVector <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20</span>
<span class="co">#&gt; 1  1  2  2  4  2  6  4  6  4 10  4 12  6  8  8 16  6 18  8</span>


<span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eulerPhiSieve.html">eulerPhiSieve</a></span><span class="op">(</span><span class="fl">1e12</span>, <span class="fl">1e12</span> <span class="op">+</span> <span class="fl">1e7</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;  user  system elapsed</span>
<span class="co">#&gt; 1.308   0.057   1.346</span>

<span class="co">## Using nThreads for greater efficiency</span>
<span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eulerPhiSieve.html">eulerPhiSieve</a></span><span class="op">(</span><span class="fl">1e12</span>, <span class="fl">1e12</span> <span class="op">+</span> <span class="fl">1e7</span>, nThreads <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;  user  system elapsed</span>
<span class="co">#&gt; 3.865   0.033   0.540</span>

<span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
</div>
<div class="section level2">
<h2 id="vectorized-functions">Vectorized Functions<a class="anchor" aria-label="anchor" href="#vectorized-functions"></a>
</h2>
<p>There are three very fast vectorized functions for general factoring (e.g. all divisors of number), primality testing, as well as prime factoring (<code>divisorsRcpp</code>, <code>isPrimeRcpp</code>, <code>primeFactorize</code>).</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">## get result for individual numbers</span>
<span class="fu"><a href="../reference/primeFactorize.html">primeFactorize</a></span><span class="op">(</span><span class="fl">123456789</span><span class="op">)</span>
<span class="co">#&gt; [1]    3    3 3607 3803</span>


<span class="co">## or for an entire vector</span>
<span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>  <span class="co">## N.B. Using R version 4.1.0</span>
<span class="va">myVec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="op">-</span><span class="fl">100000000</span><span class="op">:</span><span class="fl">100000000</span>, <span class="fl">5</span><span class="op">)</span>
<span class="fu"><a href="../reference/divisorsRcpp.html">divisorsRcpp</a></span><span class="op">(</span><span class="va">myVec</span>, namedList <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; $`33331928`</span>
<span class="co">#&gt;  [1]        1        2        4        7        8       14       19       28</span>
<span class="co">#&gt;  [9]       38       56       76      133      152      266      532     1064</span>
<span class="co">#&gt; [17]    31327    62654   125308   219289   250616   438578   595213   877156</span>
<span class="co">#&gt; [25]  1190426  1754312  2380852  4166491  4761704  8332982 16665964 33331928</span>
<span class="co">#&gt;</span>
<span class="co">#&gt; $`99961494`</span>
<span class="co">#&gt;  [1]        1        2        3        6       37       74      111      222</span>
<span class="co">#&gt;  [9]   450277   900554  1350831  2701662 16660249 33320498 49980747 99961494</span>
<span class="co">#&gt;</span>
<span class="co">#&gt; $`30377219`</span>
<span class="co">#&gt; [1]        1       19  1598801 30377219</span>
<span class="co">#&gt;</span>
<span class="co">#&gt; $`-46085563`</span>
<span class="co">#&gt; [1] -46085563   -201247      -229        -1         1       229    201247</span>
<span class="co">#&gt; [8]  46085563</span>
<span class="co">#&gt;</span>
<span class="co">#&gt; $`-26510714`</span>
<span class="co">#&gt;  [1] -26510714 -13255357    -73846    -36923      -718      -359        -2</span>
<span class="co">#&gt;  [8]        -1         1         2       359       718     36923     73846</span>
<span class="co">#&gt; [15]  13255357  26510714</span>


<span class="co">## Creating a named object</span>
<span class="fu"><a href="../reference/isPrimeRcpp.html">isPrimeRcpp</a></span><span class="op">(</span><span class="fl">995</span><span class="op">:</span><span class="fl">1000</span>, namedVector <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt;   995   996   997   998   999  1000</span>
<span class="co">#&gt; FALSE FALSE  TRUE FALSE FALSE FALSE</span>

<span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">a</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/primeFactorize.html">primeFactorize</a></span><span class="op">(</span><span class="fl">1e12</span><span class="op">:</span><span class="op">(</span><span class="fl">1e12</span> <span class="op">+</span> <span class="fl">1e5</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;  user  system elapsed</span>
<span class="co">#&gt; 1.363   0.013   1.373</span>

<span class="co">## Using nThreads for greater efficiency</span>
<span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/primeFactorize.html">primeFactorize</a></span><span class="op">(</span><span class="fl">1e12</span><span class="op">:</span><span class="op">(</span><span class="fl">1e12</span> <span class="op">+</span> <span class="fl">1e5</span><span class="op">)</span>, nThreads <span class="op">=</span> <span class="fl">8</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt;  user  system elapsed</span>
<span class="co">#&gt; 2.531   0.004   0.331</span>

<span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">a</span>, <span class="va">b</span><span class="op">)</span>
<span class="co">#&gt; [1] TRUE</span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Joseph Wood.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
