<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Combinatorial Iterators in RcppAlgos • RcppAlgos</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Combinatorial Iterators in RcppAlgos">
<meta property="og:description" content="RcppAlgos">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RcppAlgos</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.7.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/CombPermConstraints.html">Constraints, Partitions, and Compositions</a>
    </li>
    <li>
      <a href="../articles/CombinatorialSampling.html">Combinatorial Sampling and Ranking</a>
    </li>
    <li>
      <a href="../articles/CombinatoricsIterators.html">Combinatorial Iterators in RcppAlgos</a>
    </li>
    <li>
      <a href="../articles/ComputationalMathematics.html">Computational Mathematics Overview</a>
    </li>
    <li>
      <a href="../articles/GeneralCombinatorics.html">Combination and Permutation Basics</a>
    </li>
    <li>
      <a href="../articles/HighPerformanceBenchmarks.html">High Performance Benchmarks</a>
    </li>
    <li>
      <a href="../articles/OtherCombinatorics.html">Cartesian Products and Partitions of Groups into Equal Size</a>
    </li>
    <li>
      <a href="../articles/SubsetSum.html">Attacking Problems Related to the Subset Sum Problem</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jwood000/RcppAlgos/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Combinatorial Iterators in RcppAlgos</h1>
                        <h4 data-toc-skip class="author">Joseph
Wood</h4>
            
            <h4 data-toc-skip class="date">02/04/2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jwood000/RcppAlgos/blob/HEAD/vignettes/CombinatoricsIterators.Rmd" class="external-link"><code>vignettes/CombinatoricsIterators.Rmd</code></a></small>
      <div class="hidden name"><code>CombinatoricsIterators.Rmd</code></div>

    </div>

    
    
<p>This document covers working with combinatorial iterators in
<code>RcppAlgos</code>. Combinatorial iterators in
<code>RcppAlgos</code> are memory efficient like traditional iterator
objects. They allow traversal of
combinations/permutations/partitions/compositions one by one without the
necessity for storing all results in memory.</p>
<p>Unlike traditional combinatorial iterators, the iterators in
<code>RcppAlgos</code> offers random access via the <code>[[</code>
operator. This means, we can access the <em>n<sup>th</sup></em> <a href="https://en.wikipedia.org/wiki/Lexicographical_order" class="external-link">lexicographical
order</a> result on demand without having to first iterate over the
previous <em>n - 1</em> results.</p>
<hr>
<div class="section level2">
<h2 id="iterating-over-combinations-and-permutations">Iterating over Combinations and Permutations<a class="anchor" aria-label="anchor" href="#iterating-over-combinations-and-permutations"></a>
</h2>
<p>In order to iterate, we must initialize an iterator via
<code>comboIter</code> or <code>permuteIter</code>. The interface is
very similar to <code>comboGeneral</code> and
<code>permuteGeneral</code>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jwood000/RcppAlgos" class="external-link">RcppAlgos</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/options.html" class="external-link">options</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">90</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Initialize the iterator</span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="../reference/combinatoricsIterator.html">comboIter</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Get the first combination</span></span>
<span><span class="va">a</span><span class="op">$</span><span class="fu">nextIter</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1 2 3</span></span>
<span></span>
<span><span class="co">## And the next</span></span>
<span><span class="va">a</span><span class="op">$</span><span class="fu">nextIter</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1 2 4</span></span>
<span></span>
<span><span class="co">## Set the current iterator to a variable</span></span>
<span><span class="va">iter</span> <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="fu">currIter</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">i</span> <span class="op">=</span> <span class="fl">1</span></span>
<span></span>
<span><span class="co">## Iterate until there are no more</span></span>
<span><span class="kw">while</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">iter</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">i</span>, <span class="st">" "</span>, <span class="va">iter</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>    <span class="va">iter</span> <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="fu">nextIter</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="va">i</span> <span class="op">=</span> <span class="va">i</span> <span class="op">+</span> <span class="fl">1</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; 1   1 2 4 </span></span>
<span><span class="co">#&gt; 2   1 2 5 </span></span>
<span><span class="co">#&gt; 3   1 3 4 </span></span>
<span><span class="co">#&gt; 4   1 3 5 </span></span>
<span><span class="co">#&gt; 5   1 4 5 </span></span>
<span><span class="co">#&gt; 6   2 3 4 </span></span>
<span><span class="co">#&gt; 7   2 3 5 </span></span>
<span><span class="co">#&gt; 8   2 4 5 </span></span>
<span><span class="co">#&gt; 9   3 4 5 </span></span>
<span><span class="co">#&gt; No more results. To see the last result, use the prevIter method(s)</span></span>
<span></span>
<span><span class="co">## See the output of comboGeneral for comparison</span></span>
<span><span class="fu"><a href="../reference/combinatoricsGeneral.html">comboGeneral</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">3</span>, lower <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;       [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt;  [1,]    1    2    4</span></span>
<span><span class="co">#&gt;  [2,]    1    2    5</span></span>
<span><span class="co">#&gt;  [3,]    1    3    4</span></span>
<span><span class="co">#&gt;  [4,]    1    3    5</span></span>
<span><span class="co">#&gt;  [5,]    1    4    5</span></span>
<span><span class="co">#&gt;  [6,]    2    3    4</span></span>
<span><span class="co">#&gt;  [7,]    2    3    5</span></span>
<span><span class="co">#&gt;  [8,]    2    4    5</span></span>
<span><span class="co">#&gt;  [9,]    3    4    5</span></span>
<span></span>
<span><span class="co">## Call the summary method to see information about our iterator</span></span>
<span><span class="va">a</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $description</span></span>
<span><span class="co">#&gt; [1] "Combinations of 5 choose 3"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $currentIndex</span></span>
<span><span class="co">#&gt; [1] 11</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $totalResults</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $totalRemaining</span></span>
<span><span class="co">#&gt; [1] -1</span></span></code></pre></div>
<div class="section level3">
<h3 id="bidirectional-iterators">Bidirectional Iterators<a class="anchor" aria-label="anchor" href="#bidirectional-iterators"></a>
</h3>
<p>Some of the combinatorial iterators in <code>RcppAlgos</code> are
bidirectional iterators. This means that not only can we iterate in a
forward manner (i.e. lexicographically), but we can also iterate
backwards (i.e. <a href="https://oeis.org/wiki/Orderings#Reverse_lexicographic_order" class="external-link">Reverse
Lexicographical Order</a>) via the <code>prevIter</code> method(s).</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Using the same iterable from the previous section</span></span>
<span><span class="va">a</span><span class="op">$</span><span class="fu">currIter</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; No more results. To see the last result, use the prevIter method(s)</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span></span>
<span><span class="co">## As the comment says, we call the prevIter method to see the last result</span></span>
<span><span class="va">a</span><span class="op">$</span><span class="fu">prevIter</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3 4 5</span></span>
<span></span>
<span><span class="co">## Get the previous result</span></span>
<span><span class="va">a</span><span class="op">$</span><span class="fu">prevIter</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2 4 5</span></span>
<span></span>
<span><span class="co">## As in the previous example, we set the current iterator to a variable</span></span>
<span><span class="va">iter</span> <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="fu">currIter</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Defined above</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">i</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span></span>
<span><span class="co">## Iterate until we are at the very beginning. Note that the</span></span>
<span><span class="co">## output is exactly the same as above, but in reverse order</span></span>
<span><span class="kw">while</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">iter</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">i</span> <span class="op">=</span> <span class="va">i</span> <span class="op">-</span> <span class="fl">1</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">i</span>, <span class="st">" "</span>, <span class="va">iter</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>    <span class="va">iter</span> <span class="op">=</span> <span class="va">a</span><span class="op">$</span><span class="fu">prevIter</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; 9   2 4 5 </span></span>
<span><span class="co">#&gt; 8   2 3 5 </span></span>
<span><span class="co">#&gt; 7   2 3 4 </span></span>
<span><span class="co">#&gt; 6   1 4 5 </span></span>
<span><span class="co">#&gt; 5   1 3 5 </span></span>
<span><span class="co">#&gt; 4   1 3 4 </span></span>
<span><span class="co">#&gt; 3   1 2 5 </span></span>
<span><span class="co">#&gt; 2   1 2 4 </span></span>
<span><span class="co">#&gt; 1   1 2 3 </span></span>
<span><span class="co">#&gt; Iterator Initialized. To see the first result, use the nextIter method(s)</span></span>
<span></span>
<span><span class="co">## Call the summary method to see information about our iterator</span></span>
<span><span class="va">a</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $description</span></span>
<span><span class="co">#&gt; [1] "Combinations of 5 choose 3"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $currentIndex</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $totalResults</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $totalRemaining</span></span>
<span><span class="co">#&gt; [1] 10</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="retrieving-more-than-one-result-at-a-time">Retrieving More than One Result at a Time<a class="anchor" aria-label="anchor" href="#retrieving-more-than-one-result-at-a-time"></a>
</h3>
<p>There are four methods which allow for obtaining more than one result
at a time: <code>nextNIter</code>, <code>prevNIter</code>,
<code>nextRemaining</code>, and <code>prevRemaining</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Reset the iterator</span></span>
<span><span class="va">a</span><span class="op">$</span><span class="fu">startOver</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Get the next 4 combinations</span></span>
<span><span class="va">a</span><span class="op">$</span><span class="fu">nextNIter</span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt; [1,]    1    2    3</span></span>
<span><span class="co">#&gt; [2,]    1    2    4</span></span>
<span><span class="co">#&gt; [3,]    1    2    5</span></span>
<span><span class="co">#&gt; [4,]    1    3    4</span></span>
<span></span>
<span><span class="co">## Get the summary. Note that the index has been updated</span></span>
<span><span class="va">a</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $description</span></span>
<span><span class="co">#&gt; [1] "Combinations of 5 choose 3"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $currentIndex</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $totalResults</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $totalRemaining</span></span>
<span><span class="co">#&gt; [1] 6</span></span>
<span></span>
<span><span class="co">## View the current combination</span></span>
<span><span class="va">a</span><span class="op">$</span><span class="fu">currIter</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1 3 4</span></span>
<span></span>
<span><span class="co">## Get the remaining combinations with nextRemaining</span></span>
<span><span class="va">a</span><span class="op">$</span><span class="fu">nextRemaining</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt; [1,]    1    3    5</span></span>
<span><span class="co">#&gt; [2,]    1    4    5</span></span>
<span><span class="co">#&gt; [3,]    2    3    4</span></span>
<span><span class="co">#&gt; [4,]    2    3    5</span></span>
<span><span class="co">#&gt; [5,]    2    4    5</span></span>
<span><span class="co">#&gt; [6,]    3    4    5</span></span>
<span></span>
<span><span class="va">a</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $description</span></span>
<span><span class="co">#&gt; [1] "Combinations of 5 choose 3"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $currentIndex</span></span>
<span><span class="co">#&gt; [1] 11</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $totalResults</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $totalRemaining</span></span>
<span><span class="co">#&gt; [1] -1</span></span></code></pre></div>
<p>Now, we look at the opposite direction.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Get the previous 4 combinations</span></span>
<span><span class="va">a</span><span class="op">$</span><span class="fu">prevNIter</span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt; [1,]    3    4    5</span></span>
<span><span class="co">#&gt; [2,]    2    4    5</span></span>
<span><span class="co">#&gt; [3,]    2    3    5</span></span>
<span><span class="co">#&gt; [4,]    2    3    4</span></span>
<span></span>
<span><span class="co">## Get the summary. Note that the index has been updated</span></span>
<span><span class="va">a</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $description</span></span>
<span><span class="co">#&gt; [1] "Combinations of 5 choose 3"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $currentIndex</span></span>
<span><span class="co">#&gt; [1] 7</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $totalResults</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $totalRemaining</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span></span>
<span><span class="co">## View the current combination</span></span>
<span><span class="va">a</span><span class="op">$</span><span class="fu">currIter</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2 3 4</span></span>
<span></span>
<span><span class="co">## Get the remaining previous combinations with prevRemaining</span></span>
<span><span class="va">a</span><span class="op">$</span><span class="fu">prevRemaining</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt; [1,]    1    4    5</span></span>
<span><span class="co">#&gt; [2,]    1    3    5</span></span>
<span><span class="co">#&gt; [3,]    1    3    4</span></span>
<span><span class="co">#&gt; [4,]    1    2    5</span></span>
<span><span class="co">#&gt; [5,]    1    2    4</span></span>
<span><span class="co">#&gt; [6,]    1    2    3</span></span>
<span></span>
<span><span class="va">a</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $description</span></span>
<span><span class="co">#&gt; [1] "Combinations of 5 choose 3"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $currentIndex</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $totalResults</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $totalRemaining</span></span>
<span><span class="co">#&gt; [1] 10</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="random-access-iterator">Random Access Iterator<a class="anchor" aria-label="anchor" href="#random-access-iterator"></a>
</h3>
<p>As with the bidirectional iterators, with some of the combinatorial
iterators in <code>RcppAlgos</code>, we can jump to the
<em>n<sup>th</sup></em> result without the need for iterating over the
first <em>n - 1</em> results.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Reset the iterator</span></span>
<span><span class="va">a</span><span class="op">$</span><span class="fu">startOver</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## How many total combinations do we have?</span></span>
<span><span class="va">a</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">totalResults</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span></span>
<span><span class="co">## Let's get the 3rd combination</span></span>
<span><span class="va">a</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 1 2 5</span></span>
<span></span>
<span><span class="co">## See the summary. Note that the index has been updated</span></span>
<span><span class="va">a</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $description</span></span>
<span><span class="co">#&gt; [1] "Combinations of 5 choose 3"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $currentIndex</span></span>
<span><span class="co">#&gt; [1] 3</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $totalResults</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $totalRemaining</span></span>
<span><span class="co">#&gt; [1] 7</span></span>
<span></span>
<span><span class="co">## Let's see the 9th combination</span></span>
<span><span class="va">a</span><span class="op">[[</span><span class="fl">9</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 2 4 5</span></span>
<span></span>
<span><span class="co">## What about the first and last combination?</span></span>
<span><span class="va">a</span><span class="op">$</span><span class="fu">front</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1 2 3</span></span>
<span></span>
<span><span class="va">a</span><span class="op">$</span><span class="fu">back</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3 4 5</span></span>
<span></span>
<span><span class="co">## Again the index has been updated</span></span>
<span><span class="va">a</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $description</span></span>
<span><span class="co">#&gt; [1] "Combinations of 5 choose 3"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $currentIndex</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $totalResults</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $totalRemaining</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span></span>
<span><span class="va">a</span><span class="op">$</span><span class="fu">currIter</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3 4 5</span></span></code></pre></div>
<p>We can also easily return a random sample of combinations with the
<code>[[</code> operator by passing a vector of indices. In these cases,
it should be noted that the current index will not be updated.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Set the current index to the second combination</span></span>
<span><span class="va">a</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 1 2 4</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">121</span><span class="op">)</span></span>
<span><span class="va">samp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="va">a</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">totalResults</span>, <span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">samp</span></span>
<span><span class="co">#&gt; [1]  4  7 10  1</span></span>
<span></span>
<span><span class="va">a</span><span class="op">[[</span><span class="va">samp</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt; [1,]    1    3    4</span></span>
<span><span class="co">#&gt; [2,]    2    3    4</span></span>
<span><span class="co">#&gt; [3,]    3    4    5</span></span>
<span><span class="co">#&gt; [4,]    1    2    3</span></span>
<span></span>
<span><span class="co">## Note that the current index remains unchanged</span></span>
<span><span class="va">a</span><span class="op">$</span><span class="fu">summary</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $description</span></span>
<span><span class="co">#&gt; [1] "Combinations of 5 choose 3"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $currentIndex</span></span>
<span><span class="co">#&gt; [1] 2</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $totalResults</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $totalRemaining</span></span>
<span><span class="co">#&gt; [1] 8</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="user-defined-functions">User Defined Functions<a class="anchor" aria-label="anchor" href="#user-defined-functions"></a>
</h3>
<p>Just as with <code>comboGeneral</code> and
<code>permuteGeneral</code>, we can pass a user defined function to
<code>comboIter</code> and <code>permuteIter</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Initialize the iterator</span></span>
<span><span class="va">b</span> <span class="op">=</span> <span class="fu"><a href="../reference/combinatoricsIterator.html">permuteIter</a></span><span class="op">(</span><span class="va">LETTERS</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, <span class="fl">3</span>, FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">p</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">p</span>, collapse <span class="op">=</span> <span class="st">""</span><span class="op">)</span>,</span>
<span>                FUN.VALUE <span class="op">=</span> <span class="st">"a"</span><span class="op">)</span></span>
<span><span class="va">b</span><span class="op">$</span><span class="fu">nextIter</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "ABC"</span></span>
<span></span>
<span><span class="va">b</span><span class="op">$</span><span class="fu">nextNIter</span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "ABD" "ACB" "ACD" "ADB" "ADC"</span></span>
<span></span>
<span><span class="va">b</span><span class="op">$</span><span class="fu">back</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "DCB"</span></span>
<span></span>
<span><span class="va">b</span><span class="op">$</span><span class="fu">prevIter</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "DCA"</span></span>
<span></span>
<span><span class="va">b</span><span class="op">$</span><span class="fu">prevNIter</span><span class="op">(</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "DBC" "DBA" "DAC" "DAB" "CDB"</span></span>
<span></span>
<span><span class="va">b</span><span class="op">$</span><span class="fu">nextRemaining</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "DAB" "DAC" "DBA" "DBC" "DCA" "DCB"</span></span>
<span></span>
<span><span class="co">## Random access</span></span>
<span><span class="va">b</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] "ADB"</span></span>
<span></span>
<span><span class="va">b</span><span class="op">$</span><span class="fu">prevRemaining</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "ACD" "ACB" "ABD" "ABC"</span></span>
<span></span>
<span><span class="co">## View the source vector</span></span>
<span><span class="va">b</span><span class="op">$</span><span class="fu">sourceVector</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "A" "B" "C" "D"</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="new-in-verison-2-5-0">New in Verison <code>2.5.0</code><a class="anchor" aria-label="anchor" href="#new-in-verison-2-5-0"></a>
</h2>
<p>As of version <code>2.5.0</code>, we no longer rely on
<code>Rcpp</code> as a dependency, which means that we do not utilize
<code>Rcpp</code> modules for exposing C++ classes. This is now carried
out using external pointers (See <a href="https://cran.r-project.org/doc/manuals/r-release/R-exts.html#External-pointers-and-weak-references" class="external-link">External
pointers and weak references</a>) along with <a href="http://adv-r.had.co.nz/S4.html" class="external-link">S4 Classes</a>. We use the slots
of <code>S4</code> classes for exposing each method so access is carried
out with the “at sign”, <code>@</code>. We have also added the ability
to access each method with the “dollar sign”, <code>$</code>, for
backwards compatibility.</p>
<div class="section level3">
<h3 id="access-efficiency-in-2-5-0">Access Efficiency in <code>2.5.0+</code><a class="anchor" aria-label="anchor" href="#access-efficiency-in-2-5-0"></a>
</h3>
<p>Our tests show that accessing methods is much more efficient in
<code>2.5.0+</code> compared to prior versions. In the below tests, we
measure excecution time of calling <code>nextIter</code> multiple times
in different versions. We will use the function
<code>test_nextIter</code> for our testing. If one needs to reproduce,
simply download the <code>2.4.3</code> tar here: <a href="https://cran.r-project.org/src/contrib/Archive/RcppAlgos/" class="external-link uri">https://cran.r-project.org/src/contrib/Archive/RcppAlgos/</a>,
change <code>RcppAlgos</code> to <code>RcppAlgos243</code> in a few
place (e.g. <code>DESCRIPTION</code>, <code>NAMESPACE</code>, etc.), and
rebuild.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">test_nextIter</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">n</span>, <span class="va">m</span>, <span class="va">get_val</span> <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">v</span> <span class="op">=</span> <span class="fl">243</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">a</span> <span class="op">&lt;-</span> <span class="kw">if</span> <span class="op">(</span><span class="va">v</span> <span class="op">==</span> <span class="fl">243</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu">RcppAlgos243</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/RcppAlgos243/man/combinatoricsIterator.html" class="external-link">comboIter</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">m</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="../reference/combinatoricsIterator.html">comboIter</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">m</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span></span>
<span>    <span class="va">total</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combinatoricsCount.html">comboCount</a></span><span class="op">(</span><span class="va">n</span>, <span class="va">m</span><span class="op">)</span></span>
<span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">get_val</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fl">0L</span>, nrow <span class="op">=</span> <span class="va">total</span>, ncol <span class="op">=</span> <span class="va">m</span><span class="op">)</span></span>
<span>        <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">total</span><span class="op">)</span> <span class="va">mat</span><span class="op">[</span><span class="va">i</span>, <span class="op">]</span> <span class="op">&lt;-</span> <span class="va">a</span><span class="op">$</span><span class="fu">nextIter</span><span class="op">(</span><span class="op">)</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="va">v</span> <span class="op">==</span> <span class="fl">243</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">total</span><span class="op">)</span> <span class="va">a</span><span class="op">$</span><span class="fu">nextIter</span><span class="op">(</span><span class="op">)</span></span>
<span>        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>            <span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="va">total</span><span class="op">)</span> <span class="va">a</span><span class="op">@</span><span class="va">nextIter</span><span class="op">(</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level4">
<h4 id="version-2-4-3-using-rcpp">Version <code>2.4.3</code> Using <code>Rcpp</code><a class="anchor" aria-label="anchor" href="#version-2-4-3-using-rcpp"></a>
</h4>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/joshuaulrich/microbenchmark/" class="external-link">microbenchmark</a></span><span class="op">)</span></span>
<span><span class="co">## Using R version 4.1.3</span></span>
<span><span class="fu"><a href="../reference/combinatoricsCount.html">comboCount</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">8</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 6435</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html" class="external-link">microbenchmark</a></span><span class="op">(</span>v243 <span class="op">=</span> <span class="fu">test_nextIter</span><span class="op">(</span><span class="fl">15</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Warning in microbenchmark(v243 = test_nextIter(15, 8)): less accurate nanosecond times to</span></span>
<span><span class="co">#&gt; avoid potential integer overflows</span></span>
<span><span class="co">#&gt; Unit: milliseconds</span></span>
<span><span class="co">#&gt;  expr      min       lq     mean   median       uq      max neval</span></span>
<span><span class="co">#&gt;  v243 20.59512 21.81784 23.51875 22.12774 22.80262 135.6191   100</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu">test_nextIter</span><span class="op">(</span><span class="fl">15</span>, <span class="fl">8</span>, get_val <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="../reference/combinatoricsGeneral.html">comboGeneral</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="fu"><a href="../reference/combinatoricsCount.html">comboCount</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 3268760</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu">test_nextIter</span><span class="op">(</span><span class="fl">25</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;  11.384   0.043  11.441</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/Rprof.html" class="external-link">Rprof</a></span><span class="op">(</span><span class="st">"Version243.out"</span>, memory.profiling <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">test_nextIter</span><span class="op">(</span><span class="fl">25</span>, <span class="fl">10</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/Rprof.html" class="external-link">Rprof</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/summaryRprof.html" class="external-link">summaryRprof</a></span><span class="op">(</span><span class="st">"Version243.out"</span>, memory <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span>, <span class="va">head</span><span class="op">)</span></span>
<span><span class="co">#&gt; $by.self</span></span>
<span><span class="co">#&gt;                  self.time self.pct total.time total.pct mem.total</span></span>
<span><span class="co">#&gt; "$"                   3.12    31.26       7.58     75.95    1779.8</span></span>
<span><span class="co">#&gt; "as.environment"      2.86    28.66       2.86     28.66     522.6</span></span>
<span><span class="co">#&gt; "test_nextIter"       1.20    12.02       9.98    100.00    2424.6</span></span>
<span><span class="co">#&gt; ".External"           0.88     8.82       0.88      8.82     127.0</span></span>
<span><span class="co">#&gt; "get"                 0.78     7.82       0.78      7.82     131.2</span></span>
<span><span class="co">#&gt; "exists"              0.74     7.41       0.74      7.41     178.8</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $by.total</span></span>
<span><span class="co">#&gt;                 total.time total.pct mem.total self.time self.pct</span></span>
<span><span class="co">#&gt; "test_nextIter"       9.98       100    2424.6       1.2    12.02</span></span>
<span><span class="co">#&gt; "&lt;Anonymous&gt;"         9.98       100    2424.6       0.0     0.00</span></span>
<span><span class="co">#&gt; "block_exec"          9.98       100    2424.6       0.0     0.00</span></span>
<span><span class="co">#&gt; "call_block"          9.98       100    2424.6       0.0     0.00</span></span>
<span><span class="co">#&gt; "do.call"             9.98       100    2424.6       0.0     0.00</span></span>
<span><span class="co">#&gt; "doTryCatch"          9.98       100    2424.6       0.0     0.00</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sample.interval</span></span>
<span><span class="co">#&gt; [1] 0.02</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sampling.time</span></span>
<span><span class="co">#&gt; [1] 9.98</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="version-2-7-1-no-rcpp">Version <code>2.7.1</code> (No <code>Rcpp</code>)<a class="anchor" aria-label="anchor" href="#version-2-7-1-no-rcpp"></a>
</h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">curr_version</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/integer.html" class="external-link">as.integer</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"\\."</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/utils/packageDescription.html" class="external-link">packageVersion</a></span><span class="op">(</span><span class="st">"RcppAlgos"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">curr_version</span></span>
<span><span class="co">#&gt; [1] 271</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html" class="external-link">microbenchmark</a></span><span class="op">(</span>curr_v <span class="op">=</span> <span class="fu">test_nextIter</span><span class="op">(</span><span class="fl">15</span>, <span class="fl">8</span>, v <span class="op">=</span> <span class="va">curr_version</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Unit: milliseconds</span></span>
<span><span class="co">#&gt;    expr      min       lq     mean   median       uq      max neval</span></span>
<span><span class="co">#&gt;  curr_v 2.511783 2.607067 2.738995 2.680683 2.778303 3.891023   100</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu">test_nextIter</span><span class="op">(</span><span class="fl">25</span>, <span class="fl">10</span>, v <span class="op">=</span> <span class="va">curr_version</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   1.322   0.003   1.325</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="fu">test_nextIter</span><span class="op">(</span><span class="fl">15</span>, <span class="fl">8</span>, get_val <span class="op">=</span> <span class="cn">TRUE</span>, v <span class="op">=</span> <span class="va">curr_version</span><span class="op">)</span>,</span>
<span>          <span class="fu"><a href="../reference/combinatoricsGeneral.html">comboGeneral</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">8</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/Rprof.html" class="external-link">Rprof</a></span><span class="op">(</span><span class="st">"Version250.out"</span>, memory.profiling <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu">test_nextIter</span><span class="op">(</span><span class="fl">25</span>, <span class="fl">10</span>, v <span class="op">=</span> <span class="va">curr_version</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/Rprof.html" class="external-link">Rprof</a></span><span class="op">(</span><span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/summaryRprof.html" class="external-link">summaryRprof</a></span><span class="op">(</span><span class="st">"Version250.out"</span>, memory <span class="op">=</span> <span class="st">"both"</span><span class="op">)</span>, <span class="va">head</span><span class="op">)</span></span>
<span><span class="co">#&gt; $by.self</span></span>
<span><span class="co">#&gt;                 self.time self.pct total.time total.pct mem.total</span></span>
<span><span class="co">#&gt; "&lt;Anonymous&gt;"        0.46    41.82       1.10    100.00       506</span></span>
<span><span class="co">#&gt; ".Call"              0.46    41.82       0.46     41.82       211</span></span>
<span><span class="co">#&gt; "test_nextIter"      0.18    16.36       1.10    100.00       506</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $by.total</span></span>
<span><span class="co">#&gt;                 total.time total.pct mem.total self.time self.pct</span></span>
<span><span class="co">#&gt; "&lt;Anonymous&gt;"          1.1       100       506      0.46    41.82</span></span>
<span><span class="co">#&gt; "test_nextIter"        1.1       100       506      0.18    16.36</span></span>
<span><span class="co">#&gt; "block_exec"           1.1       100       506      0.00     0.00</span></span>
<span><span class="co">#&gt; "call_block"           1.1       100       506      0.00     0.00</span></span>
<span><span class="co">#&gt; "do.call"              1.1       100       506      0.00     0.00</span></span>
<span><span class="co">#&gt; "doTryCatch"           1.1       100       506      0.00     0.00</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sample.interval</span></span>
<span><span class="co">#&gt; [1] 0.02</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sampling.time</span></span>
<span><span class="co">#&gt; [1] 1.1</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="conclusions">Conclusions<a class="anchor" aria-label="anchor" href="#conclusions"></a>
</h4>
<p>It appears that memory is the issue in previous versions. Indeed, if
we look at <a href="https://cran.r-project.org/doc/manuals/r-release/R-exts.html#Memory-statistics-from-Rprof" class="external-link">Memory
statistics from Rprof</a>, and view both files with
<code>memory = "stats"</code> we see that the C funciton,
<code>duplicate</code>, appears to be the main culprit.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## We set index = 1 to ensure we get the very bottom of the stack</span></span>
<span></span>
<span><span class="co">### Verison 2.4.3</span></span>
<span><span class="va">v243</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/summaryRprof.html" class="external-link">summaryRprof</a></span><span class="op">(</span><span class="st">"Version243.out"</span>, memory <span class="op">=</span> <span class="st">"stats"</span>, index <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">v243</span></span>
<span><span class="co">#&gt; index: "tryCatch"</span></span>
<span><span class="co">#&gt;      vsize.small  max.vsize.small      vsize.large  max.vsize.large            nodes </span></span>
<span><span class="co">#&gt;           256574          5231040            14202          7086688          4953207 </span></span>
<span><span class="co">#&gt;        max.nodes     duplications tot.duplications          samples </span></span>
<span><span class="co">#&gt;         52055080            19641          9800887              499</span></span>
<span></span>
<span><span class="co">## Version 2.5.0</span></span>
<span><span class="va">v250</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/summaryRprof.html" class="external-link">summaryRprof</a></span><span class="op">(</span><span class="st">"Version250.out"</span>, memory <span class="op">=</span> <span class="st">"stats"</span>, index <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">v250</span></span>
<span><span class="co">#&gt; index: "tryCatch"</span></span>
<span><span class="co">#&gt;      vsize.small  max.vsize.small      vsize.large  max.vsize.large            nodes </span></span>
<span><span class="co">#&gt;          1953237          8712368           140150          7708264          9067297 </span></span>
<span><span class="co">#&gt;        max.nodes     duplications tot.duplications          samples </span></span>
<span><span class="co">#&gt;         66820992                3              142               55</span></span></code></pre></div>
<p>With verison <code>2.5.0+</code> there are only 142
<code>tot.duplications</code> whereas with version <code>2.4.3</code>
there are millions of <code>tot.duplications</code>. In fact, there are
a total of 9800887 duplications with version <code>2.4.3</code>. This
together with <code>comboCount(25, 10) = 3,268,760</code> implies that
the C funciton, <code>duplicate</code>, is called about 3 times per
iteration with older versions (i.e. 9800887 <code>/ 3268760 ~=</code>
2.9984).</p>
</div>
</div>
<div class="section level3">
<h3 id="iterating-over-partitions-and-compositions-of-a-number">Iterating over Partitions and Compositions of a Number<a class="anchor" aria-label="anchor" href="#iterating-over-partitions-and-compositions-of-a-number"></a>
</h3>
<p>For most partition cases, we have all of the capabilities of the
standard <code>comboIter</code> and <code>permuteIter</code> except for
bidirectionality (i.e. the <code>prevIter</code> methods). For cases
involving standard multisets we also don’t have random access
methods.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Similar illustration of comboIter(5, 3) at the top</span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/partitionsIterator.html">partitionsIter</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">p</span><span class="op">@</span><span class="va">nextIter</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1]  1  2  3 10</span></span>
<span></span>
<span><span class="va">p</span><span class="op">@</span><span class="va">nextIter</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1 2 4 9</span></span>
<span></span>
<span><span class="va">iter</span> <span class="op">=</span> <span class="va">p</span><span class="op">@</span><span class="va">currIter</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">i</span> <span class="op">=</span> <span class="fl">1</span></span>
<span></span>
<span><span class="kw">while</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">iter</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">i</span>, <span class="st">" "</span>, <span class="va">iter</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>    <span class="va">iter</span> <span class="op">=</span> <span class="va">p</span><span class="op">@</span><span class="va">nextIter</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="va">i</span> <span class="op">=</span> <span class="va">i</span> <span class="op">+</span> <span class="fl">1</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; 1   1 2 4 9 </span></span>
<span><span class="co">#&gt; 2   1 2 5 8 </span></span>
<span><span class="co">#&gt; 3   1 2 6 7 </span></span>
<span><span class="co">#&gt; 4   1 3 4 8 </span></span>
<span><span class="co">#&gt; 5   1 3 5 7 </span></span>
<span><span class="co">#&gt; 6   1 4 5 6 </span></span>
<span><span class="co">#&gt; 7   2 3 4 7 </span></span>
<span><span class="co">#&gt; 8   2 3 5 6 </span></span>
<span><span class="co">#&gt; No more results.</span></span>
<span></span>
<span><span class="fu"><a href="../reference/partitionsGeneral.html">partitionsGeneral</a></span><span class="op">(</span><span class="fl">16</span>, <span class="fl">4</span>, lower <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;      [,1] [,2] [,3] [,4]</span></span>
<span><span class="co">#&gt; [1,]    1    2    4    9</span></span>
<span><span class="co">#&gt; [2,]    1    2    5    8</span></span>
<span><span class="co">#&gt; [3,]    1    2    6    7</span></span>
<span><span class="co">#&gt; [4,]    1    3    4    8</span></span>
<span><span class="co">#&gt; [5,]    1    3    5    7</span></span>
<span><span class="co">#&gt; [6,]    1    4    5    6</span></span>
<span><span class="co">#&gt; [7,]    2    3    4    7</span></span>
<span><span class="co">#&gt; [8,]    2    3    5    6</span></span>
<span></span>
<span><span class="va">p</span><span class="op">@</span><span class="va">summary</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $description</span></span>
<span><span class="co">#&gt; [1] "Partitions of 16 into 4 parts"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $currentIndex</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $totalResults</span></span>
<span><span class="co">#&gt; [1] 9</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $totalRemaining</span></span>
<span><span class="co">#&gt; [1] -1</span></span>
<span></span>
<span><span class="co">## Using random access</span></span>
<span><span class="va">p</span><span class="op">[[</span><span class="fl">7</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 1 4 5 6</span></span>
<span></span>
<span><span class="co">## No previous iterators</span></span>
<span><span class="va">p</span><span class="op">@</span><span class="va">prevIter</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in eval(expr, envir, enclos): no slot of name "prevIter" for this object of class "Partitions"</span></span></code></pre></div>
<p>For compositions, the options are limited to a subset of compositions
with repetition.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Similar illustration of comboIter(5, 3) at the top</span></span>
<span><span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/partitionsIterator.html">compositionsIter</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">3</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">p</span><span class="op">@</span><span class="va">nextIter</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1 1 4</span></span>
<span></span>
<span><span class="va">p</span><span class="op">@</span><span class="va">nextIter</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 1 2 3</span></span>
<span></span>
<span><span class="va">iter</span> <span class="op">=</span> <span class="va">p</span><span class="op">@</span><span class="va">currIter</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">i</span> <span class="op">=</span> <span class="fl">1</span></span>
<span></span>
<span><span class="kw">while</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">iter</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">i</span>, <span class="st">" "</span>, <span class="va">iter</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span>    <span class="va">iter</span> <span class="op">=</span> <span class="va">p</span><span class="op">@</span><span class="va">nextIter</span><span class="op">(</span><span class="op">)</span></span>
<span>    <span class="va">i</span> <span class="op">=</span> <span class="va">i</span> <span class="op">+</span> <span class="fl">1</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; 1   1 2 3 </span></span>
<span><span class="co">#&gt; 2   1 3 2 </span></span>
<span><span class="co">#&gt; 3   1 4 1 </span></span>
<span><span class="co">#&gt; 4   2 1 3 </span></span>
<span><span class="co">#&gt; 5   2 2 2 </span></span>
<span><span class="co">#&gt; 6   2 3 1 </span></span>
<span><span class="co">#&gt; 7   3 1 2 </span></span>
<span><span class="co">#&gt; 8   3 2 1 </span></span>
<span><span class="co">#&gt; 9   4 1 1 </span></span>
<span><span class="co">#&gt; No more results.</span></span>
<span></span>
<span><span class="fu"><a href="../reference/partitionsGeneral.html">compositionsGeneral</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">3</span>, <span class="cn">TRUE</span>, lower <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="co">#&gt;       [,1] [,2] [,3]</span></span>
<span><span class="co">#&gt;  [1,]    1    2    3</span></span>
<span><span class="co">#&gt;  [2,]    1    3    2</span></span>
<span><span class="co">#&gt;  [3,]    1    4    1</span></span>
<span><span class="co">#&gt;  [4,]    2    1    3</span></span>
<span><span class="co">#&gt;  [5,]    2    2    2</span></span>
<span><span class="co">#&gt;  [6,]    2    3    1</span></span>
<span><span class="co">#&gt;  [7,]    3    1    2</span></span>
<span><span class="co">#&gt;  [8,]    3    2    1</span></span>
<span><span class="co">#&gt;  [9,]    4    1    1</span></span>
<span></span>
<span><span class="va">p</span><span class="op">@</span><span class="va">summary</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $description</span></span>
<span><span class="co">#&gt; [1] "Compositions with repetition of 6 into 3 parts"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $currentIndex</span></span>
<span><span class="co">#&gt; [1] 11</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $totalResults</span></span>
<span><span class="co">#&gt; [1] 10</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $totalRemaining</span></span>
<span><span class="co">#&gt; [1] -1</span></span>
<span></span>
<span><span class="co">## Using random access</span></span>
<span><span class="va">p</span><span class="op">[[</span><span class="fl">7</span><span class="op">]</span><span class="op">]</span></span>
<span><span class="co">#&gt; [1] 2 3 1</span></span>
<span></span>
<span><span class="co">## No previous iterators</span></span>
<span><span class="va">p</span><span class="op">@</span><span class="va">prevIter</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in eval(expr, envir, enclos): no slot of name "prevIter" for this object of class "Partitions"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="iterating-over-constrained-combinationspermutations">Iterating over Constrained Combinations/Permutations<a class="anchor" aria-label="anchor" href="#iterating-over-constrained-combinationspermutations"></a>
</h3>
<p>Now, the combinatorial iterators have all of the features of their
“general” analogs
(i.e. <code>{combo|permute|partitions|compositions}General</code>),
which includes constrained results.</p>
<p>For general constrained cases, these iterators offer huge advantages
over their “general” counterparts. Previously, one had to guess how many
results there would be using the <code>upper</code> parameter as
executing the function with no constraints meant the user could be
waiting for a while or consume a large amount of resources.</p>
<p>Another drawback is that it difficult to start generating from a
particular point. With the “general” functions, if the
<code>lower</code> parameter is used, we have to make a decision in
order to disambiguate the use. Without constraints, using
<code>lower</code> is easy to understand. It simply means to start
generating results starting at a particular lexicographical result,
which we can do efficiently (i.e. no need to generate the first
<code>lower - 1</code> results). With constraints, it could mean one of
two things:</p>
<ol style="list-style-type: decimal">
<li>Start checking from a particular lexicographical result without
considering the constraint (as we do normally).</li>
<li>Start generating results from a particular result with regards to
the final constrained output.</li>
</ol>
<p>In <code>RcppAlgos</code> we have always used the first
interpretation. A big downside for the second point is that we don’t
have any fast algorithms for enumerating the total number of results,
which reduces determining the <em>n<sup>th</sup></em> result to a brute
force approach.</p>
<p>With iterators, we can generate <em>n</em> results with
<code>nextNIter(n)</code> or calling <code>nextIter()</code> <em>n</em>
times (or some combination of the two). Then, if we want to continue
iterating, we pick up where we left off fetching the <em>(n +
1)<sup>th</sup></em> result and beyond (if there are any results left).
This allows us to keep memory low without sacrificing our current
state.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">55</span><span class="op">)</span></span>
<span><span class="va">s</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">10</span>, <span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">s</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1]  0.478135161 -2.818403214 -4.650360052  2.915492940  0.602420762 -4.257748260</span></span>
<span><span class="co">#&gt;  [7] -3.684770642 -2.058761222  0.007612633 -4.116755421</span></span>
<span></span>
<span><span class="co">## Using comboGeneral to retrieve all results</span></span>
<span><span class="fu"><a href="../reference/combinatoricsGeneral.html">comboGeneral</a></span><span class="op">(</span><span class="va">s</span>, <span class="fl">5</span>, constraintFun <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>             comparisonFun <span class="op">=</span> <span class="st">"&lt;"</span>, limitConstraints <span class="op">=</span> <span class="op">-</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;            [,1]      [,2]      [,3]      [,4]         [,5]</span></span>
<span><span class="co">#&gt;  [1,] -4.650360 -4.257748 -4.116755 -3.684771 -2.818403214</span></span>
<span><span class="co">#&gt;  [2,] -4.650360 -4.257748 -4.116755 -3.684771 -2.058761222</span></span>
<span><span class="co">#&gt;  [3,] -4.650360 -4.257748 -4.116755 -3.684771  0.007612633</span></span>
<span><span class="co">#&gt;  [4,] -4.650360 -4.257748 -4.116755 -3.684771  0.478135161</span></span>
<span><span class="co">#&gt;  [5,] -4.650360 -4.257748 -4.116755 -3.684771  0.602420762</span></span>
<span><span class="co">#&gt;  [6,] -4.650360 -4.257748 -4.116755 -2.818403 -2.058761222</span></span>
<span><span class="co">#&gt;  [7,] -4.650360 -4.257748 -4.116755 -2.818403  0.007612633</span></span>
<span><span class="co">#&gt;  [8,] -4.650360 -4.257748 -4.116755 -2.818403  0.478135161</span></span>
<span><span class="co">#&gt;  [9,] -4.650360 -4.257748 -4.116755 -2.818403  0.602420762</span></span>
<span><span class="co">#&gt; [10,] -4.650360 -4.257748 -4.116755 -2.058761  0.007612633</span></span>
<span><span class="co">#&gt; [11,] -4.650360 -4.257748 -3.684771 -2.818403 -2.058761222</span></span>
<span><span class="co">#&gt; [12,] -4.650360 -4.257748 -3.684771 -2.818403  0.007612633</span></span>
<span><span class="co">#&gt; [13,] -4.650360 -4.116755 -3.684771 -2.818403 -2.058761222</span></span>
<span><span class="co">#&gt; [14,] -4.650360 -4.116755 -3.684771 -2.818403  0.007612633</span></span>
<span><span class="co">#&gt; [15,] -4.257748 -4.116755 -3.684771 -2.818403 -2.058761222</span></span>
<span></span>
<span></span>
<span><span class="co">## Using comboIter</span></span>
<span><span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="../reference/combinatoricsIterator.html">comboIter</a></span><span class="op">(</span><span class="va">s</span>, <span class="fl">5</span>, constraintFun <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>              comparisonFun <span class="op">=</span> <span class="st">"&lt;"</span>, limitConstraints <span class="op">=</span> <span class="op">-</span><span class="fl">3</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## See the first result</span></span>
<span><span class="va">a</span><span class="op">@</span><span class="va">nextIter</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] -4.650360 -4.257748 -4.116755 -3.684771 -2.818403</span></span>
<span></span>
<span><span class="co">## Get the next three</span></span>
<span><span class="va">a</span><span class="op">@</span><span class="va">nextNIter</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;          [,1]      [,2]      [,3]      [,4]         [,5]</span></span>
<span><span class="co">#&gt; [1,] -4.65036 -4.257748 -4.116755 -3.684771 -2.058761222</span></span>
<span><span class="co">#&gt; [2,] -4.65036 -4.257748 -4.116755 -3.684771  0.007612633</span></span>
<span><span class="co">#&gt; [3,] -4.65036 -4.257748 -4.116755 -3.684771  0.478135161</span></span>
<span></span>
<span><span class="co">## See the summary... Note the totalResults and totalRemaining</span></span>
<span><span class="co">## fields are NA as we are not able to calculate this upfront.</span></span>
<span><span class="va">a</span><span class="op">@</span><span class="va">summary</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; $description</span></span>
<span><span class="co">#&gt; [1] "Combinations of 10 choose 5 where the mean is &lt; -3"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $currentIndex</span></span>
<span><span class="co">#&gt; [1] 4</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $totalResults</span></span>
<span><span class="co">#&gt; [1] NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $totalRemaining</span></span>
<span><span class="co">#&gt; [1] NA</span></span>
<span></span>
<span></span>
<span><span class="va">a</span><span class="op">@</span><span class="va">nextNIter</span><span class="op">(</span><span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;          [,1]      [,2]      [,3]      [,4]         [,5]</span></span>
<span><span class="co">#&gt; [1,] -4.65036 -4.257748 -4.116755 -3.684771  0.602420762</span></span>
<span><span class="co">#&gt; [2,] -4.65036 -4.257748 -4.116755 -2.818403 -2.058761222</span></span>
<span><span class="co">#&gt; [3,] -4.65036 -4.257748 -4.116755 -2.818403  0.007612633</span></span>
<span></span>
<span><span class="co">## Get the rest</span></span>
<span><span class="va">a</span><span class="op">@</span><span class="va">nextRemaining</span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;           [,1]      [,2]      [,3]      [,4]         [,5]</span></span>
<span><span class="co">#&gt; [1,] -4.650360 -4.257748 -4.116755 -2.818403  0.478135161</span></span>
<span><span class="co">#&gt; [2,] -4.650360 -4.257748 -4.116755 -2.818403  0.602420762</span></span>
<span><span class="co">#&gt; [3,] -4.650360 -4.257748 -4.116755 -2.058761  0.007612633</span></span>
<span><span class="co">#&gt; [4,] -4.650360 -4.257748 -3.684771 -2.818403 -2.058761222</span></span>
<span><span class="co">#&gt; [5,] -4.650360 -4.257748 -3.684771 -2.818403  0.007612633</span></span>
<span><span class="co">#&gt; [6,] -4.650360 -4.116755 -3.684771 -2.818403 -2.058761222</span></span>
<span><span class="co">#&gt; [7,] -4.650360 -4.116755 -3.684771 -2.818403  0.007612633</span></span>
<span><span class="co">#&gt; [8,] -4.257748 -4.116755 -3.684771 -2.818403 -2.058761222</span></span></code></pre></div>
<p>They are very efficient as well. Consider the example below where we
use <code>comboGeneral</code> to generate all results without capping
the output. Again, we are in a situation where we don’t know <em>a
priori</em> how many results we will obtain.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">77</span><span class="op">)</span></span>
<span><span class="va">s</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">20</span>, <span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## Over one trillion results to sift through</span></span>
<span><span class="fu"><a href="../reference/combinatoricsCount.html">comboCount</a></span><span class="op">(</span><span class="va">s</span>, <span class="fl">15</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 2.25083e+12</span></span>
<span></span>
<span><span class="va">time_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span></span>
<span>            <span class="fu"><a href="../reference/combinatoricsGeneral.html">comboGeneral</a></span><span class="op">(</span><span class="va">s</span>, <span class="fl">15</span>,</span>
<span>                         constraintFun <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>                         comparisonFun <span class="op">=</span> <span class="st">"&gt;"</span>,</span>
<span>                         limitConstraints <span class="op">=</span> <span class="fl">83</span><span class="op">)</span></span>
<span>        <span class="op">)</span></span>
<span>    <span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 38935252</span></span>
<span><span class="va">time_all</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   1.971   1.305   3.292</span></span>
<span></span>
<span><span class="co">## Over 4 GBs of results</span></span>
<span><span class="op">(</span><span class="fl">38935252</span> <span class="op">*</span> <span class="fl">15</span> <span class="op">*</span> <span class="fl">8</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">^</span><span class="fl">30</span></span>
<span><span class="co">#&gt; [1] 4.351353</span></span></code></pre></div>
<p>Just over 3 seconds isn’t bad, however 4 GBs could put a strain on
your computer.</p>
<p>Let’s use iterators instead and only generate ten thousand at a time
to keep memory low. We should mention here that the iterators are
“smart” in that there is no fear in requesting more results than what is
actually left. For example, if in the problem above, we had iterated to
the 38<sup>th</sup> million result and requested 10 million more, we
would only obtain 935,252 results.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/gc.html" class="external-link">gc</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">time_iter</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="../reference/combinatoricsIterator.html">comboIter</a></span><span class="op">(</span><span class="va">s</span>, <span class="fl">15</span>,</span>
<span>                  constraintFun <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>                  comparisonFun <span class="op">=</span> <span class="st">"&gt;"</span>,</span>
<span>                  limitConstraints <span class="op">=</span> <span class="fl">83</span><span class="op">)</span></span>
<span>    <span class="kw">while</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">a</span><span class="op">@</span><span class="va">nextNIter</span><span class="op">(</span><span class="fl">1e4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span><span class="op">}</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">a</span><span class="op">@</span><span class="va">summary</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; No more results.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $description</span></span>
<span><span class="co">#&gt; [1] "Combinations of 50 choose 15 where the mean is &gt; 83"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $currentIndex</span></span>
<span><span class="co">#&gt; [1] 38935252</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $totalResults</span></span>
<span><span class="co">#&gt; [1] NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $totalRemaining</span></span>
<span><span class="co">#&gt; [1] NA</span></span>
<span><span class="va">time_iter</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   1.644   0.334   1.977</span></span>
<span></span>
<span><span class="co">## Only 1 MBs per iteration</span></span>
<span><span class="op">(</span><span class="fl">1e4</span> <span class="op">*</span> <span class="fl">15</span> <span class="op">*</span> <span class="fl">8</span><span class="op">)</span> <span class="op">/</span> <span class="fl">2</span><span class="op">^</span><span class="fl">20</span></span>
<span><span class="co">#&gt; [1] 1.144409</span></span></code></pre></div>
<p>Wow! Using the iterator approach is not only easier on your RAM, but
faster as well (3.292 <code>/</code> 1.977 <code>~=</code> 1.6651)! Our
gains came strictly from memory efficiency (From over 4 GBs to just over
1 MB) as the underlying algorithm is exactly the same.</p>
<p>Lastly, using iterators make some problems possible that would
otherwise be intractable because of hardware. For instance, using the
example above, if we changed the <code>limitConstraints</code> from 83
to 81 and tried the first approach your computer will most certainly
become unusable (at least mine did). My memory usage shot up to over 30
GB and R became unresponsive. After a restart, I tried the second
approach and obtained my result in just over 10 seconds barely noticing
any jumps in memory:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">## Don't run... consumes a huge chunk of memory</span></span>
<span><span class="co"># time_all &lt;- system.time({</span></span>
<span><span class="co">#     print(</span></span>
<span><span class="co">#         nrow(</span></span>
<span><span class="co">#             comboGeneral(s, 15,</span></span>
<span><span class="co">#                          constraintFun = "mean",</span></span>
<span><span class="co">#                          comparisonFun = "&gt;",</span></span>
<span><span class="co">#                          limitConstraints = 81)  ## 83 --&gt;&gt; 81</span></span>
<span><span class="co">#         )</span></span>
<span><span class="co">#     )</span></span>
<span><span class="co"># })</span></span>
<span></span>
<span><span class="co">## No problem with iterators</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/invisible.html" class="external-link">invisible</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/gc.html" class="external-link">gc</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="op">{</span></span>
<span>    <span class="va">a</span> <span class="op">=</span> <span class="fu"><a href="../reference/combinatoricsIterator.html">comboIter</a></span><span class="op">(</span><span class="va">s</span>, <span class="fl">15</span>,</span>
<span>                  constraintFun <span class="op">=</span> <span class="st">"mean"</span>,</span>
<span>                  comparisonFun <span class="op">=</span> <span class="st">"&gt;"</span>,</span>
<span>                  limitConstraints <span class="op">=</span> <span class="fl">81</span><span class="op">)</span>   <span class="co">## 83 --&gt;&gt; 81</span></span>
<span>    <span class="kw">while</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">a</span><span class="op">@</span><span class="va">nextNIter</span><span class="op">(</span><span class="fl">1e4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span><span class="op">}</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">a</span><span class="op">@</span><span class="va">summary</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span></span>
<span><span class="co">#&gt; No more results.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $description</span></span>
<span><span class="co">#&gt; [1] "Combinations of 50 choose 15 where the mean is &gt; 81"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $currentIndex</span></span>
<span><span class="co">#&gt; [1] 271309888</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $totalResults</span></span>
<span><span class="co">#&gt; [1] NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $totalRemaining</span></span>
<span><span class="co">#&gt; [1] NA</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;  11.532   2.385  13.923</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Joseph Wood.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
