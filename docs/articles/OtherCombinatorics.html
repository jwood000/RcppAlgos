<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cartesian Products and Partitions of Groups into Equal Size • RcppAlgos</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Cartesian Products and Partitions of Groups into Equal Size">
<meta property="og:description" content="RcppAlgos">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">RcppAlgos</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.7.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/CombPermConstraints.html">Constraints, Partitions, and Compositions</a>
    </li>
    <li>
      <a href="../articles/CombinatorialSampling.html">Combinatorial Sampling and Ranking</a>
    </li>
    <li>
      <a href="../articles/CombinatoricsIterators.html">Combinatorial Iterators in RcppAlgos</a>
    </li>
    <li>
      <a href="../articles/ComputationalMathematics.html">Computational Mathematics Overview</a>
    </li>
    <li>
      <a href="../articles/GeneralCombinatorics.html">Combination and Permutation Basics</a>
    </li>
    <li>
      <a href="../articles/HighPerformanceBenchmarks.html">High Performance Benchmarks</a>
    </li>
    <li>
      <a href="../articles/OtherCombinatorics.html">Cartesian Products and Partitions of Groups into Equal Size</a>
    </li>
    <li>
      <a href="../articles/SubsetSum.html">Attacking Problems Related to the Subset Sum Problem</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jwood000/RcppAlgos/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Cartesian Products and Partitions of Groups into
Equal Size</h1>
                        <h4 data-toc-skip class="author">Joseph
Wood</h4>
            
            <h4 data-toc-skip class="date">02/04/2023</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jwood000/RcppAlgos/blob/HEAD/vignettes/OtherCombinatorics.Rmd" class="external-link"><code>vignettes/OtherCombinatorics.Rmd</code></a></small>
      <div class="hidden name"><code>OtherCombinatorics.Rmd</code></div>

    </div>

    
    
<p>In combinatorics, sometimes it can be difficult to figure out exactly
which tool/method we need to attack our problem. Do we need
combinations? permutations? Cartesian product? partitions? compositions?
What about repetition or multiplicity? The list goes on. Oftentimes the
solution ends up being overly complicated and prone to error, or more
commonly, a simple brute force solution is employed. The latter is okay
in some situations, but in many real world problems, this approach
becomes untenable very quickly. The two types of problems addressed
below fall into this category.</p>
<div class="section level2">
<h2 id="cartesian-product-where-order-does-not-matter">Cartesian Product where Order does not Matter<a class="anchor" aria-label="anchor" href="#cartesian-product-where-order-does-not-matter"></a>
</h2>
<p>Given a list of vectors, <em>v<sub>1</sub></em>,
<em>v<sub>2</sub></em>, … , <em>v<sub>n</sub></em>, where the
intersection of two or more vectors in non-empty, find all unique
combinations (order does not matter) of elements of the cartesian
product of all of the vectors.</p>
<p>For example, lets say we have: <code>v1 = 1:4</code> and
<code>v2 = 2:5</code>. The cartestion product is given by
<code>expand.grid(v1, v2)</code> (We continue to use the <code>ht</code>
function defined in the <a href="https://jwood000.github.io/RcppAlgos/articles/GeneralCombinatorics.html" class="external-link">Combination
and Permutation Basics</a> vignette):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ht</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">d</span>, <span class="va">m</span> <span class="op">=</span> <span class="fl">5</span>, <span class="va">n</span> <span class="op">=</span> <span class="va">m</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co">## print the head and tail together</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"head --&gt;\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/partitions/man/print.partition.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">m</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"--------\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"tail --&gt;\n"</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/pkg/partitions/man/print.partition.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">tail</a></span><span class="op">(</span><span class="va">d</span>, <span class="va">n</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Var1 Var2</span></span>
<span><span class="co">#&gt; 1     1    2</span></span>
<span><span class="co">#&gt; 2     2    2</span></span>
<span><span class="co">#&gt; 3     3    2  ### &lt;-- Same as row 6</span></span>
<span><span class="co">#&gt; 4     4    2  ### &lt;-- Same as row 10</span></span>
<span><span class="co">#&gt; 5     1    3</span></span>
<span><span class="co">#&gt; 6     2    3  ### &lt;-- Same as row 3</span></span>
<span><span class="co">#&gt; 7     3    3</span></span>
<span><span class="co">#&gt; 8     4    3  ### &lt;-- Same as row 11</span></span>
<span><span class="co">#&gt; 9     1    4</span></span>
<span><span class="co">#&gt; 10    2    4  ### &lt;-- Same as row 4</span></span>
<span><span class="co">#&gt; 11    3    4  ### &lt;-- Same as row 8</span></span>
<span><span class="co">#&gt; 12    4    4</span></span>
<span><span class="co">#&gt; 13    1    5</span></span>
<span><span class="co">#&gt; 14    2    5</span></span>
<span><span class="co">#&gt; 15    3    5</span></span>
<span><span class="co">#&gt; 16    4    5</span></span></code></pre></div>
<p>If we don’t care about order, the following row pairs are considered
equal and can therefore be pruned to obtain our desired results:</p>
<ul>
<li>(r3, r6)</li>
<li>(r4, r10)</li>
<li>(r8, r11)</li>
</ul>
<p>With <code>comboGrid</code> no duplicates are generated:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/jwood000/RcppAlgos" class="external-link">RcppAlgos</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/comboGrid.html">comboGrid</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">2</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="co">#&gt;       Var1 Var2</span></span>
<span><span class="co">#&gt;  [1,]    1    2</span></span>
<span><span class="co">#&gt;  [2,]    1    3</span></span>
<span><span class="co">#&gt;  [3,]    1    4</span></span>
<span><span class="co">#&gt;  [4,]    1    5</span></span>
<span><span class="co">#&gt;  [5,]    2    2</span></span>
<span><span class="co">#&gt;  [6,]    2    3</span></span>
<span><span class="co">#&gt;  [7,]    2    4</span></span>
<span><span class="co">#&gt;  [8,]    2    5</span></span>
<span><span class="co">#&gt;  [9,]    3    3</span></span>
<span><span class="co">#&gt; [10,]    3    4</span></span>
<span><span class="co">#&gt; [11,]    3    5</span></span>
<span><span class="co">#&gt; [12,]    4    4</span></span>
<span><span class="co">#&gt; [13,]    4    5</span></span></code></pre></div>
<p>Note that the order of <code>expand.grid</code> and
<code>comboGrid</code> differ. The order of <code>comboGrid</code> is
lexicographical meaning that the last column will vary the fastest
whereas with <code>expand.grid</code>, the first column will vary the
fastest.</p>
<p>You will also note that the output of <code>expand.grid</code> is a
<code>data.frame</code> whereas with <code>comboGrid</code>, we get a
<code>matrix</code>. With <code>comboGrid</code>, we only get a
<code>data.frame</code> when the classes of each vector are different as
generally speaking, working with matrices is preferrable.</p>
<p>With the small example above, we only had to filter out 3 out of 16
total results (less than 20%). That isn’t that bad. If this was the
general case, we might as well just stick with <code>expand.grid</code>
as it is very efficient. Unfortunately, this is not the general case and
as the number of vectors with overlap increases, filtering will become
impractical.</p>
<p>Consider the following example:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pools</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">10</span>, <span class="fl">14</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">2</span>, <span class="fl">4</span>, <span class="fl">8</span>, <span class="fl">3</span>, <span class="fl">11</span>, <span class="fl">12</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">11</span>, <span class="fl">3</span>, <span class="fl">13</span>, <span class="fl">4</span>, <span class="fl">15</span>, <span class="fl">8</span>, <span class="fl">6</span>, <span class="fl">5</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">9</span>, <span class="fl">5</span>,  <span class="fl">7</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">10</span>, <span class="fl">3</span>, <span class="fl">8</span>, <span class="fl">14</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">3</span>, <span class="fl">7</span>, <span class="fl">10</span>, <span class="fl">4</span>, <span class="fl">5</span>, <span class="fl">8</span>, <span class="fl">6</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">14</span>, <span class="fl">9</span>, <span class="fl">11</span>, <span class="fl">15</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">6</span>, <span class="fl">13</span>, <span class="fl">14</span>, <span class="fl">10</span>, <span class="fl">11</span>, <span class="fl">9</span>, <span class="fl">4</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>,  <span class="fl">3</span>,  <span class="fl">2</span>, <span class="fl">14</span>,  <span class="fl">7</span>, <span class="fl">12</span>,  <span class="fl">9</span><span class="op">)</span>,</span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>, <span class="fl">11</span>,  <span class="fl">2</span>,  <span class="fl">5</span>, <span class="fl">15</span>,  <span class="fl">7</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">## If we used expand.grid, we would have to filter</span></span>
<span><span class="co">## more than 100 million results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/prod.html" class="external-link">prod</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lengths.html" class="external-link">lengths</a></span><span class="op">(</span><span class="va">pools</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 101154816</span></span>
<span></span>
<span><span class="co">## With comboGrid, this is no problem</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">myCombs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/comboGrid.html">comboGrid</a></span><span class="op">(</span><span class="va">pools</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   0.207   0.023   0.230</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/partitions/man/print.partition.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/object.size.html" class="external-link">object.size</a></span><span class="op">(</span><span class="va">myCombs</span><span class="op">)</span>, unit <span class="op">=</span> <span class="st">"Mb"</span><span class="op">)</span></span>
<span><span class="co">#&gt; 92 Mb</span></span>
<span></span>
<span><span class="fu">ht</span><span class="op">(</span><span class="va">myCombs</span><span class="op">)</span></span>
<span><span class="co">#&gt; head --&gt;</span></span>
<span><span class="co">#&gt;      Var1 Var2 Var3 Var4 Var5 Var6 Var7 Var8 Var9 Var10</span></span>
<span><span class="co">#&gt; [1,]    1    2    3    1    1    3    9    4    2     2</span></span>
<span><span class="co">#&gt; [2,]    1    2    3    1    1    3    9    4    2     5</span></span>
<span><span class="co">#&gt; [3,]    1    2    3    1    1    3    9    4    2     6</span></span>
<span><span class="co">#&gt; [4,]    1    2    3    1    1    3    9    4    2     7</span></span>
<span><span class="co">#&gt; [5,]    1    2    3    1    1    3    9    4    2    11</span></span>
<span><span class="co">#&gt; --------</span></span>
<span><span class="co">#&gt; tail --&gt;</span></span>
<span><span class="co">#&gt;            Var1 Var2 Var3 Var4 Var5 Var6 Var7 Var8 Var9 Var10</span></span>
<span><span class="co">#&gt; [1205736,]   14   12   15   10   14   15   15   11   12    15</span></span>
<span><span class="co">#&gt; [1205737,]   14   12   15   10   14   15   15   13   12    15</span></span>
<span><span class="co">#&gt; [1205738,]   14   12   15   10   14   15   15   13   14    15</span></span>
<span><span class="co">#&gt; [1205739,]   14   12   15   10   14   15   15   14   12    15</span></span>
<span><span class="co">#&gt; [1205740,]   14   12   15   10   14   15   15   14   14    15</span></span>
<span></span>
<span><span class="co">## This is just the time to create the cartesian product</span></span>
<span><span class="co">## Generating keys, then filtering will take much more time</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">cartProd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html" class="external-link">expand.grid</a></span><span class="op">(</span><span class="va">pools</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   3.521   0.827   4.364</span></span>
<span></span>
<span><span class="co">## Creates huge object</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/partitions/man/print.partition.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/object.size.html" class="external-link">object.size</a></span><span class="op">(</span><span class="va">cartProd</span><span class="op">)</span>, unit <span class="op">=</span> <span class="st">"Mb"</span><span class="op">)</span></span>
<span><span class="co">#&gt; 7717.5 Mb</span></span>
<span></span>
<span><span class="co">## What if we want results with unique values...</span></span>
<span><span class="co">## Simply set repetition = FALSE</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">myCombsNoRep</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/comboGrid.html">comboGrid</a></span><span class="op">(</span><span class="va">pools</span>, repetition <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   0.003   0.000   0.003</span></span>
<span></span>
<span><span class="fu">ht</span><span class="op">(</span><span class="va">myCombsNoRep</span><span class="op">)</span></span>
<span><span class="co">#&gt; head --&gt;</span></span>
<span><span class="co">#&gt;      Var1 Var2 Var3 Var4 Var5 Var6 Var7 Var8 Var9 Var10</span></span>
<span><span class="co">#&gt; [1,]    1    2    3    5    8    4    9    6    7    11</span></span>
<span><span class="co">#&gt; [2,]    1    2    3    5    8    4    9    6    7    15</span></span>
<span><span class="co">#&gt; [3,]    1    2    3    5    8    4    9    6   12     7</span></span>
<span><span class="co">#&gt; [4,]    1    2    3    5    8    4    9    6   12    11</span></span>
<span><span class="co">#&gt; [5,]    1    2    3    5    8    4    9    6   12    15</span></span>
<span><span class="co">#&gt; --------</span></span>
<span><span class="co">#&gt; tail --&gt;</span></span>
<span><span class="co">#&gt;         Var1 Var2 Var3 Var4 Var5 Var6 Var7 Var8 Var9 Var10</span></span>
<span><span class="co">#&gt; [2977,]   14    3    4    5    8   15    9   13   12    11</span></span>
<span><span class="co">#&gt; [2978,]   14    3    4    7    5   15    9   13   12    11</span></span>
<span><span class="co">#&gt; [2979,]   14    3    4    7    8   15    9   13   12    11</span></span>
<span><span class="co">#&gt; [2980,]   14    3    5    7    8   15    9   13   12    11</span></span>
<span><span class="co">#&gt; [2981,]   14    4    5    7    8   15    9   13   12    11</span></span></code></pre></div>
<p>The function <code>comboGrid</code> was highly inspired by the
following question on stackoverflow:</p>
<ul>
<li><a href="https://stackoverflow.com/q/51834467/4408538" class="external-link">Picking
unordered combinations from pools with overlap</a></li>
</ul>
<p>Currenlty, the underlying algorithm is not the gold standard. By
that, we mean that results are not generated one by one. Efforts are
underway to achieve this, but up until this point it has proven quite
difficult (See the comprehensive answer by Tim Peters (yes, that <a href="https://stackoverflow.com/users/2705542/tim-peters" class="external-link">Tim
Peters</a>)).</p>
<p>The algorithm in <code>comboGrid</code> leverages <a href="https://en.wikipedia.org/wiki/Fundamental_theorem_of_arithmetic" class="external-link">The
Fundamental Theorem of Arithmetic</a> to efficiently generate keys that
will be used in a hash function to determine if a particular combination
of elements have been encountered. For greater efficiency, we make use
of deduplication as <a href="https://stackoverflow.com/a/51886857/4408538" class="external-link">user2357112</a>
suggests.</p>
<div class="section level3">
<h3 id="in-the-wild">In the Wild<a class="anchor" aria-label="anchor" href="#in-the-wild"></a>
</h3>
<ul>
<li><a href="https://stackoverflow.com/q/68047141/4408538" class="external-link">R - Expand
Grid Without Duplicates</a></li>
<li><a href="https://stackoverflow.com/a/68050873/4408538" class="external-link">Non-redundant
version of expand.grid</a></li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="partitions-of-groups-of-equal-size-with-combogroups">Partitions of Groups of Equal Size with
<code>comboGroups</code><a class="anchor" aria-label="anchor" href="#partitions-of-groups-of-equal-size-with-combogroups"></a>
</h2>
<p>Given a vector of length <em>n</em> and <em>k</em> groups, where
<em>k</em> divides <em>n</em>, each group is comprised of a combination
of the vector chosen <em>g = n / k</em> at a time. As is stated in the
documentation (see <code><a href="../reference/comboGroups.html">?comboGroups</a></code>), these can be constructed
by first generating all permutations of the vector and subsequently
removing entries with permuted groups. Let us consider the following
example. Given <code>v = 1:12</code>, generate all partitions
<code>v</code> into 3 groups each of size 4.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">funBruteGrp</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">myLow</span> <span class="op">=</span> <span class="fl">1</span>, <span class="va">myUp</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">mat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="../reference/combinatoricsGeneral.html">permuteGeneral</a></span><span class="op">(</span><span class="fl">12</span>, lower <span class="op">=</span> <span class="va">myLow</span>, upper <span class="op">=</span> <span class="va">myUp</span>,</span>
<span>        FUN <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">8</span>, <span class="fl">4</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">y</span><span class="op">)</span> <span class="op">{</span></span>
<span>             <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"("</span>, <span class="va">x</span><span class="op">[</span><span class="op">(</span><span class="va">y</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span><span class="op">:</span><span class="op">(</span><span class="va">y</span> <span class="op">+</span> <span class="fl">4</span><span class="op">)</span><span class="op">]</span>, <span class="st">")"</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">" "</span><span class="op">)</span></span>
<span>        <span class="op">}</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"Grp"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">mat</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="va">myLow</span><span class="op">:</span><span class="va">myUp</span></span>
<span>    <span class="va">mat</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co">## All of these are the same as only the 3rd group is being permuted</span></span>
<span><span class="fu">funBruteGrp</span><span class="op">(</span>myUp <span class="op">=</span> <span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#&gt;   Grp1          Grp2          Grp3            </span></span>
<span><span class="co">#&gt; 1 "( 1 2 3 4 )" "( 5 6 7 8 )" "( 9 10 11 12 )"</span></span>
<span><span class="co">#&gt; 2 "( 1 2 3 4 )" "( 5 6 7 8 )" "( 9 10 12 11 )"</span></span>
<span><span class="co">#&gt; 3 "( 1 2 3 4 )" "( 5 6 7 8 )" "( 9 11 10 12 )"</span></span>
<span><span class="co">#&gt; 4 "( 1 2 3 4 )" "( 5 6 7 8 )" "( 9 11 12 10 )"</span></span>
<span><span class="co">#&gt; 5 "( 1 2 3 4 )" "( 5 6 7 8 )" "( 9 12 10 11 )"</span></span>
<span><span class="co">#&gt; 6 "( 1 2 3 4 )" "( 5 6 7 8 )" "( 9 12 11 10 )"</span></span>
<span></span>
<span><span class="co">## We found our second distinct partition</span></span>
<span><span class="fu">funBruteGrp</span><span class="op">(</span>myLow <span class="op">=</span> <span class="fl">23</span>, myUp <span class="op">=</span> <span class="fl">26</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Grp1          Grp2          Grp3            </span></span>
<span><span class="co">#&gt; 23 "( 1 2 3 4 )" "( 5 6 7 8 )" "( 12 11 9 10 )"</span></span>
<span><span class="co">#&gt; 24 "( 1 2 3 4 )" "( 5 6 7 8 )" "( 12 11 10 9 )"</span></span>
<span><span class="co">#&gt; 25 "( 1 2 3 4 )" "( 5 6 7 9 )" "( 8 10 11 12 )"  ### &lt;-- 2nd distinct partition of groups</span></span>
<span><span class="co">#&gt; 26 "( 1 2 3 4 )" "( 5 6 7 9 )" "( 8 10 12 11 )"</span></span>
<span></span>
<span><span class="fu">funBruteGrp</span><span class="op">(</span>myLow <span class="op">=</span> <span class="fl">48</span>, myUp <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Grp1          Grp2           Grp3            </span></span>
<span><span class="co">#&gt; 48 "( 1 2 3 4 )" "( 5 6 7 9 )"  "( 12 11 10 8 )"</span></span>
<span><span class="co">#&gt; 49 "( 1 2 3 4 )" "( 5 6 7 10 )" "( 8 9 11 12 )"  ### &lt;-- 3rd distinct partition of groups</span></span>
<span><span class="co">#&gt; 50 "( 1 2 3 4 )" "( 5 6 7 10 )" "( 8 9 12 11 )"</span></span></code></pre></div>
<p>We are starting to see a pattern. Each new partition is exactly 24
spots away. This makes sense as there are <code>factorial(4) = 24</code>
permutations of size 4. Now, this is an oversimplification as if we
simply generate every <em>24<sup>th</sup></em> permutation, we will
still get duplication as they start to carry over to the other groups.
Observe:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/do.call.html" class="external-link">do.call</a></span><span class="op">(</span><span class="va">rbind</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">169</span>, <span class="fl">24</span><span class="op">)</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="fu">funBruteGrp</span><span class="op">(</span>myLow <span class="op">=</span> <span class="va">x</span>, myUp <span class="op">=</span> <span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;     Grp1          Grp2           Grp3            </span></span>
<span><span class="co">#&gt; 1   "( 1 2 3 4 )" "( 5 6 7 8 )"  "( 9 10 11 12 )"</span></span>
<span><span class="co">#&gt; 25  "( 1 2 3 4 )" "( 5 6 7 9 )"  "( 8 10 11 12 )"</span></span>
<span><span class="co">#&gt; 49  "( 1 2 3 4 )" "( 5 6 7 10 )" "( 8 9 11 12 )" </span></span>
<span><span class="co">#&gt; 73  "( 1 2 3 4 )" "( 5 6 7 11 )" "( 8 9 10 12 )" </span></span>
<span><span class="co">#&gt; 97  "( 1 2 3 4 )" "( 5 6 7 12 )" "( 8 9 10 11 )" </span></span>
<span><span class="co">#&gt; 121 "( 1 2 3 4 )" "( 5 6 8 7 )"  "( 9 10 11 12 )"  ### &lt;-- This is the same as the 1st</span></span>
<span><span class="co">#&gt; 145 "( 1 2 3 4 )" "( 5 6 8 9 )"  "( 7 10 11 12 )"  ### partition. The only difference is</span></span>
<span><span class="co">#&gt; 169 "( 1 2 3 4 )" "( 5 6 8 10 )" "( 7 9 11 12 )"   ### that the 2nd Grp has been permuted</span></span></code></pre></div>
<p>This only gets more muddled as the number of groups increases. It is
also very inefficient, however this exercise hopefully serves to better
illustrate these structures.</p>
<p>The algorithm in <code>comboGroups</code> avoids all of this
duplication by implementing a novel algorithm akin to <a href="https://en.cppreference.com/w/cpp/algorithm/next_permutation" class="external-link">std::next_permutation</a>
from the algorithm library in <code>C++</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="fu"><a href="../reference/comboGroups.html">comboGroups</a></span><span class="op">(</span><span class="fl">12</span>, numGroups <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   0.000   0.000   0.001</span></span>
<span></span>
<span><span class="fu">ht</span><span class="op">(</span><span class="fu"><a href="../reference/comboGroups.html">comboGroups</a></span><span class="op">(</span><span class="fl">12</span>, numGroups <span class="op">=</span> <span class="fl">3</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; head --&gt;</span></span>
<span><span class="co">#&gt;      Grp1 Grp1 Grp1 Grp1 Grp2 Grp2 Grp2 Grp2 Grp3 Grp3 Grp3 Grp3</span></span>
<span><span class="co">#&gt; [1,]    1    2    3    4    5    6    7    8    9   10   11   12</span></span>
<span><span class="co">#&gt; [2,]    1    2    3    4    5    6    7    9    8   10   11   12</span></span>
<span><span class="co">#&gt; [3,]    1    2    3    4    5    6    7   10    8    9   11   12</span></span>
<span><span class="co">#&gt; [4,]    1    2    3    4    5    6    7   11    8    9   10   12</span></span>
<span><span class="co">#&gt; [5,]    1    2    3    4    5    6    7   12    8    9   10   11</span></span>
<span><span class="co">#&gt; --------</span></span>
<span><span class="co">#&gt; tail --&gt;</span></span>
<span><span class="co">#&gt;         Grp1 Grp1 Grp1 Grp1 Grp2 Grp2 Grp2 Grp2 Grp3 Grp3 Grp3 Grp3</span></span>
<span><span class="co">#&gt; [5771,]    1   10   11   12    2    5    8    9    3    4    6    7</span></span>
<span><span class="co">#&gt; [5772,]    1   10   11   12    2    6    7    8    3    4    5    9</span></span>
<span><span class="co">#&gt; [5773,]    1   10   11   12    2    6    7    9    3    4    5    8</span></span>
<span><span class="co">#&gt; [5774,]    1   10   11   12    2    6    8    9    3    4    5    7</span></span>
<span><span class="co">#&gt; [5775,]    1   10   11   12    2    7    8    9    3    4    5    6</span></span></code></pre></div>
<p>Just as in <code>{combo|permute}General</code>, we can utilize the
arguments <code>lower</code>, <code>upper</code>, <code>Parallel</code>,
and <code>nThreads</code>.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/comboGroupsCount.html">comboGroupsCount</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">6</span><span class="op">)</span></span>
<span><span class="co">#&gt; Big Integer ('bigz') :</span></span>
<span><span class="co">#&gt; [1] 123378675083039376</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">a1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/comboGroups.html">comboGroups</a></span><span class="op">(</span><span class="fl">30</span>, numGroups <span class="op">=</span> <span class="fl">6</span>,</span>
<span>                              lower <span class="op">=</span> <span class="st">"123378675000000000"</span>,</span>
<span>                              upper <span class="op">=</span> <span class="st">"123378675005000000"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   0.114   0.033   0.146</span></span>
<span></span>
<span><span class="co">## Use specific number of threads</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">a2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/comboGroups.html">comboGroups</a></span><span class="op">(</span><span class="fl">30</span>, numGroups <span class="op">=</span> <span class="fl">6</span>,</span>
<span>                              lower <span class="op">=</span> <span class="st">"123378675000000000"</span>,</span>
<span>                              upper <span class="op">=</span> <span class="st">"123378675005000000"</span>, nThreads <span class="op">=</span> <span class="fl">4</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   0.129   0.052   0.047</span></span>
<span></span>
<span><span class="co">## Use n - 1 number of threads (in this case, there are 7)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/system.time.html" class="external-link">system.time</a></span><span class="op">(</span><span class="va">a3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/comboGroups.html">comboGroups</a></span><span class="op">(</span><span class="fl">30</span>, numGroups <span class="op">=</span> <span class="fl">6</span>,</span>
<span>                              lower <span class="op">=</span> <span class="st">"123378675000000000"</span>,</span>
<span>                              upper <span class="op">=</span> <span class="st">"123378675005000000"</span>, Parallel <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt;    user  system elapsed </span></span>
<span><span class="co">#&gt;   0.179   0.073   0.043</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">a1</span>, <span class="va">a2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/identical.html" class="external-link">identical</a></span><span class="op">(</span><span class="va">a1</span>, <span class="va">a3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] TRUE</span></span></code></pre></div>
<p>There is one additional argument (i.e. <code>retType</code>) not
present in the other two general functions that allows the user to
specify the type of object returned. The user can select between
<code>"matrix"</code> (the default) and <code>"3Darray"</code>. This
structure has a natural connection to 3D space. We have a particular
result (<em>1<sup>st</sup></em> dimension) broken down into groups
(<em>2<sup>nd</sup></em> dimension) of a certain size
(<em>3<sup>rd</sup></em> dimension).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my3D</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/comboGroups.html">comboGroups</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="va">month.abb</span><span class="op">)</span>, <span class="fl">4</span>, retType <span class="op">=</span> <span class="st">"3Darray"</span><span class="op">)</span></span>
<span><span class="va">my3D</span><span class="op">[</span><span class="fl">1</span>, , <span class="op">]</span></span>
<span><span class="co">#&gt;      Grp1 Grp2 Grp3 Grp4</span></span>
<span><span class="co">#&gt; [1,] Jan  Apr  Jul  Oct </span></span>
<span><span class="co">#&gt; [2,] Feb  May  Aug  Nov </span></span>
<span><span class="co">#&gt; [3,] Mar  Jun  Sep  Dec </span></span>
<span><span class="co">#&gt; Levels: Apr Aug Dec Feb Jan Jul Jun Mar May Nov Oct Sep</span></span>
<span></span>
<span><span class="fu"><a href="../reference/comboGroupsCount.html">comboGroupsCount</a></span><span class="op">(</span><span class="fl">12</span>, <span class="fl">4</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 15400</span></span>
<span></span>
<span><span class="va">my3D</span><span class="op">[</span><span class="fl">15400</span>, , <span class="op">]</span></span>
<span><span class="co">#&gt;      Grp1 Grp2 Grp3 Grp4</span></span>
<span><span class="co">#&gt; [1,] Jan  Feb  Mar  Apr </span></span>
<span><span class="co">#&gt; [2,] Nov  Sep  Jul  May </span></span>
<span><span class="co">#&gt; [3,] Dec  Oct  Aug  Jun </span></span>
<span><span class="co">#&gt; Levels: Apr Aug Dec Feb Jan Jul Jun Mar May Nov Oct Sep</span></span></code></pre></div>
<div class="section level3">
<h3 id="relevant-posts-on-stackoverflow-as-well-as-oeis-">Relevant Posts on Stackoverflow as well as OEIS.<a class="anchor" aria-label="anchor" href="#relevant-posts-on-stackoverflow-as-well-as-oeis-"></a>
</h3>
<ul>
<li><a href="https://stackoverflow.com/a/51754958/4408538" class="external-link">Iterating
through combinations of groups of 4 within a group of 16</a></li>
<li><a href="https://stackoverflow.com/q/57732672/4408538" class="external-link">Create
Combinations in R by Groups</a></li>
<li><a href="https://stackoverflow.com/q/39126712/4408538" class="external-link">Algorithm
that can create all combinations and all groups of those
combinations</a></li>
<li>
<a href="https://oeis.org/A025035" class="external-link uri">https://oeis.org/A025035</a> (See also sequences
A025036-A025042)</li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Joseph Wood.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
